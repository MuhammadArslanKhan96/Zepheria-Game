var Ud=Object.defineProperty;var Hd=(i,t,e)=>t in i?Ud(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var l=(i,t,e)=>(Hd(i,typeof t!="symbol"?t+"":t,e),e);function Im(){import.meta.url,import("_").catch(()=>1);async function*i(){}}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();class $d{constructor(t){this.level=t}info(...t){(this.level==="debug"||this.level==="info")&&console.info(...t)}debug(...t){this.level==="debug"&&console.debug(...t)}error(...t){console.error(...t)}}const de=new $d("info"),jd="modulepreload",Gd=function(i){return"/"+i},co={},Wd=function(t,e,n){if(!e||e.length===0)return t();const r=document.getElementsByTagName("link");return Promise.all(e.map(a=>{if(a=Gd(a),a in co)return;co[a]=!0;const d=a.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(!!n)for(let b=r.length-1;b>=0;b--){const E=r[b];if(E.href===a&&(!d||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${u}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":jd,d||(m.as="script",m.crossOrigin=""),m.href=a,document.head.appendChild(m),d)return new Promise((b,E)=>{m.addEventListener("load",b),m.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t())};function Vd(i={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:n,onRegistered:r,onRegisteredSW:a,onRegisterError:d}=i;let u,y;const m=async(E=!0)=>{await y};async function b(){if("serviceWorker"in navigator){const{Workbox:E}=await Wd(()=>import("./workbox-window.prod.es5-eba8f0a2.js"),[]);u=new E("/sw.js",{scope:"/",type:"classic"}),u.addEventListener("activated",Y=>{(Y.isUpdate||Y.isExternal)&&window.location.reload()}),u.addEventListener("installed",Y=>{Y.isUpdate||n==null||n()}),u.register({immediate:t}).then(Y=>{a?a("/sw.js",Y):r==null||r(Y)}).catch(Y=>{d==null||d(Y)})}}return y=b(),m}let fn;async function Zd(){fn&&(localStorage.getItem("prompted")!=="true"&&await fn.prompt().catch(i=>de.error("[SW ERROR]",i)),await fn.userChoice,localStorage.setItem("prompted","true"),fn=null)}function Kd(){window.addEventListener("beforeinstallprompt",i=>{i.preventDefault(),fn=i}),Vd({immediate:!0})}"serviceWorker"in navigator&&Kd();let Ds=navigator.userAgent.toLowerCase(),Qd=()=>window.innerWidth>=1500;function Jd(){let i=Ds.includes("ipad"),t=Ds.includes("android");return(i||t)&&window.innerWidth>=640}let yi=()=>window.innerWidth<1e3;var dr=(i=>(i[i.Login=0]="Login",i[i.Register=1]="Register",i[i.Guest=2]="Guest",i))(dr||{}),Rs=(i=>(i[i.Spawns=0]="Spawns",i[i.Positions=1]="Positions",i))(Rs||{}),fi=(i=>(i[i.Batch=0]="Batch",i[i.Equip=1]="Equip",i[i.Unequip=2]="Unequip",i[i.Style=3]="Style",i))(fi||{}),Ct=(i=>(i[i.Request=0]="Request",i[i.Started=1]="Started",i[i.Step=2]="Step",i[i.Stop=3]="Stop",i[i.Move=4]="Move",i[i.Follow=5]="Follow",i[i.Entity=6]="Entity",i[i.Speed=7]="Speed",i))(Ct||{}),di=(i=>(i[i.Talk=0]="Talk",i[i.Attack=1]="Attack",i[i.None=2]="None",i[i.Object=3]="Object",i))(di||{}),Tl=(i=>(i[i.Initiate=0]="Initiate",i[i.Hit=1]="Hit",i[i.Finish=2]="Finish",i[i.Sync=3]="Sync",i))(Tl||{}),Cl=(i=>(i[i.Ping=0]="Ping",i[i.Pong=1]="Pong",i))(Cl||{}),It=(i=>(i[i.Batch=0]="Batch",i[i.Add=1]="Add",i[i.Remove=2]="Remove",i[i.Select=3]="Select",i[i.Swap=4]="Swap",i))(It||{}),ci=(i=>(i[i.Batch=0]="Batch",i[i.Add=1]="Add",i[i.Update=2]="Update",i[i.Use=3]="Use",i[i.QuickSlot=4]="QuickSlot",i[i.Toggle=5]="Toggle",i))(ci||{}),Sn=(i=>(i[i.Batch=0]="Batch",i[i.Progress=1]="Progress",i[i.Finish=2]="Finish",i))(Sn||{}),_r=(i=>(i[i.Batch=0]="Batch",i[i.Progress=1]="Progress",i))(_r||{}),Ns=(i=>(i[i.Ok=0]="Ok",i[i.YesNo=1]="YesNo",i[i.Text=2]="Text",i[i.Popup=3]="Popup",i))(Ns||{}),Ms=(i=>(i[i.Sync=0]="Sync",i[i.Skill=1]="Skill",i))(Ms||{}),fr=(i=>(i[i.Talk=0]="Talk",i[i.Store=1]="Store",i[i.Bank=2]="Bank",i[i.Enchant=3]="Enchant",i[i.Countdown=4]="Countdown",i))(fr||{}),mt=(i=>(i[i.Request=0]="Request",i[i.Add=1]="Add",i[i.Remove=2]="Remove",i[i.Accept=3]="Accept",i[i.Close=4]="Close",i[i.Open=5]="Open",i))(mt||{}),br=(i=>(i[i.Select=0]="Select",i[i.Confirm=1]="Confirm",i))(br||{}),Be=(i=>(i[i.Create=0]="Create",i[i.Login=1]="Login",i[i.Logout=2]="Logout",i[i.Join=3]="Join",i[i.Leave=4]="Leave",i[i.Rank=5]="Rank",i[i.Update=6]="Update",i[i.Experience=7]="Experience",i[i.Banner=8]="Banner",i[i.List=9]="List",i[i.Error=10]="Error",i[i.Chat=11]="Chat",i))(Be||{}),Je=(i=>(i[i.Location=0]="Location",i[i.Relative=1]="Relative",i[i.Entity=2]="Entity",i[i.Remove=3]="Remove",i[i.Button=4]="Button",i))(Je||{}),wi=(i=>(i[i.Open=0]="Open",i[i.Close=1]="Close",i[i.Buy=2]="Buy",i[i.Sell=3]="Sell",i[i.Update=4]="Update",i[i.Select=5]="Select",i))(wi||{}),cn=(i=>(i[i.Score=0]="Score",i[i.End=1]="End",i[i.Lobby=2]="Lobby",i[i.Exit=3]="Exit",i))(cn||{}),cr=(i=>(i[i.Set=0]="Set",i[i.Remove=1]="Remove",i[i.Lamp=2]="Lamp",i[i.RemoveLamps=3]="RemoveLamps",i[i.Darkness=4]="Darkness",i))(cr||{}),Il=(i=>(i[i.CtrlClick=0]="CtrlClick",i))(Il||{}),Ps=(i=>(i[i.Batch=0]="Batch",i[i.Update=1]="Update",i))(Ps||{}),Yl=(i=>(i[i.Entity=0]="Entity",i[i.Position=1]="Position",i))(Yl||{}),Os=(i=>(i[i.Add=0]="Add",i[i.Remove=1]="Remove",i))(Os||{}),wt=(i=>(i[i.List=0]="List",i[i.Add=1]="Add",i[i.Remove=2]="Remove",i[i.Status=3]="Status",i[i.Sync=4]="Sync",i))(wt||{}),xn=(i=>(i[i.Open=0]="Open",i[i.Select=1]="Select",i[i.Craft=2]="Craft",i))(xn||{});Je.Remove;var qe=(i=>(i[i.Bank=0]="Bank",i[i.Inventory=1]="Inventory",i[i.Trade=2]="Trade",i))(qe||{}),re=(i=>(i[i.Up=0]="Up",i[i.Down=1]="Down",i[i.Left=2]="Left",i[i.Right=3]="Right",i))(re||{}),xe=(i=>(i[i.Player=0]="Player",i[i.NPC=1]="NPC",i[i.Item=2]="Item",i[i.Mob=3]="Mob",i[i.Chest=4]="Chest",i[i.Projectile=5]="Projectile",i[i.Object=6]="Object",i[i.Pet=7]="Pet",i))(xe||{}),yr=(i=>(i[i.Active=0]="Active",i[i.Passive=1]="Passive",i))(yr||{}),st=(i=>(i[i.Idle=0]="Idle",i[i.Attack=1]="Attack",i[i.Walk=2]="Walk",i[i.Orientate=3]="Orientate",i))(st||{}),ke=(i=>(i.DropOne="drop-one",i.DropMany="drop-many",i.Wield="wield",i.Equip="equip",i.Attack="attack",i.Eat="eat",i.Eat2="eat2",i.Move="move",i.Trade="trade",i.Potion="potion",i.Follow="follow",i.Examine="examine",i.AddFriend="addfriend",i))(ke||{}),Ne=(i=>(i[i.Normal=0]="Normal",i[i.Poison=1]="Poison",i[i.Heal=2]="Heal",i[i.Mana=3]="Mana",i[i.Experience=4]="Experience",i[i.LevelUp=5]="LevelUp",i[i.Critical=6]="Critical",i[i.Stun=7]="Stun",i[i.Profession=8]="Profession",i[i.Freezing=9]="Freezing",i[i.Burning=10]="Burning",i[i.Terror=11]="Terror",i))(Ne||{}),le=(i=>(i[i.Armour=0]="Armour",i[i.Boots=1]="Boots",i[i.Pendant=2]="Pendant",i[i.Ring=3]="Ring",i[i.Weapon=4]="Weapon",i[i.Arrows=5]="Arrows",i[i.WeaponSkin=6]="WeaponSkin",i[i.ArmourSkin=7]="ArmourSkin",i))(le||{}),He=(i=>(i[i.None=0]="None",i[i.Stab=1]="Stab",i[i.Slash=2]="Slash",i[i.Defensive=3]="Defensive",i[i.Crush=4]="Crush",i[i.Shared=5]="Shared",i[i.Hack=6]="Hack",i[i.Chop=7]="Chop",i[i.Accurate=8]="Accurate",i[i.Fast=9]="Fast",i[i.Focused=10]="Focused",i[i.LongRange=11]="LongRange",i))(He||{}),Oi=(i=>(i[i.Colliding=0]="Colliding",i[i.Mob=1]="Mob",i[i.Player=2]="Player",i[i.Item=3]="Item",i[i.NPC=4]="NPC",i[i.Chest=5]="Chest",i[i.Object=6]="Object",i))(Oi||{}),ot=(i=>(i[i.Lumberjacking=0]="Lumberjacking",i[i.Accuracy=1]="Accuracy",i[i.Archery=2]="Archery",i[i.Health=3]="Health",i[i.Magic=4]="Magic",i[i.Mining=5]="Mining",i[i.Strength=6]="Strength",i[i.Defense=7]="Defense",i[i.Fishing=8]="Fishing",i[i.Cooking=9]="Cooking",i[i.Smithing=10]="Smithing",i[i.Crafting=11]="Crafting",i[i.Fletching=12]="Fletching",i[i.Smelting=13]="Smelting",i[i.Foraging=14]="Foraging",i[i.Eating=15]="Eating",i[i.Loitering=16]="Loitering",i))(ot||{});let na=[3,1,6,7,2,4,0,5,8,14,11,9,12,10,15,16];var Xl=(i=>(i[i.Bloodsucking=0]="Bloodsucking",i[i.Critical=1]="Critical",i[i.Evasion=2]="Evasion",i[i.Thorns=3]="Thorns",i[i.Explosive=4]="Explosive",i[i.Stun=5]="Stun",i[i.AntiStun=6]="AntiStun",i[i.Splash=7]="Splash",i[i.DoubleEdged=8]="DoubleEdged",i))(Xl||{}),_e=(i=>(i[i.None=0]="None",i[i.Critical=1]="Critical",i[i.Terror=2]="Terror",i[i.TerrorStatus=3]="TerrorStatus",i[i.Stun=4]="Stun",i[i.Healing=5]="Healing",i[i.Fireball=6]="Fireball",i[i.Iceball=7]="Iceball",i[i.Poisonball=8]="Poisonball",i[i.Boulder=9]="Boulder",i[i.Running=10]="Running",i[i.HotSauce=11]="HotSauce",i[i.DualistsMark=12]="DualistsMark",i[i.ThickSkin=13]="ThickSkin",i[i.SnowPotion=14]="SnowPotion",i[i.FirePotion=15]="FirePotion",i[i.Burning=16]="Burning",i[i.Freezing=17]="Freezing",i[i.Invincible=18]="Invincible",i))(_e||{}),Ye=(i=>(i[i.None=0]="None",i[i.Silver=1]="Silver",i[i.Gold=2]="Gold",i[i.Artist=3]="Artist",i[i.Tier1=4]="Tier1",i[i.Tier2=5]="Tier2",i[i.Tier3=6]="Tier3",i[i.Tier4=7]="Tier4",i[i.Tier5=8]="Tier5",i[i.Tier6=9]="Tier6",i[i.Tier7=10]="Tier7",i))(Ye||{}),$e=(i=>(i[i.None=0]="None",i[i.Moderator=1]="Moderator",i[i.Admin=2]="Admin",i[i.Veteran=3]="Veteran",i[i.Patron=4]="Patron",i[i.Artist=5]="Artist",i[i.Cheater=6]="Cheater",i[i.TierOne=7]="TierOne",i[i.TierTwo=8]="TierTwo",i[i.TierThree=9]="TierThree",i[i.TierFour=10]="TierFour",i[i.TierFive=11]="TierFive",i[i.TierSix=12]="TierSix",i[i.TierSeven=13]="TierSeven",i[i.HollowAdmin=14]="HollowAdmin",i))($e||{});let ef={[0]:"",[1]:"#02f070",[2]:"#3bbaff",[3]:"#d84343",[4]:"#db753c",[5]:"#b552f7",[6]:"#ffffff",[7]:"#db963c",[8]:"#e6c843",[9]:"#d6e34b",[10]:"#a9e03a",[11]:"#7beb65",[12]:"#77e691",[13]:"#77e691",[14]:"#3bbaff"},tf={[0]:"",[1]:"Mod",[2]:"Admin",[3]:"Veteran",[4]:"Patron",[5]:"Artist",[6]:"Cheater",[7]:"T1 Patron",[8]:"T2 Patron",[9]:"T3 Patron",[10]:"T4 Patron",[11]:"T5 Patron",[12]:"T6 Patron",[13]:"T7 Patron",[14]:"Admin"},nf={[0]:{fill:"rgb(255, 50, 50)",stroke:"rgb(255, 180, 180)",inflicted:{fill:"white",stroke:"#373737"}},[6]:{fill:"rgb(204, 0, 204)",stroke:"rgb(255, 180, 180)",inflicted:{fill:"rgb(255, 153, 204)",stroke:"#373737"}},[1]:{fill:"rgb(66, 183, 77)",stroke:"rgb(50, 120 , 50)"},[2]:{fill:"rgb(80, 255, 80)",stroke:"rgb(50, 120, 50)"},[3]:{fill:"rgb(73, 94, 228)",stroke:"rgb(56, 63, 133)"},[4]:{fill:"rgb(80, 180, 255)",stroke:"rgb(15, 85, 138)"},[5]:{fill:"rgb(80, 180, 255)",stroke:"rgb(15, 85, 138)"},[8]:{fill:"rgb(204, 0, 153)",stroke:"rgb(112, 17, 112)"},[9]:{fill:"rgb(52, 195, 235)",stroke:"rgb(14, 138, 227)"},[10]:{fill:"rgb(227, 170, 14)",stroke:"rgb(235, 135, 52)"}},rf={[0]:{fill:"rgb(132, 57, 45)",stroke:"rgb(101, 48, 35)"},[1]:{fill:"rgb(6, 191, 188)",stroke:"rgb(2, 94, 93)"},[2]:{fill:"rgb(34, 214, 130)",stroke:"rgb(7, 184, 101)"},[3]:{fill:"rgb(239, 90, 90)",stroke:"rgb(255, 0, 0)"},[4]:{fill:"rgb(37, 124, 210)",stroke:"rgb(12, 55, 208)"},[5]:{fill:"rgb(105, 106, 107)",stroke:"rgb(45, 45, 46)"},[6]:{fill:"rgb(232, 211, 185)",stroke:"rgb(189, 172, 151)"},[7]:{fill:"rgb(110, 158, 255)",stroke:"rgb(7, 63, 176)"},[8]:{fill:"rgb(0, 255, 255)",stroke:"rgb(0, 255, 255)"},[9]:{fill:"rgb(255, 0, 0)",stroke:"rgb(255, 0, 0)"},[10]:{fill:"rgb(132, 57, 45)",stroke:"rgb(101, 48, 35)"},[11]:{fill:"rgb(255, 255, 0)",stroke:"rgb(255, 255, 0)"},[12]:{fill:"rgb(255, 255, 0)",stroke:"rgb(255, 255, 0)"},[13]:{fill:"rgb(255, 255, 0)",stroke:"rgb(255, 255, 0)"},[15]:{fill:"rgb(255, 0, 0)",stroke:"rgb(255, 0, 0)"},[16]:{fill:"rgb(255, 0, 0)",stroke:"rgb(255, 0, 0)"},[14]:{fill:"rgb(255, 0, 0)",stroke:"rgb(255, 0, 0)"}};var qs=(i=>(i[i.Fledgling=0]="Fledgling",i[i.Emergent=1]="Emergent",i[i.Established=2]="Established",i[i.Adept=3]="Adept",i[i.Veteran=4]="Veteran",i[i.Elite=5]="Elite",i[i.Master=6]="Master",i[i.Landlord=7]="Landlord",i))(qs||{}),qi=(i=>(i.Green="green",i.Blue="blue",i.Red="red",i.Grey="grey",i.Black="black",i.Tangerine="tangerine",i.Yellow="yellow",i.Purple="purple",i.Pink="pink",i))(qi||{}),Bs=(i=>(i.Green="green",i.Blue="blue",i.Orange="orange",i.White="white",i.Grey="grey",i.Tangerine="tangerine",i.Yellow="yellow",i.Purple="purple",i.Pink="pink",i))(Bs||{}),un=(i=>(i.None="none",i.Star="star",i.Hawk="hawk",i.Phoenix="phoenix",i))(un||{});const kt={MAX_STACK:2147483647,MAX_LEVEL:135,INVENTORY_SIZE:25,BANK_SIZE:420,DROP_PROBABILITY:1e4,MAX_PROFESSION_LEVEL:99,HEAL_RATE:7e3,EFFECT_RATE:1e4,STORE_UPDATE_FREQUENCY:2e4,MAP_DIVISION_SIZE:48,SPAWN_POINT:"405,27",TUTORIAL_QUEST_KEY:"tutorial",TUTORIAL_SPAWN_POINT:"579,7",RESOURCE_RESPAWN:3e4,TREE_RESPAWN:25e3,CHEST_RESPAWN:5e4,SKILL_LOOP:1e3,MAX_ACCURACY:.45,EDIBLE_COOLDOWN:1500,CRAFT_COOLDOWN:1500,INVALID_MOVEMENT_THRESHOLD:3,ARCHER_ATTACK_RANGE:8,MAX_CONNECTIONS:16,EXPERIENCE_PER_HIT:4,SNOW_POTION_DURATION:6e4,FIRE_POTION_DURATION:6e4,FREEZING_DURATION:6e4,BURNING_DURATION:6e4,TERROR_DURATION:6e4,LOITERING_THRESHOLD:9e4,STUN_DURATION:1e4,COLD_EFFECT_DAMAGE:10,BURNING_EFFECT_DAMAGE:20,ATTACKER_TIMEOUT:2e4,MAX_GUILD_MEMBERS:40,EVENTS_CHECK_INTERVAL:36e5};var B=(i=>(i[i.Handshake=0]="Handshake",i[i.Login=1]="Login",i[i.Welcome=2]="Welcome",i[i.Map=3]="Map",i[i.Spawn=4]="Spawn",i[i.List=5]="List",i[i.Who=6]="Who",i[i.Equipment=7]="Equipment",i[i.Ready=8]="Ready",i[i.Sync=9]="Sync",i[i.Movement=10]="Movement",i[i.Teleport=11]="Teleport",i[i.Despawn=12]="Despawn",i[i.Target=13]="Target",i[i.Combat=14]="Combat",i[i.Animation=15]="Animation",i[i.Points=16]="Points",i[i.Network=17]="Network",i[i.Chat=18]="Chat",i[i.Command=19]="Command",i[i.Container=20]="Container",i[i.Ability=21]="Ability",i[i.Quest=22]="Quest",i[i.Achievement=23]="Achievement",i[i.Notification=24]="Notification",i[i.Blink=25]="Blink",i[i.Heal=26]="Heal",i[i.Experience=27]="Experience",i[i.Death=28]="Death",i[i.Music=29]="Music",i[i.NPC=30]="NPC",i[i.Respawn=31]="Respawn",i[i.Trade=32]="Trade",i[i.Enchant=33]="Enchant",i[i.Guild=34]="Guild",i[i.Pointer=35]="Pointer",i[i.PVP=36]="PVP",i[i.Poison=37]="Poison",i[i.Warp=38]="Warp",i[i.Store=39]="Store",i[i.Overlay=40]="Overlay",i[i.Camera=41]="Camera",i[i.Bubble=42]="Bubble",i[i.Skill=43]="Skill",i[i.Update=44]="Update",i[i.Minigame=45]="Minigame",i[i.Effect=46]="Effect",i[i.Friends=47]="Friends",i[i.Focus=48]="Focus",i[i.Rank=49]="Rank",i[i.Examine=50]="Examine",i[i.Player=51]="Player",i[i.Relay=52]="Relay",i[i.Crafting=53]="Crafting",i))(B||{});let Jn=window.localStorage,ls="data";class sf{constructor(){l(this,"data");l(this,"mapData");l(this,"newVersion",!1);this.data=Jn.data?JSON.parse(Jn.getItem(ls)):this.create(),this.newVersion=this.isNewVersion(),this.newVersion?(this.set(this.create()),this.clearIndexedDB()):this.loadIndexedDB()}create(){return{new:!0,world:1,clientVersion:"v-1.0.0",errorMessage:"",player:{username:"",password:"",autoLogin:!1,rememberMe:!1,orientation:re.Down,zoom:3},settings:{musicVolume:100,soundVolume:100,brightness:100,audioEnabled:!yi(),lowPowerMode:!1,debugMode:!1,showNames:!0,showLevels:!0,disableCaching:!1}}}loadIndexedDB(){var e;let t=(e=window.indexedDB)==null?void 0:e.open("mapCache",this.getDBVersion());t.addEventListener("error",()=>{this.clearIndexedDB()}),t.addEventListener("upgradeneeded",n=>{let r=n.target.result;r||console.error("Could not open IndexedDB database."),r.createObjectStore("regions"),r.createObjectStore("objects"),r.createObjectStore("cursorTiles"),de.debug(`IndexedDB created with version ${this.getDBVersion()}.`)}),t.addEventListener("success",n=>{this.mapData=n.target.result,de.debug(`Successfully opened IndexedDB with version ${this.getDBVersion()}.`)})}save(){try{this.data&&Jn.setItem(ls,JSON.stringify(this.data))}catch(t){console.error(t)}}clear(){Jn.removeItem(ls),this.set(this.create()),this.save()}clearIndexedDB(){var t;(t=this.mapData)==null||t.close(),window.indexedDB.deleteDatabase("mapCache"),this.loadIndexedDB()}set(t){this.data=t,this.save()}setError(t){return this.data.errorMessage=t,this.save(),!0}setRemember(t){this.data.player.rememberMe=t,this.save()}setCredentials(t="",e=""){this.data.player.username=t,this.data.player.password=e,this.save()}setMusicVolume(t=100){this.data.settings.musicVolume=t,this.save()}setSoundVolume(t=100){this.data.settings.soundVolume=t,this.save()}setBrightness(t=100){this.data.settings.brightness=t,this.save()}setAudioEnabled(t){this.data.settings.audioEnabled=t,this.save()}setLowPowerMode(t){this.data.settings.lowPowerMode=t,this.save()}setDebug(t){this.data.settings.debugMode=t,this.save()}setShowNames(t){this.data.settings.showNames=t,this.save()}setShowLevels(t){this.data.settings.showLevels=t,this.save()}setDisableCaching(t){this.data.settings.disableCaching=t,this.save()}isNewVersion(){return this.data.clientVersion!=="v-1.0.0"}setOrientation(t){this.data.player.orientation=t,this.save()}setZoom(t){this.data.player.zoom=t,this.save()}setMapData(t,e){if(!this.mapData)return;let n=this.mapData.transaction(["objects","cursorTiles"],"readwrite"),r=n.objectStore("objects"),a=n.objectStore("cursorTiles");r.put(t,0),a.put(e,0)}setRegionData(t,e){if(!this.mapData)return;let n=this.mapData.transaction("regions","readwrite").objectStore("regions"),r=n.get(e);r.addEventListener("success",()=>{r.result||n.put(t,e)})}getError(){let{errorMessage:t}=this.data;return this.data.errorMessage="",this.save(),t}getUsername(){return this.data.player.username}getPassword(){return this.data.player.password}getDBVersion(){return parseInt(this.data.clientVersion.replace(/\D/g,""))||1}hasRemember(){return this.data.player.rememberMe}isNew(){return this.data.new}getRegionData(t){let e={regionData:{},objects:[],cursorTiles:{}};if(!this.mapData)return t(e);let n=this.mapData.transaction(["regions","objects","cursorTiles"],"readonly"),r=n.objectStore("regions").openCursor(),a=n.objectStore("objects").get(0),d=n.objectStore("cursorTiles").get(0);n.addEventListener("error",()=>t(e)),r.addEventListener("success",u=>{let y=u.target.result;y&&(e.regionData[y.primaryKey]=y.value,y.continue())}),a.addEventListener("success",()=>e.objects=a.result),d.addEventListener("success",()=>e.cursorTiles=d.result),n.addEventListener("complete",()=>t(e))}getSettings(){return this.data.settings}getDebug(){return this.data.settings.debugMode}}let wn;const Ll=200;function kr(){wn!==void 0&&(clearTimeout(wn),wn=void 0)}function ra(i,t){let e=document.querySelector("#game-container");i.addEventListener("contextmenu",n=>{n.preventDefault(),kr(),t({x:n.clientX,y:n.clientY})}),e.addEventListener("contextmenu",n=>n.preventDefault()),i.addEventListener("touchstart",n=>{let[r]=n.touches;wn=window.setTimeout(()=>t({x:r.clientX,y:r.clientY}),Ll)}),e.addEventListener("touchmove",kr)}function Al(i,t,e){let n=!1,r,a=document.querySelector("#game-container");i.addEventListener("mousedown",()=>d()),a.addEventListener("mousemove",b=>u(b.clientX,b.clientY)),a.addEventListener("mouseup",b=>y(b.clientX,b.clientY)),i.addEventListener("touchstart",()=>d(Ll)),a.addEventListener("touchmove",b=>{let[E]=b.touches;n&&b.preventDefault(),u(E.clientX,E.clientY)}),a.addEventListener("touchend",b=>{let[E]=b.changedTouches;y(E.clientX,E.clientY)}),a.addEventListener("touchcancel",m);function d(b){wn=window.setTimeout(()=>{e!=null&&e()||(m(),n=!0,r=i.cloneNode(!0),r.style.position="absolute",r.style.opacity="0.75",r.style.top=`${-i.clientHeight}px`,r.style.left=`${-i.clientWidth}px`,r.style.pointerEvents="none",r.style.touchAction="none",a==null||a.append(r))},b)}function u(b,E){if(kr(),!n||!r)return m();r.style.top=`${E-i.clientHeight/2}px`,r.style.left=`${b-i.clientWidth/2}px`}function y(b,E){if(!n)return;let Y=r;m();let I=document.elementFromPoint(b,E);!I||!Y||t(Y,I)}function m(){kr(),n=!1,r==null||r.remove(),r=void 0,i.classList.remove("item-slot-focused")}}class je{constructor(t,e,n,r,a){l(this,"frame",{index:0,x:0,y:0});l(this,"count",1);l(this,"bopIndex",0);l(this,"bopCount",4);l(this,"decreaseBop",!1);l(this,"lastTime",Date.now());l(this,"speed",100);l(this,"bopCallback");l(this,"endCallback");this.name=t,this.length=e,this.row=n,this.width=r,this.height=a,this.reset()}update(t){var e,n;if(this.canAnimate()){if(this.lastTime=t,this.length===1)return this.decreaseBop?this.bopIndex--:this.bopIndex++,this.bopIndex>=this.bopCount?this.decreaseBop=!0:this.bopIndex<=0&&(this.decreaseBop=!1),(e=this.bopCallback)==null?void 0:e.call(this,this.bopIndex);if(this.frame.index>=this.length-1)return this.count>0&&this.count--,this.count<=0&&((n=this.endCallback)==null||n.call(this)),this.reset();this.frame.index++,this.frame.x=this.frame.index*this.width,this.frame.y=this.row*this.height}}setCount(t,e){this.count=t,this.endCallback=e}setSpeed(t){this.speed=t}setRow(t){this.row=t}canAnimate(){return Date.now()-this.lastTime>this.speed}reset(){this.lastTime=Date.now(),this.frame={index:0,x:0,y:this.row*this.height}}onBop(t){this.bopCallback=t}}class zs{constructor(t){l(this,"key","");l(this,"path","");l(this,"width",q.tileSize);l(this,"height",q.tileSize);l(this,"offsetX",-q.tileSize);l(this,"offsetY",-q.tileSize);l(this,"idleSpeed",450);l(this,"loaded",!1);l(this,"loading",!1);l(this,"hasDeathAnimation",!1);l(this,"animations",{});l(this,"image");l(this,"hurtSprite");l(this,"silhouetteSprite");var e,n;this.data=t,this.key=this.data.id,this.path=`/img/sprites/${this.key}.png`,this.width=this.data.width||this.width,this.height=this.data.height||this.height,this.offsetX=(e=this.data.offsetX)!=null?e:this.offsetX,this.offsetY=(n=this.data.offsetY)!=null?n:this.offsetY,this.idleSpeed=this.data.idleSpeed||this.idleSpeed,this.loadAnimations()}load(){this.loading||this.loaded||(this.loading=!0,this.image=new Image,this.image.crossOrigin="Anonymous",this.image.src=this.path,this.image.addEventListener("load",()=>{var t;this.loaded=!0,!this.key.startsWith("items/")&&this.image.width>96&&(this.hurtSprite=q.getHurtSprite(this)),this.silhouetteSprite=q.getSilhouetteSprite(this),this.loading=!1,(t=this.loadCallback)==null||t.call(this)}))}loadAnimations(){this.data.animations||(this.data.animations=q.getDefaultAnimations(this.key.startsWith("items/")));for(let t in this.data.animations){let e=this.data.animations[t];t==="death"&&(this.hasDeathAnimation=!0),this.animations[t]=new je(t,e.length,e.row,this.width,this.height)}}onLoad(t){this.loadCallback=t}}let uo=i=>i%1===0;const q={tileSize:-1,sideLength:-1,thirdTile:-1,tileAndAQuarter:-1,createId(i,t=0,e=0){return`${i}${t}${e}`},randomInt(i,t){return i+Math.floor(Math.random()*(t-i+1))},createSlot(i,t,e,n){let r=document.createElement("li"),a=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div");return a.dataset.type=`${i}`,a.dataset.index=`${t}`,a.classList.add("item-slot"),d.classList.add("item-image"),u.classList.add("item-count"),i===qe.Bank&&u.classList.add("bank-item-count"),a.append(d),a.append(u),e&&a.addEventListener("click",()=>e(i,t)),n&&ra(a,()=>n(i,t)),r.append(a),r},getImageURL(i=""){return i===""?"":`url("/img/sprites/items/${i}.png")`},formatName(i="",t=0){return i=i.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),t>1&&i.length>t&&(i=`${i.slice(0,Math.max(0,t))}...`),i},getCount(i){let t=i.toString();return i>999999?`${Math.floor(i/1e6)}M`:i>9999?`${Math.floor(i/1e3)}K`:i>1?t:""},getContainerAction(i){switch(i){case ke.Wield:case ke.Equip:case ke.Eat:case ke.Eat2:return It.Select;case ke.DropOne:return It.Remove;case ke.Move:return It.Swap}},isEmail(i){return/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\dA-Za-z-]+\.)+[A-Za-z]{2,}))$/.test(i)},getRegion(i,t){let e=Math.floor(i/kt.MAP_DIVISION_SIZE),n=Math.floor(t/kt.MAP_DIVISION_SIZE);return e+n*this.sideLength},getEmptyStats(){return{crush:0,slash:0,stab:0,archery:0,magic:0}},getEmptyBonuses(){return{accuracy:0,strength:0,archery:0,magic:0}},getHurtSprite(i){let t=document.createElement("canvas"),e=t.getContext("2d"),n=new zs(i.data);t.width=i.image.width,t.height=i.image.height,e.drawImage(i.image,0,0,i.image.width,i.image.height);let r=e.getImageData(0,0,i.image.width,i.image.height);for(let a=0;a<r.data.length;a+=4)r.data[a+4]!==0&&(r.data[a]=255,r.data[a+1]=r.data[a+2]=75);return e.putImageData(r,0,0),n.image=t,n.loaded=!0,n},getSilhouetteSprite(i){let t=document.createElement("canvas"),e=t.getContext("2d"),n=new zs(i.data);t.width=i.image.width,t.height=i.image.height,e.drawImage(i.image,0,0,i.image.width,i.image.height);let r=e.getImageData(0,0,i.image.width,i.image.height),a=e.getImageData(0,0,i.image.width,i.image.height);for(let d=0;d<a.data.length;d+=4){if(a.data[d+3]!==0)continue;let u=d/4%i.image.width,y=Math.floor(d/4/i.image.width);if(u===0||u===i.image.width-1||y===0||y===i.image.height-1)continue;[a.data[d-1],a.data[d+7],a.data[d-a.width*4+3],a.data[d+a.width*4+3]].some(b=>b!==0)&&(r.data[d]=r.data[d+1]=255,r.data[d+2]=r.data[d+3]=150)}return e.putImageData(r,0,0),n.image=t,n.loaded=!0,n},getDefaultAnimations(i=!1){return i?{idle:{length:1,row:0}}:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}}},fadeIn(i,t=.1){var n;(n=i.style).opacity||(n.opacity="0"),i.style.display="block";let e=()=>{let r=parseFloat(i.style.opacity)+t;i.style.display="block",r<=1&&(i.style.opacity=r.toString(),requestAnimationFrame(e))};requestAnimationFrame(e)},fadeOut(i,t=.2){var n;(n=i.style).opacity||(n.opacity="1");let e=()=>{let r=parseFloat(i.style.opacity)-t;r>=0?(i.style.opacity=r.toString(),requestAnimationFrame(e)):i.style.display="none"};requestAnimationFrame(e)}},af={"alpha-2.2.3":{title:"Kaetram alpha-2.2.3",content:["- Audio fixes","- Added new achievement","- Minor map updates","- This neat little interface :)","- Hotkeys 'm' for map and 'p' for profile","- Admins and moderators name now displays a different colour"]},"alpha-2.2.4":{title:"Kaetram alpha-2.2.4",content:["- Discord bot updates","- Forester now sells axes","- Map updates and loading time improvements","- Armour and weapon stats for all items","- Added default price to majority of items","- Profanity filter fixes and improvements"]},"alpha-2.2.5":{title:"Kaetram alpha-2.2.5",content:["- Fixes health bar resetting when logging out","- Anti-cheating measures updated","- Minor fixes to the UI animations","- Mobile support drag & drop","- Un-droppable/un-sellable quest items","- Fixes bug with poison weapons","- Respawn duration changes to Skeleton King and Ogre Lord","- Map changes and more content","- A lot of game engine improvements and preparations for new content ;)"]},"alpha-2.2.6":{title:"Kaetram alpha-2.2.6",content:["- Chatbox fixes and new layout","- Added stop movement by pressing ESC","- Added attack last target by pressing 't'","- Combat system improvements","- Anti-cheat detection/no-clipping fixes (hopefully)","- Gold coin image update","- Map loading improvements","- Client backend work, support for special effects and more","- New map content"]},"alpha-2.2.7":{title:"Kaetram alpha-2.2.7",content:["- Improvements to the poison effect","- Adds 'h' as the hotkey for healing (will use first potion in inventory)","- Trees now indicate level required to chop","- Improvements to the backend and interactions with the map","- New map content and achievements","- New trees have been added"]},"alpha-2.3.0":{title:"Kaetram alpha-2.3.0",content:["- Friends list","- New achievement interface","- New quest interface","- Various user interface improvements","- Backend fixes"]},"alpha-2.3.1":{title:"Kaetram alpha-2.3.1",content:["- Added special effects to some projectiles","- Fixes some user interface quirks","- Fixes some private messaging issues","- Minor improvements to ranged combat","- Fixes a bug with the overlay sizing","- New caching system for the client map"]},"alpha-2.3.2":{title:"Kaetram alpha-2.3.2",content:["- New inventory interface","- Fixes mobs being unattackable after they moved","- Mob position sync when returning to game tab (browsers)","- Fix bug with combat continuing after closing the game","- Backend optimizations","- Chat UI fixes on mobile"]},"alpha-2.3.3":{title:"Kaetram alpha-2.3.3",content:["- Mining skill","- Magic is now publicly available","- Added support for in-game special ranks","- Added new quests, bosses, weapons, rings, pendants, and areas","- Fixes to disconnection issues due to high-latency","- Fixes and updates to multiple interfaces","- Improvements to clicking moving mobs and ranged combat","- Combat formula and defense stats of mobs updated","- Support for multiple game worlds now completed"]},"alpha-2.3.4":{title:"Kaetram alpha-2.3.4",content:["- Added arrows to archery","- Added boots","- Added following functionality","- Right-click interaction with mobs and items","- Zooming now available on mobile","- Fixes player stuck online bug","- Fixes bug where items would disappear when unequipping","- Fixes and improvements to the user interface","- Fixes WASD interaction with NPCs/mobs"]},"alpha-2.3.5":{title:"Kaetram alpha-2.3.5",content:["- Added player trading","- Added shared exp (based on damage contributions to mob)","- Added priority drops (whoever does most damage has priority to an item)","- Polished bank/store containers","- Tweaked item prices, drop rates, stats, and descriptions","- Bank is now stackable for all items","- Graphical rehaul on many sprites","- Buy/drop/etc X amount","- Various bug fixes and backend improvements"]},"alpha-2.4.0":{title:"Kaetram alpha-2.4.0",content:["- Added Defense skill, attack styles, and secret achievements","- Added freezing effect and snow potion functionality","- Added PVP areas, new quests, and new areas","- Experience gain is now on a per-hit basis","- New interfaces for profile, skills, and friends list","- Fix bank/inventory/store-related bugs","- Fix cross-server private messaging","- Loads of backend improvements and optimizations"]},"alpha-2.4.1":{title:"Kaetram alpha-2.4.1",content:["- Added guilds","- Added leaderboards","- Added special effects to arrows","- Added weapon enchanting","- Adjusted stats for mobs and items","- Enahanced mob attack logic","- Major improvements to the backend","- And many more bug fixes and improvements"]},"alpha-2.5.0":{title:"Kaetram alpha-2.5.0",content:["- Added 8 new skills","- Added new areas/bosses/achievements/quests","- Added many new items","- Increased inventory/bank size","- Fix status effects not being removed","- Fix bug with the death animation hanging","- Fix bug with character animations","- Many new features and bug fixes"]},"alpha-2.5.1":{title:"Kaetram alpha-2.5.1",content:["- Adds missing items to the game","- Fixed collisions around the map","- Fixed freezing bug with fishing spots","- Fixes to the death animation","- Fixes fishing bug when inventory full","- Fixed pirate captain teleport bug","- Update user interface icons"]}};class of{constructor(){l(this,"config",{name:"Kaetram",host:"localhost",ssl:!1,serverId:1,sentryDsn:"",debug:!1,version:"v-1.0.0",minor:"",port:9001,hub:!1});l(this,"storage",new sf);l(this,"body",document.querySelector("body"));l(this,"parchment",document.querySelector("#parchment"));l(this,"canvas",document.querySelector("#canvas"));l(this,"loginForm",document.querySelector("#load-character form"));l(this,"registerForm",document.querySelector("#create-character form"));l(this,"worldsList",document.querySelector("#worlds"));l(this,"passwordConfirmation",document.querySelector("#register-password-confirmation-input"));l(this,"emailField",document.querySelector("#register-email-input"));l(this,"loginButton",document.querySelector("#login"));l(this,"registerButton",document.querySelector("#new-account"));l(this,"cancelRegister",document.querySelector("#cancel-register"));l(this,"cancelWorlds",document.querySelector("#cancel-worlds"));l(this,"continueWorlds",document.querySelector("#continue-worlds"));l(this,"respawn",document.querySelector("#respawn"));l(this,"rememberMe",document.querySelector("#remember-me input"));l(this,"guest",document.querySelector("#guest input"));l(this,"about",document.querySelector("#toggle-about"));l(this,"validation",document.querySelectorAll(".validation-summary"));l(this,"loading",document.querySelector(".loader"));l(this,"worldSelectButton",document.querySelector("#world-select-button"));l(this,"gameVersion",document.querySelector("#game-version"));l(this,"currentScroll","load-character");l(this,"parchmentAnimating",!1);l(this,"loggingIn",!1);l(this,"menuHidden",!1);l(this,"statusMessage","");l(this,"selectedServer");l(this,"keyDownCallback");l(this,"keyUpCallback");l(this,"loginCallback");l(this,"leftClickCallback");l(this,"rightClickCallback");l(this,"mouseMoveCallback");l(this,"resizeCallback");l(this,"respawnCallback");l(this,"focusCallback");this.sendStatus("Initializing the game client"),this.load()}load(){this.loginForm.addEventListener("submit",this.login.bind(this)),this.registerForm.addEventListener("submit",this.login.bind(this)),this.registerButton.addEventListener("click",()=>this.openScroll("create-character")),this.cancelRegister.addEventListener("click",()=>this.openScroll("load-character")),this.cancelWorlds.addEventListener("click",()=>this.openScroll("load-character")),this.continueWorlds.addEventListener("click",()=>this.openScroll("load-character")),this.about.addEventListener("click",()=>this.openScroll("about")),this.respawn.addEventListener("click",()=>{var t;return(t=this.respawnCallback)==null?void 0:t.call(this)}),this.parchment.addEventListener("click",()=>{this.hasFooterOpen()&&this.openScroll("load-character"),this.body.classList.contains("news")&&this.body.classList.remove("news")}),this.worldSelectButton.addEventListener("click",()=>this.openScroll("world-select")),this.gameVersion.textContent=`${this.config.version}${this.config.minor}`,document.addEventListener("keydown",t=>t.key!=="Enter"),document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",t=>{var e;return(e=this.keyUpCallback)==null?void 0:e.call(this,t)}),document.addEventListener("mousemove",t=>{var e;return(e=this.mouseMoveCallback)==null?void 0:e.call(this,t)}),this.canvas.addEventListener("click",t=>{var e;return(e=this.leftClickCallback)==null?void 0:e.call(this,t)}),window.addEventListener("resize",()=>{var t;return(t=this.resizeCallback)==null?void 0:t.call(this)}),window.addEventListener("focus",()=>{var t;return(t=this.focusCallback)==null?void 0:t.call(this)}),ra(document.querySelector("#canvas"),t=>{var e;return(e=this.rightClickCallback)==null?void 0:e.call(this,t)})}loadLogin(){let t=this.storage.getError();t&&this.sendError(t),this.storage.hasRemember()&&(this.getUsernameField().value=this.storage.getUsername(),this.getPasswordField().value=this.storage.getPassword(),this.rememberMe.checked=!0)}handleKeyDown(t){var e;if(this.isMenuHidden())return(e=this.keyDownCallback)==null?void 0:e.call(this,t);t.key==="Enter"&&this.login()}ready(){this.sendStatus(),this.loginButton.disabled=!1,this.loadLogin(),this.loadWorlds(),"indexedDB"in window||this.setValidation("validation-warning","Your browser does not support IndexedDB. Regions will not be cached.")}login(){var t;this.loggingIn||this.statusMessage||!this.verifyForm()||(this.clearErrors(),this.toggleLogin(!0),(t=this.loginCallback)==null||t.call(this,this.selectedServer),Zd())}saveLogin(){this.storage.setRemember(this.isRememberMe()),this.storage.setCredentials(),this.isRememberMe()&&this.storage.setCredentials(this.getUsername(),this.getPassword())}showMenu(){this.body.className="intro",this.menuHidden=!1,this.worldSelectButton.hidden=!1,this.gameVersion.hidden=!1}fadeMenu(){this.menuHidden||(this.body.className="game",this.menuHidden=!0,this.worldSelectButton.hidden=!0,this.gameVersion.hidden=!0,this.updateLoader(),this.saveLogin(),setTimeout(()=>this.displayNews(),1e3))}openScroll(t){this.loggingIn||this.parchmentAnimating||(this.clearErrors(),this.changeScroll(t,!yi()))}changeScroll(t,e=!1){e?(this.parchmentAnimating=!0,this.parchment.classList.toggle("animate"),this.parchment.classList.remove(this.currentScroll),window.setTimeout(()=>{var n;this.parchmentAnimating=!1,this.parchment.classList.toggle("animate"),this.parchment.classList.add(t),(n=document.querySelector(`#${t} input`))==null||n.focus()},1e3)):(this.parchment.classList.remove(this.currentScroll),this.parchment.classList.add(t)),this.currentScroll=t}verifyForm(){if(this.isGuest())return!0;if(!this.getUsername())return this.sendError("Please enter a username.",this.getUsernameField());if(!this.getPassword())return this.sendError("Please enter a password.",this.getPasswordField());if(this.isRegistering()){if(this.getPassword().length<3)return this.sendError("Password must be at least 3 characters long.",this.getPasswordField());if(this.getPassword()!==this.getPasswordConfirmation())return this.sendError("Passwords do not match.",this.passwordConfirmation);if(this.getEmail()!==""&&!q.isEmail(this.getEmail()))return this.sendError("The email you've entered is not valid.",this.emailField)}return!0}sendStatus(t=""){if(this.clearErrors(),this.statusMessage=t,!t)return;this.setValidation("status",t);let e=document.querySelector(".status");e&&(e.innerHTML=t+this.getLoaderDots())}updateLoader(t=""){this.loading.innerHTML=t?t+this.getLoaderDots():""}displayNews(){let t=document.querySelector("#news-title"),e=document.querySelector("#news-content");if(!(!t||!e)){if(this.storage.isNew())return this.body.classList.add("news");if(this.storage.newVersion){t.textContent=`Kaetram ${this.config.version} Changelog`;let n=af[this.config.version];if(!n)return;e.textContent="";for(let r of n.content)e.innerHTML+=`${r}<br>`;this.body.classList.add("news")}}}sendError(t,e){if(this.isMenuHidden())return this.storage.setError(t);if(this.clearErrors(),this.setValidation("validation-error",t),!e)return!1;e.classList.add("field-error"),e.focus();let n=()=>{var r;e.removeEventListener("keypress",n,!1),e.classList.remove("field-error"),(r=document.querySelector(".validation-error"))==null||r.remove()};return e.addEventListener("keypress",n),!1}clearErrors(){var t;(t=document.querySelector(".status"))==null||t.remove(),this.clearValidation(),this.getUsernameField().classList.remove("field-error"),this.getPasswordField().classList.remove("field-error"),this.passwordConfirmation.classList.remove("field-error"),this.emailField.classList.remove("field-error")}toggleLogin(t){this.updateLoader("Connecting"),this.toggleTyping(t),this.loggingIn=t,this.loading.hidden=!t,this.loginButton.disabled=t,this.registerButton.disabled=t;const e=document.getElementById("logo");e&&(e.style.display="none")}toggleTyping(t){this.getUsernameField().readOnly=t,this.getPasswordField().readOnly=t,this.passwordConfirmation.readOnly=t,this.emailField.readOnly=t}hasFooterOpen(){return this.parchment.classList.contains("about")}isGuest(){return this.guest.checked}isRememberMe(){return this.rememberMe.checked}isRegistering(){return this.currentScroll==="create-character"}isMenuHidden(){return this.menuHidden}getUsernameField(){return document.querySelector(this.isRegistering()?"#register-name-input":"#login-name-input")}getUsername(){return this.getUsernameField().value}getPasswordField(){return document.querySelector(this.isRegistering()?"#register-password-input":"#login-password-input")}getPassword(){return this.getPasswordField().value}getPasswordConfirmation(){return this.passwordConfirmation.value}getEmail(){return this.isRegistering()?this.emailField.value:""}getLoaderDots(){return'<span class="loader-dot">.</span><span class="loader-dot">.</span><span class="loader-dot">.</span>'}clearValidation(){for(let t of this.validation)t.innerHTML=""}setValidation(t,e=""){this.clearValidation();for(let n of this.validation)n.append(this.createValidation(t,e))}createValidation(t,e=""){let n=document.createElement("span");return n.classList.add(t),n.classList.add("blink"),n.textContent=e,n}selectServer(t){this.selectedServer=t;let e=this.worldSelectButton.querySelector("strong");e.textContent=`${t.name} ${t.id}`;let n=this.worldSelectButton.querySelector("span");n.textContent=`(${t.players}/${t.maxPlayers} players)`}async loadWorlds(){if(!this.config.hub)return;let t=await fetch(`${this.config.hub}/all`).catch(()=>null);if(!t)return this.setValidation("validation-error","Unable to load world list.");let e=await t.json(),[n]=e;if(!n)return this.setValidation("validation-error","No servers are currently available.");if(this.selectServer(n),!(e.length<2)){this.worldSelectButton.hidden=!1;for(let r in e){let a=e[r],d=document.createElement("li"),u=document.createElement("strong"),y=document.createElement("span");parseInt(r)===0&&d.classList.add("active"),u.textContent=`${a.name} ${a.id}`,y.textContent=`${a.players}/${a.maxPlayers} players`,d.append(u),d.append(y),d.addEventListener("click",()=>{var m;this.selectServer(a),(m=this.worldsList.querySelector("li.active"))==null||m.classList.remove("active"),d.classList.add("active")}),this.worldsList.append(d)}}}onKeyDown(t){this.keyDownCallback=t}onKeyUp(t){this.keyUpCallback=t}onLogin(t){this.loginCallback=t}onLeftClick(t){this.leftClickCallback=t}onRightClick(t){this.rightClickCallback=t}onMouseMove(t){this.mouseMoveCallback=t}onResize(t){this.resizeCallback=t}onRespawn(t){this.respawnCallback=t}onFocus(t){this.focusCallback=t}}class lf{constructor(t){l(this,"musicCrossfadeDuration",3);l(this,"musicMinGain",.01);l(this,"musicMaxGain",.5);l(this,"buffers",{});l(this,"context");l(this,"musicGainNode");l(this,"isMusicConnected",!1);this.game=t}createContext(){this.context=new AudioContext}async playSound(t,e){if(!this.isAudioEnabled())return;let n=await this.bufferSource(`/audio/sounds/${t}.mp3`),r=this.getSoundVolume(),a=n.connect(new GainNode(this.context,{gain:r}));if(e&&!this.getSettings().lowPowerMode){let{tileSize:u}=this.game.map;a=a.connect(new PannerNode(this.context,{positionX:e.x,positionY:e.y,distanceModel:"linear",refDistance:u,maxDistance:u*10}))}a.connect(this.context.destination);let{gain:d}=this.musicGainNode;d.cancelScheduledValues(this.context.currentTime),this.rampGain(d,d.value-r*this.musicMaxGain/2),n.addEventListener("ended",()=>{this.rampGain(d,this.getMusicVolume(),.5)}),n.start()}async playMusic(t){if(!t)return this.stopMusic();let e=await this.bufferSource(`/audio/music/${t}.mp3`);e.loop=!0,this.stopMusic(),e.connect(this.musicGainNode),this.isAudioEnabled()&&this.musicGainNode.connect(this.context.destination),this.rampGain(this.musicGainNode.gain,this.getMusicVolume(),this.musicCrossfadeDuration),e.start()}async bufferSource(t){var e,n;return this.updateVolume(),(n=(e=this.buffers)[t])!=null||(e[t]=this.loadAudio(t)),new AudioBufferSourceNode(this.context,{buffer:await this.buffers[t]})}async loadAudio(t){let e=await fetch(t),n=await e.arrayBuffer();return await this.context.decodeAudioData(n)}updateVolume(){this.musicGainNode||this.initMusicNode();let t=this.getMusicVolume();if(t<=0||!this.isAudioEnabled())this.isMusicConnected&&(this.musicGainNode.disconnect(this.context.destination),this.isMusicConnected=!1);else{let{gain:e}=this.musicGainNode;e.cancelScheduledValues(this.context.currentTime),this.isMusicConnected?this.rampGain(e,t):(this.musicGainNode.connect(this.context.destination),this.isMusicConnected=!0,this.rampGain(e,this.musicMinGain),this.rampGain(e,t,this.musicCrossfadeDuration))}}updatePlayerListener(){if(!this.context||!this.isAudioEnabled()||this.getSettings().lowPowerMode)return;let{player:t}=this.game,{positionX:e,positionY:n,forwardX:r,forwardY:a}=this.context.listener;if(!e||!n||!r||!a){this.context.listener.setPosition(t.x,t.y,0);return}switch(e.value=t.x,n.value=t.y,t.orientation){case re.Up:{r.value=0,a.value=1;break}case re.Down:{r.value=0,a.value=-1;break}case re.Left:{r.value=-1,a.value=0;break}case re.Right:{r.value=1,a.value=0;break}}}stopMusic(){let t=this.musicGainNode;if(this.initMusicNode(),!t)return;let{gain:e}=t;e.cancelScheduledValues(this.context.currentTime),this.rampGain(e,this.musicMinGain,this.musicCrossfadeDuration),setTimeout(()=>t.disconnect(),this.musicCrossfadeDuration*1e3)}initMusicNode(){this.musicGainNode=new GainNode(this.context,{gain:this.musicMinGain})}rampGain(t,e,n=0){e>0&&t.linearRampToValueAtTime(e,this.context.currentTime+n)}getSoundVolume(){return this.getSettings().soundVolume/100}getMusicVolume(){return this.getSettings().musicVolume/100*this.musicMaxGain*2}isAudioEnabled(){return this.getSettings().audioEnabled}getSettings(){return this.game.storage.data.settings}playHitSound(t){this.playSound(`hit${q.randomInt(1,2)}`,t)}playKillSound(t){this.playSound(`kill${q.randomInt(1,2)}`,t)}}class hf{constructor(t,e){this.time=t,this.duration=e}isOver(t){return t-this.time>this.duration}}var df=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_t={},ff={get exports(){return _t},set exports(i){_t=i}};/*!
 * jQuery JavaScript Library v3.6.3
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2022-12-20T21:28Z
 */(function(i){(function(t,e){i.exports=t.document?e(t,!0):function(n){if(!n.document)throw new Error("jQuery requires a window with a document");return e(n)}})(typeof window<"u"?window:df,function(t,e){var n=[],r=Object.getPrototypeOf,a=n.slice,d=n.flat?function(s){return n.flat.call(s)}:function(s){return n.concat.apply([],s)},u=n.push,y=n.indexOf,m={},b=m.toString,E=m.hasOwnProperty,Y=E.toString,I=Y.call(Object),A={},O=function(o){return typeof o=="function"&&typeof o.nodeType!="number"&&typeof o.item!="function"},J=function(o){return o!=null&&o===o.window},F=t.document,ue={type:!0,src:!0,nonce:!0,noModule:!0};function j(s,o,h){h=h||F;var f,g,p=h.createElement("script");if(p.text=s,o)for(f in ue)g=o[f]||o.getAttribute&&o.getAttribute(f),g&&p.setAttribute(f,g);h.head.appendChild(p).parentNode.removeChild(p)}function z(s){return s==null?s+"":typeof s=="object"||typeof s=="function"?m[b.call(s)]||"object":typeof s}var te="3.6.3",c=function(s,o){return new c.fn.init(s,o)};c.fn=c.prototype={jquery:te,constructor:c,length:0,toArray:function(){return a.call(this)},get:function(s){return s==null?a.call(this):s<0?this[s+this.length]:this[s]},pushStack:function(s){var o=c.merge(this.constructor(),s);return o.prevObject=this,o},each:function(s){return c.each(this,s)},map:function(s){return this.pushStack(c.map(this,function(o,h){return s.call(o,h,o)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(c.grep(this,function(s,o){return(o+1)%2}))},odd:function(){return this.pushStack(c.grep(this,function(s,o){return o%2}))},eq:function(s){var o=this.length,h=+s+(s<0?o:0);return this.pushStack(h>=0&&h<o?[this[h]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:n.sort,splice:n.splice},c.extend=c.fn.extend=function(){var s,o,h,f,g,p,w=arguments[0]||{},S=1,k=arguments.length,C=!1;for(typeof w=="boolean"&&(C=w,w=arguments[S]||{},S++),typeof w!="object"&&!O(w)&&(w={}),S===k&&(w=this,S--);S<k;S++)if((s=arguments[S])!=null)for(o in s)f=s[o],!(o==="__proto__"||w===f)&&(C&&f&&(c.isPlainObject(f)||(g=Array.isArray(f)))?(h=w[o],g&&!Array.isArray(h)?p=[]:!g&&!c.isPlainObject(h)?p={}:p=h,g=!1,w[o]=c.extend(C,p,f)):f!==void 0&&(w[o]=f));return w},c.extend({expando:"jQuery"+(te+Math.random()).replace(/\D/g,""),isReady:!0,error:function(s){throw new Error(s)},noop:function(){},isPlainObject:function(s){var o,h;return!s||b.call(s)!=="[object Object]"?!1:(o=r(s),o?(h=E.call(o,"constructor")&&o.constructor,typeof h=="function"&&Y.call(h)===I):!0)},isEmptyObject:function(s){var o;for(o in s)return!1;return!0},globalEval:function(s,o,h){j(s,{nonce:o&&o.nonce},h)},each:function(s,o){var h,f=0;if(W(s))for(h=s.length;f<h&&o.call(s[f],f,s[f])!==!1;f++);else for(f in s)if(o.call(s[f],f,s[f])===!1)break;return s},makeArray:function(s,o){var h=o||[];return s!=null&&(W(Object(s))?c.merge(h,typeof s=="string"?[s]:s):u.call(h,s)),h},inArray:function(s,o,h){return o==null?-1:y.call(o,s,h)},merge:function(s,o){for(var h=+o.length,f=0,g=s.length;f<h;f++)s[g++]=o[f];return s.length=g,s},grep:function(s,o,h){for(var f,g=[],p=0,w=s.length,S=!h;p<w;p++)f=!o(s[p],p),f!==S&&g.push(s[p]);return g},map:function(s,o,h){var f,g,p=0,w=[];if(W(s))for(f=s.length;p<f;p++)g=o(s[p],p,h),g!=null&&w.push(g);else for(p in s)g=o(s[p],p,h),g!=null&&w.push(g);return d(w)},guid:1,support:A}),typeof Symbol=="function"&&(c.fn[Symbol.iterator]=n[Symbol.iterator]),c.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(s,o){m["[object "+o+"]"]=o.toLowerCase()});function W(s){var o=!!s&&"length"in s&&s.length,h=z(s);return O(s)||J(s)?!1:h==="array"||o===0||typeof o=="number"&&o>0&&o-1 in s}var ge=function(s){var o,h,f,g,p,w,S,k,C,L,M,X,D,G,ae,$,De,Ae,tt,ye="sizzle"+1*new Date,se=s.document,Ke=0,me=0,Ie=Vn(),sn=Vn(),jn=Vn(),it=Vn(),ri=function(_,v){return _===v&&(M=!0),0},si={}.hasOwnProperty,Qe=[],Ut=Qe.pop,dt=Qe.push,Ht=Qe.push,io=Qe.slice,ai=function(_,v){for(var x=0,R=_.length;x<R;x++)if(_[x]===v)return x;return-1},es="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",be="[\\x20\\t\\r\\n\\f]",oi="(?:\\\\[\\da-fA-F]{1,6}"+be+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",no="\\["+be+"*("+oi+")(?:"+be+"*([*^$|!~]?=)"+be+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+oi+"))|)"+be+"*\\]",ts=":("+oi+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+no+")*)|.*)\\)|)",Yd=new RegExp(be+"+","g"),Gn=new RegExp("^"+be+"+|((?:^|[^\\\\])(?:\\\\.)*)"+be+"+$","g"),Xd=new RegExp("^"+be+"*,"+be+"*"),ro=new RegExp("^"+be+"*([>+~]|"+be+")"+be+"*"),Ld=new RegExp(be+"|>"),Ad=new RegExp(ts),Dd=new RegExp("^"+oi+"$"),Wn={ID:new RegExp("^#("+oi+")"),CLASS:new RegExp("^\\.("+oi+")"),TAG:new RegExp("^("+oi+"|[*])"),ATTR:new RegExp("^"+no),PSEUDO:new RegExp("^"+ts),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+be+"*(even|odd|(([+-]|)(\\d*)n|)"+be+"*(?:([+-]|)"+be+"*(\\d+)|))"+be+"*\\)|)","i"),bool:new RegExp("^(?:"+es+")$","i"),needsContext:new RegExp("^"+be+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+be+"*((?:-\\d)?\\d*)"+be+"*\\)|)(?=[^-]|$)","i")},Rd=/HTML$/i,Nd=/^(?:input|select|textarea|button)$/i,Md=/^h\d$/i,an=/^[^{]+\{\s*\[native \w/,Pd=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,is=/[+~]/,Dt=new RegExp("\\\\[\\da-fA-F]{1,6}"+be+"?|\\\\([^\\r\\n\\f])","g"),Rt=function(_,v){var x="0x"+_.slice(1)-65536;return v||(x<0?String.fromCharCode(x+65536):String.fromCharCode(x>>10|55296,x&1023|56320))},so=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ao=function(_,v){return v?_==="\0"?"�":_.slice(0,-1)+"\\"+_.charCodeAt(_.length-1).toString(16)+" ":"\\"+_},oo=function(){X()},Od=Kn(function(_){return _.disabled===!0&&_.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{Ht.apply(Qe=io.call(se.childNodes),se.childNodes),Qe[se.childNodes.length].nodeType}catch(_){Ht={apply:Qe.length?function(v,x){dt.apply(v,io.call(x))}:function(v,x){for(var R=v.length,T=0;v[R++]=x[T++];);v.length=R-1}}}function ve(_,v,x,R){var T,N,P,U,H,K,V,ee=v&&v.ownerDocument,ce=v?v.nodeType:9;if(x=x||[],typeof _!="string"||!_||ce!==1&&ce!==9&&ce!==11)return x;if(!R&&(X(v),v=v||D,ae)){if(ce!==11&&(H=Pd.exec(_)))if(T=H[1]){if(ce===9)if(P=v.getElementById(T)){if(P.id===T)return x.push(P),x}else return x;else if(ee&&(P=ee.getElementById(T))&&tt(v,P)&&P.id===T)return x.push(P),x}else{if(H[2])return Ht.apply(x,v.getElementsByTagName(_)),x;if((T=H[3])&&h.getElementsByClassName&&v.getElementsByClassName)return Ht.apply(x,v.getElementsByClassName(T)),x}if(h.qsa&&!it[_+" "]&&(!$||!$.test(_))&&(ce!==1||v.nodeName.toLowerCase()!=="object")){if(V=_,ee=v,ce===1&&(Ld.test(_)||ro.test(_))){for(ee=is.test(_)&&rs(v.parentNode)||v,(ee!==v||!h.scope)&&((U=v.getAttribute("id"))?U=U.replace(so,ao):v.setAttribute("id",U=ye)),K=w(_),N=K.length;N--;)K[N]=(U?"#"+U:":scope")+" "+Zn(K[N]);V=K.join(",")}try{if(h.cssSupportsSelector&&!CSS.supports("selector(:is("+V+"))"))throw new Error;return Ht.apply(x,ee.querySelectorAll(V)),x}catch(Se){it(_,!0)}finally{U===ye&&v.removeAttribute("id")}}}return k(_.replace(Gn,"$1"),v,x,R)}function Vn(){var _=[];function v(x,R){return _.push(x+" ")>f.cacheLength&&delete v[_.shift()],v[x+" "]=R}return v}function pt(_){return _[ye]=!0,_}function ft(_){var v=D.createElement("fieldset");try{return!!_(v)}catch(x){return!1}finally{v.parentNode&&v.parentNode.removeChild(v),v=null}}function ns(_,v){for(var x=_.split("|"),R=x.length;R--;)f.attrHandle[x[R]]=v}function lo(_,v){var x=v&&_,R=x&&_.nodeType===1&&v.nodeType===1&&_.sourceIndex-v.sourceIndex;if(R)return R;if(x){for(;x=x.nextSibling;)if(x===v)return-1}return _?1:-1}function qd(_){return function(v){var x=v.nodeName.toLowerCase();return x==="input"&&v.type===_}}function Bd(_){return function(v){var x=v.nodeName.toLowerCase();return(x==="input"||x==="button")&&v.type===_}}function ho(_){return function(v){return"form"in v?v.parentNode&&v.disabled===!1?"label"in v?"label"in v.parentNode?v.parentNode.disabled===_:v.disabled===_:v.isDisabled===_||v.isDisabled!==!_&&Od(v)===_:v.disabled===_:"label"in v?v.disabled===_:!1}}function li(_){return pt(function(v){return v=+v,pt(function(x,R){for(var T,N=_([],x.length,v),P=N.length;P--;)x[T=N[P]]&&(x[T]=!(R[T]=x[T]))})})}function rs(_){return _&&typeof _.getElementsByTagName<"u"&&_}h=ve.support={},p=ve.isXML=function(_){var v=_&&_.namespaceURI,x=_&&(_.ownerDocument||_).documentElement;return!Rd.test(v||x&&x.nodeName||"HTML")},X=ve.setDocument=function(_){var v,x,R=_?_.ownerDocument||_:se;return R==D||R.nodeType!==9||!R.documentElement||(D=R,G=D.documentElement,ae=!p(D),se!=D&&(x=D.defaultView)&&x.top!==x&&(x.addEventListener?x.addEventListener("unload",oo,!1):x.attachEvent&&x.attachEvent("onunload",oo)),h.scope=ft(function(T){return G.appendChild(T).appendChild(D.createElement("div")),typeof T.querySelectorAll<"u"&&!T.querySelectorAll(":scope fieldset div").length}),h.cssSupportsSelector=ft(function(){return CSS.supports("selector(*)")&&D.querySelectorAll(":is(:jqfake)")&&!CSS.supports("selector(:is(*,:jqfake))")}),h.attributes=ft(function(T){return T.className="i",!T.getAttribute("className")}),h.getElementsByTagName=ft(function(T){return T.appendChild(D.createComment("")),!T.getElementsByTagName("*").length}),h.getElementsByClassName=an.test(D.getElementsByClassName),h.getById=ft(function(T){return G.appendChild(T).id=ye,!D.getElementsByName||!D.getElementsByName(ye).length}),h.getById?(f.filter.ID=function(T){var N=T.replace(Dt,Rt);return function(P){return P.getAttribute("id")===N}},f.find.ID=function(T,N){if(typeof N.getElementById<"u"&&ae){var P=N.getElementById(T);return P?[P]:[]}}):(f.filter.ID=function(T){var N=T.replace(Dt,Rt);return function(P){var U=typeof P.getAttributeNode<"u"&&P.getAttributeNode("id");return U&&U.value===N}},f.find.ID=function(T,N){if(typeof N.getElementById<"u"&&ae){var P,U,H,K=N.getElementById(T);if(K){if(P=K.getAttributeNode("id"),P&&P.value===T)return[K];for(H=N.getElementsByName(T),U=0;K=H[U++];)if(P=K.getAttributeNode("id"),P&&P.value===T)return[K]}return[]}}),f.find.TAG=h.getElementsByTagName?function(T,N){if(typeof N.getElementsByTagName<"u")return N.getElementsByTagName(T);if(h.qsa)return N.querySelectorAll(T)}:function(T,N){var P,U=[],H=0,K=N.getElementsByTagName(T);if(T==="*"){for(;P=K[H++];)P.nodeType===1&&U.push(P);return U}return K},f.find.CLASS=h.getElementsByClassName&&function(T,N){if(typeof N.getElementsByClassName<"u"&&ae)return N.getElementsByClassName(T)},De=[],$=[],(h.qsa=an.test(D.querySelectorAll))&&(ft(function(T){var N;G.appendChild(T).innerHTML="<a id='"+ye+"'></a><select id='"+ye+"-\r\\' msallowcapture=''><option selected=''></option></select>",T.querySelectorAll("[msallowcapture^='']").length&&$.push("[*^$]="+be+`*(?:''|"")`),T.querySelectorAll("[selected]").length||$.push("\\["+be+"*(?:value|"+es+")"),T.querySelectorAll("[id~="+ye+"-]").length||$.push("~="),N=D.createElement("input"),N.setAttribute("name",""),T.appendChild(N),T.querySelectorAll("[name='']").length||$.push("\\["+be+"*name"+be+"*="+be+`*(?:''|"")`),T.querySelectorAll(":checked").length||$.push(":checked"),T.querySelectorAll("a#"+ye+"+*").length||$.push(".#.+[+~]"),T.querySelectorAll("\\\f"),$.push("[\\r\\n\\f]")}),ft(function(T){T.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var N=D.createElement("input");N.setAttribute("type","hidden"),T.appendChild(N).setAttribute("name","D"),T.querySelectorAll("[name=d]").length&&$.push("name"+be+"*[*^$|!~]?="),T.querySelectorAll(":enabled").length!==2&&$.push(":enabled",":disabled"),G.appendChild(T).disabled=!0,T.querySelectorAll(":disabled").length!==2&&$.push(":enabled",":disabled"),T.querySelectorAll("*,:x"),$.push(",.*:")})),(h.matchesSelector=an.test(Ae=G.matches||G.webkitMatchesSelector||G.mozMatchesSelector||G.oMatchesSelector||G.msMatchesSelector))&&ft(function(T){h.disconnectedMatch=Ae.call(T,"*"),Ae.call(T,"[s!='']:x"),De.push("!=",ts)}),h.cssSupportsSelector||$.push(":has"),$=$.length&&new RegExp($.join("|")),De=De.length&&new RegExp(De.join("|")),v=an.test(G.compareDocumentPosition),tt=v||an.test(G.contains)?function(T,N){var P=T.nodeType===9&&T.documentElement||T,U=N&&N.parentNode;return T===U||!!(U&&U.nodeType===1&&(P.contains?P.contains(U):T.compareDocumentPosition&&T.compareDocumentPosition(U)&16))}:function(T,N){if(N){for(;N=N.parentNode;)if(N===T)return!0}return!1},ri=v?function(T,N){if(T===N)return M=!0,0;var P=!T.compareDocumentPosition-!N.compareDocumentPosition;return P||(P=(T.ownerDocument||T)==(N.ownerDocument||N)?T.compareDocumentPosition(N):1,P&1||!h.sortDetached&&N.compareDocumentPosition(T)===P?T==D||T.ownerDocument==se&&tt(se,T)?-1:N==D||N.ownerDocument==se&&tt(se,N)?1:L?ai(L,T)-ai(L,N):0:P&4?-1:1)}:function(T,N){if(T===N)return M=!0,0;var P,U=0,H=T.parentNode,K=N.parentNode,V=[T],ee=[N];if(!H||!K)return T==D?-1:N==D?1:H?-1:K?1:L?ai(L,T)-ai(L,N):0;if(H===K)return lo(T,N);for(P=T;P=P.parentNode;)V.unshift(P);for(P=N;P=P.parentNode;)ee.unshift(P);for(;V[U]===ee[U];)U++;return U?lo(V[U],ee[U]):V[U]==se?-1:ee[U]==se?1:0}),D},ve.matches=function(_,v){return ve(_,null,null,v)},ve.matchesSelector=function(_,v){if(X(_),h.matchesSelector&&ae&&!it[v+" "]&&(!De||!De.test(v))&&(!$||!$.test(v)))try{var x=Ae.call(_,v);if(x||h.disconnectedMatch||_.document&&_.document.nodeType!==11)return x}catch(R){it(v,!0)}return ve(v,D,null,[_]).length>0},ve.contains=function(_,v){return(_.ownerDocument||_)!=D&&X(_),tt(_,v)},ve.attr=function(_,v){(_.ownerDocument||_)!=D&&X(_);var x=f.attrHandle[v.toLowerCase()],R=x&&si.call(f.attrHandle,v.toLowerCase())?x(_,v,!ae):void 0;return R!==void 0?R:h.attributes||!ae?_.getAttribute(v):(R=_.getAttributeNode(v))&&R.specified?R.value:null},ve.escape=function(_){return(_+"").replace(so,ao)},ve.error=function(_){throw new Error("Syntax error, unrecognized expression: "+_)},ve.uniqueSort=function(_){var v,x=[],R=0,T=0;if(M=!h.detectDuplicates,L=!h.sortStable&&_.slice(0),_.sort(ri),M){for(;v=_[T++];)v===_[T]&&(R=x.push(T));for(;R--;)_.splice(x[R],1)}return L=null,_},g=ve.getText=function(_){var v,x="",R=0,T=_.nodeType;if(T){if(T===1||T===9||T===11){if(typeof _.textContent=="string")return _.textContent;for(_=_.firstChild;_;_=_.nextSibling)x+=g(_)}else if(T===3||T===4)return _.nodeValue}else for(;v=_[R++];)x+=g(v);return x},f=ve.selectors={cacheLength:50,createPseudo:pt,match:Wn,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(_){return _[1]=_[1].replace(Dt,Rt),_[3]=(_[3]||_[4]||_[5]||"").replace(Dt,Rt),_[2]==="~="&&(_[3]=" "+_[3]+" "),_.slice(0,4)},CHILD:function(_){return _[1]=_[1].toLowerCase(),_[1].slice(0,3)==="nth"?(_[3]||ve.error(_[0]),_[4]=+(_[4]?_[5]+(_[6]||1):2*(_[3]==="even"||_[3]==="odd")),_[5]=+(_[7]+_[8]||_[3]==="odd")):_[3]&&ve.error(_[0]),_},PSEUDO:function(_){var v,x=!_[6]&&_[2];return Wn.CHILD.test(_[0])?null:(_[3]?_[2]=_[4]||_[5]||"":x&&Ad.test(x)&&(v=w(x,!0))&&(v=x.indexOf(")",x.length-v)-x.length)&&(_[0]=_[0].slice(0,v),_[2]=x.slice(0,v)),_.slice(0,3))}},filter:{TAG:function(_){var v=_.replace(Dt,Rt).toLowerCase();return _==="*"?function(){return!0}:function(x){return x.nodeName&&x.nodeName.toLowerCase()===v}},CLASS:function(_){var v=Ie[_+" "];return v||(v=new RegExp("(^|"+be+")"+_+"("+be+"|$)"))&&Ie(_,function(x){return v.test(typeof x.className=="string"&&x.className||typeof x.getAttribute<"u"&&x.getAttribute("class")||"")})},ATTR:function(_,v,x){return function(R){var T=ve.attr(R,_);return T==null?v==="!=":v?(T+="",v==="="?T===x:v==="!="?T!==x:v==="^="?x&&T.indexOf(x)===0:v==="*="?x&&T.indexOf(x)>-1:v==="$="?x&&T.slice(-x.length)===x:v==="~="?(" "+T.replace(Yd," ")+" ").indexOf(x)>-1:v==="|="?T===x||T.slice(0,x.length+1)===x+"-":!1):!0}},CHILD:function(_,v,x,R,T){var N=_.slice(0,3)!=="nth",P=_.slice(-4)!=="last",U=v==="of-type";return R===1&&T===0?function(H){return!!H.parentNode}:function(H,K,V){var ee,ce,Se,Q,Re,Ue,nt=N!==P?"nextSibling":"previousSibling",Ee=H.parentNode,on=U&&H.nodeName.toLowerCase(),ln=!V&&!U,rt=!1;if(Ee){if(N){for(;nt;){for(Q=H;Q=Q[nt];)if(U?Q.nodeName.toLowerCase()===on:Q.nodeType===1)return!1;Ue=nt=_==="only"&&!Ue&&"nextSibling"}return!0}if(Ue=[P?Ee.firstChild:Ee.lastChild],P&&ln){for(Q=Ee,Se=Q[ye]||(Q[ye]={}),ce=Se[Q.uniqueID]||(Se[Q.uniqueID]={}),ee=ce[_]||[],Re=ee[0]===Ke&&ee[1],rt=Re&&ee[2],Q=Re&&Ee.childNodes[Re];Q=++Re&&Q&&Q[nt]||(rt=Re=0)||Ue.pop();)if(Q.nodeType===1&&++rt&&Q===H){ce[_]=[Ke,Re,rt];break}}else if(ln&&(Q=H,Se=Q[ye]||(Q[ye]={}),ce=Se[Q.uniqueID]||(Se[Q.uniqueID]={}),ee=ce[_]||[],Re=ee[0]===Ke&&ee[1],rt=Re),rt===!1)for(;(Q=++Re&&Q&&Q[nt]||(rt=Re=0)||Ue.pop())&&!((U?Q.nodeName.toLowerCase()===on:Q.nodeType===1)&&++rt&&(ln&&(Se=Q[ye]||(Q[ye]={}),ce=Se[Q.uniqueID]||(Se[Q.uniqueID]={}),ce[_]=[Ke,rt]),Q===H)););return rt-=T,rt===R||rt%R===0&&rt/R>=0}}},PSEUDO:function(_,v){var x,R=f.pseudos[_]||f.setFilters[_.toLowerCase()]||ve.error("unsupported pseudo: "+_);return R[ye]?R(v):R.length>1?(x=[_,_,"",v],f.setFilters.hasOwnProperty(_.toLowerCase())?pt(function(T,N){for(var P,U=R(T,v),H=U.length;H--;)P=ai(T,U[H]),T[P]=!(N[P]=U[H])}):function(T){return R(T,0,x)}):R}},pseudos:{not:pt(function(_){var v=[],x=[],R=S(_.replace(Gn,"$1"));return R[ye]?pt(function(T,N,P,U){for(var H,K=R(T,null,U,[]),V=T.length;V--;)(H=K[V])&&(T[V]=!(N[V]=H))}):function(T,N,P){return v[0]=T,R(v,null,P,x),v[0]=null,!x.pop()}}),has:pt(function(_){return function(v){return ve(_,v).length>0}}),contains:pt(function(_){return _=_.replace(Dt,Rt),function(v){return(v.textContent||g(v)).indexOf(_)>-1}}),lang:pt(function(_){return Dd.test(_||"")||ve.error("unsupported lang: "+_),_=_.replace(Dt,Rt).toLowerCase(),function(v){var x;do if(x=ae?v.lang:v.getAttribute("xml:lang")||v.getAttribute("lang"))return x=x.toLowerCase(),x===_||x.indexOf(_+"-")===0;while((v=v.parentNode)&&v.nodeType===1);return!1}}),target:function(_){var v=s.location&&s.location.hash;return v&&v.slice(1)===_.id},root:function(_){return _===G},focus:function(_){return _===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(_.type||_.href||~_.tabIndex)},enabled:ho(!1),disabled:ho(!0),checked:function(_){var v=_.nodeName.toLowerCase();return v==="input"&&!!_.checked||v==="option"&&!!_.selected},selected:function(_){return _.parentNode&&_.parentNode.selectedIndex,_.selected===!0},empty:function(_){for(_=_.firstChild;_;_=_.nextSibling)if(_.nodeType<6)return!1;return!0},parent:function(_){return!f.pseudos.empty(_)},header:function(_){return Md.test(_.nodeName)},input:function(_){return Nd.test(_.nodeName)},button:function(_){var v=_.nodeName.toLowerCase();return v==="input"&&_.type==="button"||v==="button"},text:function(_){var v;return _.nodeName.toLowerCase()==="input"&&_.type==="text"&&((v=_.getAttribute("type"))==null||v.toLowerCase()==="text")},first:li(function(){return[0]}),last:li(function(_,v){return[v-1]}),eq:li(function(_,v,x){return[x<0?x+v:x]}),even:li(function(_,v){for(var x=0;x<v;x+=2)_.push(x);return _}),odd:li(function(_,v){for(var x=1;x<v;x+=2)_.push(x);return _}),lt:li(function(_,v,x){for(var R=x<0?x+v:x>v?v:x;--R>=0;)_.push(R);return _}),gt:li(function(_,v,x){for(var R=x<0?x+v:x;++R<v;)_.push(R);return _})}},f.pseudos.nth=f.pseudos.eq;for(o in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})f.pseudos[o]=qd(o);for(o in{submit:!0,reset:!0})f.pseudos[o]=Bd(o);function fo(){}fo.prototype=f.filters=f.pseudos,f.setFilters=new fo,w=ve.tokenize=function(_,v){var x,R,T,N,P,U,H,K=sn[_+" "];if(K)return v?0:K.slice(0);for(P=_,U=[],H=f.preFilter;P;){(!x||(R=Xd.exec(P)))&&(R&&(P=P.slice(R[0].length)||P),U.push(T=[])),x=!1,(R=ro.exec(P))&&(x=R.shift(),T.push({value:x,type:R[0].replace(Gn," ")}),P=P.slice(x.length));for(N in f.filter)(R=Wn[N].exec(P))&&(!H[N]||(R=H[N](R)))&&(x=R.shift(),T.push({value:x,type:N,matches:R}),P=P.slice(x.length));if(!x)break}return v?P.length:P?ve.error(_):sn(_,U).slice(0)};function Zn(_){for(var v=0,x=_.length,R="";v<x;v++)R+=_[v].value;return R}function Kn(_,v,x){var R=v.dir,T=v.next,N=T||R,P=x&&N==="parentNode",U=me++;return v.first?function(H,K,V){for(;H=H[R];)if(H.nodeType===1||P)return _(H,K,V);return!1}:function(H,K,V){var ee,ce,Se,Q=[Ke,U];if(V){for(;H=H[R];)if((H.nodeType===1||P)&&_(H,K,V))return!0}else for(;H=H[R];)if(H.nodeType===1||P)if(Se=H[ye]||(H[ye]={}),ce=Se[H.uniqueID]||(Se[H.uniqueID]={}),T&&T===H.nodeName.toLowerCase())H=H[R]||H;else{if((ee=ce[N])&&ee[0]===Ke&&ee[1]===U)return Q[2]=ee[2];if(ce[N]=Q,Q[2]=_(H,K,V))return!0}return!1}}function ss(_){return _.length>1?function(v,x,R){for(var T=_.length;T--;)if(!_[T](v,x,R))return!1;return!0}:_[0]}function zd(_,v,x){for(var R=0,T=v.length;R<T;R++)ve(_,v[R],x);return x}function Qn(_,v,x,R,T){for(var N,P=[],U=0,H=_.length,K=v!=null;U<H;U++)(N=_[U])&&(!x||x(N,R,T))&&(P.push(N),K&&v.push(U));return P}function as(_,v,x,R,T,N){return R&&!R[ye]&&(R=as(R)),T&&!T[ye]&&(T=as(T,N)),pt(function(P,U,H,K){var V,ee,ce,Se=[],Q=[],Re=U.length,Ue=P||zd(v||"*",H.nodeType?[H]:H,[]),nt=_&&(P||!v)?Qn(Ue,Se,_,H,K):Ue,Ee=x?T||(P?_:Re||R)?[]:U:nt;if(x&&x(nt,Ee,H,K),R)for(V=Qn(Ee,Q),R(V,[],H,K),ee=V.length;ee--;)(ce=V[ee])&&(Ee[Q[ee]]=!(nt[Q[ee]]=ce));if(P){if(T||_){if(T){for(V=[],ee=Ee.length;ee--;)(ce=Ee[ee])&&V.push(nt[ee]=ce);T(null,Ee=[],V,K)}for(ee=Ee.length;ee--;)(ce=Ee[ee])&&(V=T?ai(P,ce):Se[ee])>-1&&(P[V]=!(U[V]=ce))}}else Ee=Qn(Ee===U?Ee.splice(Re,Ee.length):Ee),T?T(null,U,Ee,K):Ht.apply(U,Ee)})}function os(_){for(var v,x,R,T=_.length,N=f.relative[_[0].type],P=N||f.relative[" "],U=N?1:0,H=Kn(function(ee){return ee===v},P,!0),K=Kn(function(ee){return ai(v,ee)>-1},P,!0),V=[function(ee,ce,Se){var Q=!N&&(Se||ce!==C)||((v=ce).nodeType?H(ee,ce,Se):K(ee,ce,Se));return v=null,Q}];U<T;U++)if(x=f.relative[_[U].type])V=[Kn(ss(V),x)];else{if(x=f.filter[_[U].type].apply(null,_[U].matches),x[ye]){for(R=++U;R<T&&!f.relative[_[R].type];R++);return as(U>1&&ss(V),U>1&&Zn(_.slice(0,U-1).concat({value:_[U-2].type===" "?"*":""})).replace(Gn,"$1"),x,U<R&&os(_.slice(U,R)),R<T&&os(_=_.slice(R)),R<T&&Zn(_))}V.push(x)}return ss(V)}function Fd(_,v){var x=v.length>0,R=_.length>0,T=function(N,P,U,H,K){var V,ee,ce,Se=0,Q="0",Re=N&&[],Ue=[],nt=C,Ee=N||R&&f.find.TAG("*",K),on=Ke+=nt==null?1:Math.random()||.1,ln=Ee.length;for(K&&(C=P==D||P||K);Q!==ln&&(V=Ee[Q])!=null;Q++){if(R&&V){for(ee=0,!P&&V.ownerDocument!=D&&(X(V),U=!ae);ce=_[ee++];)if(ce(V,P||D,U)){H.push(V);break}K&&(Ke=on)}x&&((V=!ce&&V)&&Se--,N&&Re.push(V))}if(Se+=Q,x&&Q!==Se){for(ee=0;ce=v[ee++];)ce(Re,Ue,P,U);if(N){if(Se>0)for(;Q--;)Re[Q]||Ue[Q]||(Ue[Q]=Ut.call(H));Ue=Qn(Ue)}Ht.apply(H,Ue),K&&!N&&Ue.length>0&&Se+v.length>1&&ve.uniqueSort(H)}return K&&(Ke=on,C=nt),Re};return x?pt(T):T}return S=ve.compile=function(_,v){var x,R=[],T=[],N=jn[_+" "];if(!N){for(v||(v=w(_)),x=v.length;x--;)N=os(v[x]),N[ye]?R.push(N):T.push(N);N=jn(_,Fd(T,R)),N.selector=_}return N},k=ve.select=function(_,v,x,R){var T,N,P,U,H,K=typeof _=="function"&&_,V=!R&&w(_=K.selector||_);if(x=x||[],V.length===1){if(N=V[0]=V[0].slice(0),N.length>2&&(P=N[0]).type==="ID"&&v.nodeType===9&&ae&&f.relative[N[1].type]){if(v=(f.find.ID(P.matches[0].replace(Dt,Rt),v)||[])[0],v)K&&(v=v.parentNode);else return x;_=_.slice(N.shift().value.length)}for(T=Wn.needsContext.test(_)?0:N.length;T--&&(P=N[T],!f.relative[U=P.type]);)if((H=f.find[U])&&(R=H(P.matches[0].replace(Dt,Rt),is.test(N[0].type)&&rs(v.parentNode)||v))){if(N.splice(T,1),_=R.length&&Zn(N),!_)return Ht.apply(x,R),x;break}}return(K||S(_,V))(R,v,!ae,x,!v||is.test(_)&&rs(v.parentNode)||v),x},h.sortStable=ye.split("").sort(ri).join("")===ye,h.detectDuplicates=!!M,X(),h.sortDetached=ft(function(_){return _.compareDocumentPosition(D.createElement("fieldset"))&1}),ft(function(_){return _.innerHTML="<a href='#'></a>",_.firstChild.getAttribute("href")==="#"})||ns("type|href|height|width",function(_,v,x){if(!x)return _.getAttribute(v,v.toLowerCase()==="type"?1:2)}),(!h.attributes||!ft(function(_){return _.innerHTML="<input/>",_.firstChild.setAttribute("value",""),_.firstChild.getAttribute("value")===""}))&&ns("value",function(_,v,x){if(!x&&_.nodeName.toLowerCase()==="input")return _.defaultValue}),ft(function(_){return _.getAttribute("disabled")==null})||ns(es,function(_,v,x){var R;if(!x)return _[v]===!0?v.toLowerCase():(R=_.getAttributeNode(v))&&R.specified?R.value:null}),ve}(t);c.find=ge,c.expr=ge.selectors,c.expr[":"]=c.expr.pseudos,c.uniqueSort=c.unique=ge.uniqueSort,c.text=ge.getText,c.isXMLDoc=ge.isXML,c.contains=ge.contains,c.escapeSelector=ge.escape;var oe=function(s,o,h){for(var f=[],g=h!==void 0;(s=s[o])&&s.nodeType!==9;)if(s.nodeType===1){if(g&&c(s).is(h))break;f.push(s)}return f},ne=function(s,o){for(var h=[];s;s=s.nextSibling)s.nodeType===1&&s!==o&&h.push(s);return h},fe=c.expr.match.needsContext;function Le(s,o){return s.nodeName&&s.nodeName.toLowerCase()===o.toLowerCase()}var Vi=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ft(s,o,h){return O(o)?c.grep(s,function(f,g){return!!o.call(f,g,f)!==h}):o.nodeType?c.grep(s,function(f){return f===o!==h}):typeof o!="string"?c.grep(s,function(f){return y.call(o,f)>-1!==h}):c.filter(o,s,h)}c.filter=function(s,o,h){var f=o[0];return h&&(s=":not("+s+")"),o.length===1&&f.nodeType===1?c.find.matchesSelector(f,s)?[f]:[]:c.find.matches(s,c.grep(o,function(g){return g.nodeType===1}))},c.fn.extend({find:function(s){var o,h,f=this.length,g=this;if(typeof s!="string")return this.pushStack(c(s).filter(function(){for(o=0;o<f;o++)if(c.contains(g[o],this))return!0}));for(h=this.pushStack([]),o=0;o<f;o++)c.find(s,g[o],h);return f>1?c.uniqueSort(h):h},filter:function(s){return this.pushStack(Ft(this,s||[],!1))},not:function(s){return this.pushStack(Ft(this,s||[],!0))},is:function(s){return!!Ft(this,typeof s=="string"&&fe.test(s)?c(s):s||[],!1).length}});var ei,Ah=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Dh=c.fn.init=function(s,o,h){var f,g;if(!s)return this;if(h=h||ei,typeof s=="string")if(s[0]==="<"&&s[s.length-1]===">"&&s.length>=3?f=[null,s,null]:f=Ah.exec(s),f&&(f[1]||!o))if(f[1]){if(o=o instanceof c?o[0]:o,c.merge(this,c.parseHTML(f[1],o&&o.nodeType?o.ownerDocument||o:F,!0)),Vi.test(f[1])&&c.isPlainObject(o))for(f in o)O(this[f])?this[f](o[f]):this.attr(f,o[f]);return this}else return g=F.getElementById(f[2]),g&&(this[0]=g,this.length=1),this;else return!o||o.jquery?(o||h).find(s):this.constructor(o).find(s);else{if(s.nodeType)return this[0]=s,this.length=1,this;if(O(s))return h.ready!==void 0?h.ready(s):s(c)}return c.makeArray(s,this)};Dh.prototype=c.fn,ei=c(F);var Rh=/^(?:parents|prev(?:Until|All))/,Nh={children:!0,contents:!0,next:!0,prev:!0};c.fn.extend({has:function(s){var o=c(s,this),h=o.length;return this.filter(function(){for(var f=0;f<h;f++)if(c.contains(this,o[f]))return!0})},closest:function(s,o){var h,f=0,g=this.length,p=[],w=typeof s!="string"&&c(s);if(!fe.test(s)){for(;f<g;f++)for(h=this[f];h&&h!==o;h=h.parentNode)if(h.nodeType<11&&(w?w.index(h)>-1:h.nodeType===1&&c.find.matchesSelector(h,s))){p.push(h);break}}return this.pushStack(p.length>1?c.uniqueSort(p):p)},index:function(s){return s?typeof s=="string"?y.call(c(s),this[0]):y.call(this,s.jquery?s[0]:s):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(s,o){return this.pushStack(c.uniqueSort(c.merge(this.get(),c(s,o))))},addBack:function(s){return this.add(s==null?this.prevObject:this.prevObject.filter(s))}});function va(s,o){for(;(s=s[o])&&s.nodeType!==1;);return s}c.each({parent:function(s){var o=s.parentNode;return o&&o.nodeType!==11?o:null},parents:function(s){return oe(s,"parentNode")},parentsUntil:function(s,o,h){return oe(s,"parentNode",h)},next:function(s){return va(s,"nextSibling")},prev:function(s){return va(s,"previousSibling")},nextAll:function(s){return oe(s,"nextSibling")},prevAll:function(s){return oe(s,"previousSibling")},nextUntil:function(s,o,h){return oe(s,"nextSibling",h)},prevUntil:function(s,o,h){return oe(s,"previousSibling",h)},siblings:function(s){return ne((s.parentNode||{}).firstChild,s)},children:function(s){return ne(s.firstChild)},contents:function(s){return s.contentDocument!=null&&r(s.contentDocument)?s.contentDocument:(Le(s,"template")&&(s=s.content||s),c.merge([],s.childNodes))}},function(s,o){c.fn[s]=function(h,f){var g=c.map(this,o,h);return s.slice(-5)!=="Until"&&(f=h),f&&typeof f=="string"&&(g=c.filter(f,g)),this.length>1&&(Nh[s]||c.uniqueSort(g),Rh.test(s)&&g.reverse()),this.pushStack(g)}});var vt=/[^\x20\t\r\n\f]+/g;function Mh(s){var o={};return c.each(s.match(vt)||[],function(h,f){o[f]=!0}),o}c.Callbacks=function(s){s=typeof s=="string"?Mh(s):c.extend({},s);var o,h,f,g,p=[],w=[],S=-1,k=function(){for(g=g||s.once,f=o=!0;w.length;S=-1)for(h=w.shift();++S<p.length;)p[S].apply(h[0],h[1])===!1&&s.stopOnFalse&&(S=p.length,h=!1);s.memory||(h=!1),o=!1,g&&(h?p=[]:p="")},C={add:function(){return p&&(h&&!o&&(S=p.length-1,w.push(h)),function L(M){c.each(M,function(X,D){O(D)?(!s.unique||!C.has(D))&&p.push(D):D&&D.length&&z(D)!=="string"&&L(D)})}(arguments),h&&!o&&k()),this},remove:function(){return c.each(arguments,function(L,M){for(var X;(X=c.inArray(M,p,X))>-1;)p.splice(X,1),X<=S&&S--}),this},has:function(L){return L?c.inArray(L,p)>-1:p.length>0},empty:function(){return p&&(p=[]),this},disable:function(){return g=w=[],p=h="",this},disabled:function(){return!p},lock:function(){return g=w=[],!h&&!o&&(p=h=""),this},locked:function(){return!!g},fireWith:function(L,M){return g||(M=M||[],M=[L,M.slice?M.slice():M],w.push(M),o||k()),this},fire:function(){return C.fireWith(this,arguments),this},fired:function(){return!!f}};return C};function Ci(s){return s}function qn(s){throw s}function Sa(s,o,h,f){var g;try{s&&O(g=s.promise)?g.call(s).done(o).fail(h):s&&O(g=s.then)?g.call(s,o,h):o.apply(void 0,[s].slice(f))}catch(p){h.apply(void 0,[p])}}c.extend({Deferred:function(s){var o=[["notify","progress",c.Callbacks("memory"),c.Callbacks("memory"),2],["resolve","done",c.Callbacks("once memory"),c.Callbacks("once memory"),0,"resolved"],["reject","fail",c.Callbacks("once memory"),c.Callbacks("once memory"),1,"rejected"]],h="pending",f={state:function(){return h},always:function(){return g.done(arguments).fail(arguments),this},catch:function(p){return f.then(null,p)},pipe:function(){var p=arguments;return c.Deferred(function(w){c.each(o,function(S,k){var C=O(p[k[4]])&&p[k[4]];g[k[1]](function(){var L=C&&C.apply(this,arguments);L&&O(L.promise)?L.promise().progress(w.notify).done(w.resolve).fail(w.reject):w[k[0]+"With"](this,C?[L]:arguments)})}),p=null}).promise()},then:function(p,w,S){var k=0;function C(L,M,X,D){return function(){var G=this,ae=arguments,$=function(){var Ae,tt;if(!(L<k)){if(Ae=X.apply(G,ae),Ae===M.promise())throw new TypeError("Thenable self-resolution");tt=Ae&&(typeof Ae=="object"||typeof Ae=="function")&&Ae.then,O(tt)?D?tt.call(Ae,C(k,M,Ci,D),C(k,M,qn,D)):(k++,tt.call(Ae,C(k,M,Ci,D),C(k,M,qn,D),C(k,M,Ci,M.notifyWith))):(X!==Ci&&(G=void 0,ae=[Ae]),(D||M.resolveWith)(G,ae))}},De=D?$:function(){try{$()}catch(Ae){c.Deferred.exceptionHook&&c.Deferred.exceptionHook(Ae,De.stackTrace),L+1>=k&&(X!==qn&&(G=void 0,ae=[Ae]),M.rejectWith(G,ae))}};L?De():(c.Deferred.getStackHook&&(De.stackTrace=c.Deferred.getStackHook()),t.setTimeout(De))}}return c.Deferred(function(L){o[0][3].add(C(0,L,O(S)?S:Ci,L.notifyWith)),o[1][3].add(C(0,L,O(p)?p:Ci)),o[2][3].add(C(0,L,O(w)?w:qn))}).promise()},promise:function(p){return p!=null?c.extend(p,f):f}},g={};return c.each(o,function(p,w){var S=w[2],k=w[5];f[w[1]]=S.add,k&&S.add(function(){h=k},o[3-p][2].disable,o[3-p][3].disable,o[0][2].lock,o[0][3].lock),S.add(w[3].fire),g[w[0]]=function(){return g[w[0]+"With"](this===g?void 0:this,arguments),this},g[w[0]+"With"]=S.fireWith}),f.promise(g),s&&s.call(g,g),g},when:function(s){var o=arguments.length,h=o,f=Array(h),g=a.call(arguments),p=c.Deferred(),w=function(S){return function(k){f[S]=this,g[S]=arguments.length>1?a.call(arguments):k,--o||p.resolveWith(f,g)}};if(o<=1&&(Sa(s,p.done(w(h)).resolve,p.reject,!o),p.state()==="pending"||O(g[h]&&g[h].then)))return p.then();for(;h--;)Sa(g[h],w(h),p.reject);return p.promise()}});var Ph=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;c.Deferred.exceptionHook=function(s,o){t.console&&t.console.warn&&s&&Ph.test(s.name)&&t.console.warn("jQuery.Deferred exception: "+s.message,s.stack,o)},c.readyException=function(s){t.setTimeout(function(){throw s})};var qr=c.Deferred();c.fn.ready=function(s){return qr.then(s).catch(function(o){c.readyException(o)}),this},c.extend({isReady:!1,readyWait:1,ready:function(s){(s===!0?--c.readyWait:c.isReady)||(c.isReady=!0,!(s!==!0&&--c.readyWait>0)&&qr.resolveWith(F,[c]))}}),c.ready.then=qr.then;function Bn(){F.removeEventListener("DOMContentLoaded",Bn),t.removeEventListener("load",Bn),c.ready()}F.readyState==="complete"||F.readyState!=="loading"&&!F.documentElement.doScroll?t.setTimeout(c.ready):(F.addEventListener("DOMContentLoaded",Bn),t.addEventListener("load",Bn));var Lt=function(s,o,h,f,g,p,w){var S=0,k=s.length,C=h==null;if(z(h)==="object"){g=!0;for(S in h)Lt(s,o,S,h[S],!0,p,w)}else if(f!==void 0&&(g=!0,O(f)||(w=!0),C&&(w?(o.call(s,f),o=null):(C=o,o=function(L,M,X){return C.call(c(L),X)})),o))for(;S<k;S++)o(s[S],h,w?f:f.call(s[S],S,o(s[S],h)));return g?s:C?o.call(s):k?o(s[0],h):p},Oh=/^-ms-/,qh=/-([a-z])/g;function Bh(s,o){return o.toUpperCase()}function St(s){return s.replace(Oh,"ms-").replace(qh,Bh)}var Zi=function(s){return s.nodeType===1||s.nodeType===9||!+s.nodeType};function Ki(){this.expando=c.expando+Ki.uid++}Ki.uid=1,Ki.prototype={cache:function(s){var o=s[this.expando];return o||(o={},Zi(s)&&(s.nodeType?s[this.expando]=o:Object.defineProperty(s,this.expando,{value:o,configurable:!0}))),o},set:function(s,o,h){var f,g=this.cache(s);if(typeof o=="string")g[St(o)]=h;else for(f in o)g[St(f)]=o[f];return g},get:function(s,o){return o===void 0?this.cache(s):s[this.expando]&&s[this.expando][St(o)]},access:function(s,o,h){return o===void 0||o&&typeof o=="string"&&h===void 0?this.get(s,o):(this.set(s,o,h),h!==void 0?h:o)},remove:function(s,o){var h,f=s[this.expando];if(f!==void 0){if(o!==void 0)for(Array.isArray(o)?o=o.map(St):(o=St(o),o=o in f?[o]:o.match(vt)||[]),h=o.length;h--;)delete f[o[h]];(o===void 0||c.isEmptyObject(f))&&(s.nodeType?s[this.expando]=void 0:delete s[this.expando])}},hasData:function(s){var o=s[this.expando];return o!==void 0&&!c.isEmptyObject(o)}};var Z=new Ki,We=new Ki,zh=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Fh=/[A-Z]/g;function Uh(s){return s==="true"?!0:s==="false"?!1:s==="null"?null:s===+s+""?+s:zh.test(s)?JSON.parse(s):s}function xa(s,o,h){var f;if(h===void 0&&s.nodeType===1)if(f="data-"+o.replace(Fh,"-$&").toLowerCase(),h=s.getAttribute(f),typeof h=="string"){try{h=Uh(h)}catch(g){}We.set(s,o,h)}else h=void 0;return h}c.extend({hasData:function(s){return We.hasData(s)||Z.hasData(s)},data:function(s,o,h){return We.access(s,o,h)},removeData:function(s,o){We.remove(s,o)},_data:function(s,o,h){return Z.access(s,o,h)},_removeData:function(s,o){Z.remove(s,o)}}),c.fn.extend({data:function(s,o){var h,f,g,p=this[0],w=p&&p.attributes;if(s===void 0){if(this.length&&(g=We.get(p),p.nodeType===1&&!Z.get(p,"hasDataAttrs"))){for(h=w.length;h--;)w[h]&&(f=w[h].name,f.indexOf("data-")===0&&(f=St(f.slice(5)),xa(p,f,g[f])));Z.set(p,"hasDataAttrs",!0)}return g}return typeof s=="object"?this.each(function(){We.set(this,s)}):Lt(this,function(S){var k;if(p&&S===void 0)return k=We.get(p,s),k!==void 0||(k=xa(p,s),k!==void 0)?k:void 0;this.each(function(){We.set(this,s,S)})},null,o,arguments.length>1,null,!0)},removeData:function(s){return this.each(function(){We.remove(this,s)})}}),c.extend({queue:function(s,o,h){var f;if(s)return o=(o||"fx")+"queue",f=Z.get(s,o),h&&(!f||Array.isArray(h)?f=Z.access(s,o,c.makeArray(h)):f.push(h)),f||[]},dequeue:function(s,o){o=o||"fx";var h=c.queue(s,o),f=h.length,g=h.shift(),p=c._queueHooks(s,o),w=function(){c.dequeue(s,o)};g==="inprogress"&&(g=h.shift(),f--),g&&(o==="fx"&&h.unshift("inprogress"),delete p.stop,g.call(s,w,p)),!f&&p&&p.empty.fire()},_queueHooks:function(s,o){var h=o+"queueHooks";return Z.get(s,h)||Z.access(s,h,{empty:c.Callbacks("once memory").add(function(){Z.remove(s,[o+"queue",h])})})}}),c.fn.extend({queue:function(s,o){var h=2;return typeof s!="string"&&(o=s,s="fx",h--),arguments.length<h?c.queue(this[0],s):o===void 0?this:this.each(function(){var f=c.queue(this,s,o);c._queueHooks(this,s),s==="fx"&&f[0]!=="inprogress"&&c.dequeue(this,s)})},dequeue:function(s){return this.each(function(){c.dequeue(this,s)})},clearQueue:function(s){return this.queue(s||"fx",[])},promise:function(s,o){var h,f=1,g=c.Deferred(),p=this,w=this.length,S=function(){--f||g.resolveWith(p,[p])};for(typeof s!="string"&&(o=s,s=void 0),s=s||"fx";w--;)h=Z.get(p[w],s+"queueHooks"),h&&h.empty&&(f++,h.empty.add(S));return S(),g.promise(o)}});var Ea=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Qi=new RegExp("^(?:([+-])=|)("+Ea+")([a-z%]*)$","i"),At=["Top","Right","Bottom","Left"],ti=F.documentElement,Ii=function(s){return c.contains(s.ownerDocument,s)},Hh={composed:!0};ti.getRootNode&&(Ii=function(s){return c.contains(s.ownerDocument,s)||s.getRootNode(Hh)===s.ownerDocument});var zn=function(s,o){return s=o||s,s.style.display==="none"||s.style.display===""&&Ii(s)&&c.css(s,"display")==="none"};function Ta(s,o,h,f){var g,p,w=20,S=f?function(){return f.cur()}:function(){return c.css(s,o,"")},k=S(),C=h&&h[3]||(c.cssNumber[o]?"":"px"),L=s.nodeType&&(c.cssNumber[o]||C!=="px"&&+k)&&Qi.exec(c.css(s,o));if(L&&L[3]!==C){for(k=k/2,C=C||L[3],L=+k||1;w--;)c.style(s,o,L+C),(1-p)*(1-(p=S()/k||.5))<=0&&(w=0),L=L/p;L=L*2,c.style(s,o,L+C),h=h||[]}return h&&(L=+L||+k||0,g=h[1]?L+(h[1]+1)*h[2]:+h[2],f&&(f.unit=C,f.start=L,f.end=g)),g}var Ca={};function $h(s){var o,h=s.ownerDocument,f=s.nodeName,g=Ca[f];return g||(o=h.body.appendChild(h.createElement(f)),g=c.css(o,"display"),o.parentNode.removeChild(o),g==="none"&&(g="block"),Ca[f]=g,g)}function Yi(s,o){for(var h,f,g=[],p=0,w=s.length;p<w;p++)f=s[p],f.style&&(h=f.style.display,o?(h==="none"&&(g[p]=Z.get(f,"display")||null,g[p]||(f.style.display="")),f.style.display===""&&zn(f)&&(g[p]=$h(f))):h!=="none"&&(g[p]="none",Z.set(f,"display",h)));for(p=0;p<w;p++)g[p]!=null&&(s[p].style.display=g[p]);return s}c.fn.extend({show:function(){return Yi(this,!0)},hide:function(){return Yi(this)},toggle:function(s){return typeof s=="boolean"?s?this.show():this.hide():this.each(function(){zn(this)?c(this).show():c(this).hide()})}});var Ji=/^(?:checkbox|radio)$/i,Ia=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ya=/^$|^module$|\/(?:java|ecma)script/i;(function(){var s=F.createDocumentFragment(),o=s.appendChild(F.createElement("div")),h=F.createElement("input");h.setAttribute("type","radio"),h.setAttribute("checked","checked"),h.setAttribute("name","t"),o.appendChild(h),A.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,o.innerHTML="<textarea>x</textarea>",A.noCloneChecked=!!o.cloneNode(!0).lastChild.defaultValue,o.innerHTML="<option></option>",A.option=!!o.lastChild})();var ht={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ht.tbody=ht.tfoot=ht.colgroup=ht.caption=ht.thead,ht.th=ht.td,A.option||(ht.optgroup=ht.option=[1,"<select multiple='multiple'>","</select>"]);function Ve(s,o){var h;return typeof s.getElementsByTagName<"u"?h=s.getElementsByTagName(o||"*"):typeof s.querySelectorAll<"u"?h=s.querySelectorAll(o||"*"):h=[],o===void 0||o&&Le(s,o)?c.merge([s],h):h}function Br(s,o){for(var h=0,f=s.length;h<f;h++)Z.set(s[h],"globalEval",!o||Z.get(o[h],"globalEval"))}var jh=/<|&#?\w+;/;function Xa(s,o,h,f,g){for(var p,w,S,k,C,L,M=o.createDocumentFragment(),X=[],D=0,G=s.length;D<G;D++)if(p=s[D],p||p===0)if(z(p)==="object")c.merge(X,p.nodeType?[p]:p);else if(!jh.test(p))X.push(o.createTextNode(p));else{for(w=w||M.appendChild(o.createElement("div")),S=(Ia.exec(p)||["",""])[1].toLowerCase(),k=ht[S]||ht._default,w.innerHTML=k[1]+c.htmlPrefilter(p)+k[2],L=k[0];L--;)w=w.lastChild;c.merge(X,w.childNodes),w=M.firstChild,w.textContent=""}for(M.textContent="",D=0;p=X[D++];){if(f&&c.inArray(p,f)>-1){g&&g.push(p);continue}if(C=Ii(p),w=Ve(M.appendChild(p),"script"),C&&Br(w),h)for(L=0;p=w[L++];)Ya.test(p.type||"")&&h.push(p)}return M}var La=/^([^.]*)(?:\.(.+)|)/;function Xi(){return!0}function Li(){return!1}function Gh(s,o){return s===Wh()==(o==="focus")}function Wh(){try{return F.activeElement}catch(s){}}function zr(s,o,h,f,g,p){var w,S;if(typeof o=="object"){typeof h!="string"&&(f=f||h,h=void 0);for(S in o)zr(s,S,h,f,o[S],p);return s}if(f==null&&g==null?(g=h,f=h=void 0):g==null&&(typeof h=="string"?(g=f,f=void 0):(g=f,f=h,h=void 0)),g===!1)g=Li;else if(!g)return s;return p===1&&(w=g,g=function(k){return c().off(k),w.apply(this,arguments)},g.guid=w.guid||(w.guid=c.guid++)),s.each(function(){c.event.add(this,o,g,f,h)})}c.event={global:{},add:function(s,o,h,f,g){var p,w,S,k,C,L,M,X,D,G,ae,$=Z.get(s);if(Zi(s))for(h.handler&&(p=h,h=p.handler,g=p.selector),g&&c.find.matchesSelector(ti,g),h.guid||(h.guid=c.guid++),(k=$.events)||(k=$.events=Object.create(null)),(w=$.handle)||(w=$.handle=function(De){return typeof c<"u"&&c.event.triggered!==De.type?c.event.dispatch.apply(s,arguments):void 0}),o=(o||"").match(vt)||[""],C=o.length;C--;)S=La.exec(o[C])||[],D=ae=S[1],G=(S[2]||"").split(".").sort(),D&&(M=c.event.special[D]||{},D=(g?M.delegateType:M.bindType)||D,M=c.event.special[D]||{},L=c.extend({type:D,origType:ae,data:f,handler:h,guid:h.guid,selector:g,needsContext:g&&c.expr.match.needsContext.test(g),namespace:G.join(".")},p),(X=k[D])||(X=k[D]=[],X.delegateCount=0,(!M.setup||M.setup.call(s,f,G,w)===!1)&&s.addEventListener&&s.addEventListener(D,w)),M.add&&(M.add.call(s,L),L.handler.guid||(L.handler.guid=h.guid)),g?X.splice(X.delegateCount++,0,L):X.push(L),c.event.global[D]=!0)},remove:function(s,o,h,f,g){var p,w,S,k,C,L,M,X,D,G,ae,$=Z.hasData(s)&&Z.get(s);if(!(!$||!(k=$.events))){for(o=(o||"").match(vt)||[""],C=o.length;C--;){if(S=La.exec(o[C])||[],D=ae=S[1],G=(S[2]||"").split(".").sort(),!D){for(D in k)c.event.remove(s,D+o[C],h,f,!0);continue}for(M=c.event.special[D]||{},D=(f?M.delegateType:M.bindType)||D,X=k[D]||[],S=S[2]&&new RegExp("(^|\\.)"+G.join("\\.(?:.*\\.|)")+"(\\.|$)"),w=p=X.length;p--;)L=X[p],(g||ae===L.origType)&&(!h||h.guid===L.guid)&&(!S||S.test(L.namespace))&&(!f||f===L.selector||f==="**"&&L.selector)&&(X.splice(p,1),L.selector&&X.delegateCount--,M.remove&&M.remove.call(s,L));w&&!X.length&&((!M.teardown||M.teardown.call(s,G,$.handle)===!1)&&c.removeEvent(s,D,$.handle),delete k[D])}c.isEmptyObject(k)&&Z.remove(s,"handle events")}},dispatch:function(s){var o,h,f,g,p,w,S=new Array(arguments.length),k=c.event.fix(s),C=(Z.get(this,"events")||Object.create(null))[k.type]||[],L=c.event.special[k.type]||{};for(S[0]=k,o=1;o<arguments.length;o++)S[o]=arguments[o];if(k.delegateTarget=this,!(L.preDispatch&&L.preDispatch.call(this,k)===!1)){for(w=c.event.handlers.call(this,k,C),o=0;(g=w[o++])&&!k.isPropagationStopped();)for(k.currentTarget=g.elem,h=0;(p=g.handlers[h++])&&!k.isImmediatePropagationStopped();)(!k.rnamespace||p.namespace===!1||k.rnamespace.test(p.namespace))&&(k.handleObj=p,k.data=p.data,f=((c.event.special[p.origType]||{}).handle||p.handler).apply(g.elem,S),f!==void 0&&(k.result=f)===!1&&(k.preventDefault(),k.stopPropagation()));return L.postDispatch&&L.postDispatch.call(this,k),k.result}},handlers:function(s,o){var h,f,g,p,w,S=[],k=o.delegateCount,C=s.target;if(k&&C.nodeType&&!(s.type==="click"&&s.button>=1)){for(;C!==this;C=C.parentNode||this)if(C.nodeType===1&&!(s.type==="click"&&C.disabled===!0)){for(p=[],w={},h=0;h<k;h++)f=o[h],g=f.selector+" ",w[g]===void 0&&(w[g]=f.needsContext?c(g,this).index(C)>-1:c.find(g,this,null,[C]).length),w[g]&&p.push(f);p.length&&S.push({elem:C,handlers:p})}}return C=this,k<o.length&&S.push({elem:C,handlers:o.slice(k)}),S},addProp:function(s,o){Object.defineProperty(c.Event.prototype,s,{enumerable:!0,configurable:!0,get:O(o)?function(){if(this.originalEvent)return o(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[s]},set:function(h){Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:h})}})},fix:function(s){return s[c.expando]?s:new c.Event(s)},special:{load:{noBubble:!0},click:{setup:function(s){var o=this||s;return Ji.test(o.type)&&o.click&&Le(o,"input")&&Fn(o,"click",Xi),!1},trigger:function(s){var o=this||s;return Ji.test(o.type)&&o.click&&Le(o,"input")&&Fn(o,"click"),!0},_default:function(s){var o=s.target;return Ji.test(o.type)&&o.click&&Le(o,"input")&&Z.get(o,"click")||Le(o,"a")}},beforeunload:{postDispatch:function(s){s.result!==void 0&&s.originalEvent&&(s.originalEvent.returnValue=s.result)}}}};function Fn(s,o,h){if(!h){Z.get(s,o)===void 0&&c.event.add(s,o,Xi);return}Z.set(s,o,!1),c.event.add(s,o,{namespace:!1,handler:function(f){var g,p,w=Z.get(this,o);if(f.isTrigger&1&&this[o]){if(w.length)(c.event.special[o]||{}).delegateType&&f.stopPropagation();else if(w=a.call(arguments),Z.set(this,o,w),g=h(this,o),this[o](),p=Z.get(this,o),w!==p||g?Z.set(this,o,!1):p={},w!==p)return f.stopImmediatePropagation(),f.preventDefault(),p&&p.value}else w.length&&(Z.set(this,o,{value:c.event.trigger(c.extend(w[0],c.Event.prototype),w.slice(1),this)}),f.stopImmediatePropagation())}})}c.removeEvent=function(s,o,h){s.removeEventListener&&s.removeEventListener(o,h)},c.Event=function(s,o){if(!(this instanceof c.Event))return new c.Event(s,o);s&&s.type?(this.originalEvent=s,this.type=s.type,this.isDefaultPrevented=s.defaultPrevented||s.defaultPrevented===void 0&&s.returnValue===!1?Xi:Li,this.target=s.target&&s.target.nodeType===3?s.target.parentNode:s.target,this.currentTarget=s.currentTarget,this.relatedTarget=s.relatedTarget):this.type=s,o&&c.extend(this,o),this.timeStamp=s&&s.timeStamp||Date.now(),this[c.expando]=!0},c.Event.prototype={constructor:c.Event,isDefaultPrevented:Li,isPropagationStopped:Li,isImmediatePropagationStopped:Li,isSimulated:!1,preventDefault:function(){var s=this.originalEvent;this.isDefaultPrevented=Xi,s&&!this.isSimulated&&s.preventDefault()},stopPropagation:function(){var s=this.originalEvent;this.isPropagationStopped=Xi,s&&!this.isSimulated&&s.stopPropagation()},stopImmediatePropagation:function(){var s=this.originalEvent;this.isImmediatePropagationStopped=Xi,s&&!this.isSimulated&&s.stopImmediatePropagation(),this.stopPropagation()}},c.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},c.event.addProp),c.each({focus:"focusin",blur:"focusout"},function(s,o){c.event.special[s]={setup:function(){return Fn(this,s,Gh),!1},trigger:function(){return Fn(this,s),!0},_default:function(h){return Z.get(h.target,s)},delegateType:o}}),c.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(s,o){c.event.special[s]={delegateType:o,bindType:o,handle:function(h){var f,g=this,p=h.relatedTarget,w=h.handleObj;return(!p||p!==g&&!c.contains(g,p))&&(h.type=w.origType,f=w.handler.apply(this,arguments),h.type=o),f}}}),c.fn.extend({on:function(s,o,h,f){return zr(this,s,o,h,f)},one:function(s,o,h,f){return zr(this,s,o,h,f,1)},off:function(s,o,h){var f,g;if(s&&s.preventDefault&&s.handleObj)return f=s.handleObj,c(s.delegateTarget).off(f.namespace?f.origType+"."+f.namespace:f.origType,f.selector,f.handler),this;if(typeof s=="object"){for(g in s)this.off(g,o,s[g]);return this}return(o===!1||typeof o=="function")&&(h=o,o=void 0),h===!1&&(h=Li),this.each(function(){c.event.remove(this,s,h,o)})}});var Vh=/<script|<style|<link/i,Zh=/checked\s*(?:[^=]|=\s*.checked.)/i,Kh=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Aa(s,o){return Le(s,"table")&&Le(o.nodeType!==11?o:o.firstChild,"tr")&&c(s).children("tbody")[0]||s}function Qh(s){return s.type=(s.getAttribute("type")!==null)+"/"+s.type,s}function Jh(s){return(s.type||"").slice(0,5)==="true/"?s.type=s.type.slice(5):s.removeAttribute("type"),s}function Da(s,o){var h,f,g,p,w,S,k;if(o.nodeType===1){if(Z.hasData(s)&&(p=Z.get(s),k=p.events,k)){Z.remove(o,"handle events");for(g in k)for(h=0,f=k[g].length;h<f;h++)c.event.add(o,g,k[g][h])}We.hasData(s)&&(w=We.access(s),S=c.extend({},w),We.set(o,S))}}function ed(s,o){var h=o.nodeName.toLowerCase();h==="input"&&Ji.test(s.type)?o.checked=s.checked:(h==="input"||h==="textarea")&&(o.defaultValue=s.defaultValue)}function Ai(s,o,h,f){o=d(o);var g,p,w,S,k,C,L=0,M=s.length,X=M-1,D=o[0],G=O(D);if(G||M>1&&typeof D=="string"&&!A.checkClone&&Zh.test(D))return s.each(function(ae){var $=s.eq(ae);G&&(o[0]=D.call(this,ae,$.html())),Ai($,o,h,f)});if(M&&(g=Xa(o,s[0].ownerDocument,!1,s,f),p=g.firstChild,g.childNodes.length===1&&(g=p),p||f)){for(w=c.map(Ve(g,"script"),Qh),S=w.length;L<M;L++)k=g,L!==X&&(k=c.clone(k,!0,!0),S&&c.merge(w,Ve(k,"script"))),h.call(s[L],k,L);if(S)for(C=w[w.length-1].ownerDocument,c.map(w,Jh),L=0;L<S;L++)k=w[L],Ya.test(k.type||"")&&!Z.access(k,"globalEval")&&c.contains(C,k)&&(k.src&&(k.type||"").toLowerCase()!=="module"?c._evalUrl&&!k.noModule&&c._evalUrl(k.src,{nonce:k.nonce||k.getAttribute("nonce")},C):j(k.textContent.replace(Kh,""),k,C))}return s}function Ra(s,o,h){for(var f,g=o?c.filter(o,s):s,p=0;(f=g[p])!=null;p++)!h&&f.nodeType===1&&c.cleanData(Ve(f)),f.parentNode&&(h&&Ii(f)&&Br(Ve(f,"script")),f.parentNode.removeChild(f));return s}c.extend({htmlPrefilter:function(s){return s},clone:function(s,o,h){var f,g,p,w,S=s.cloneNode(!0),k=Ii(s);if(!A.noCloneChecked&&(s.nodeType===1||s.nodeType===11)&&!c.isXMLDoc(s))for(w=Ve(S),p=Ve(s),f=0,g=p.length;f<g;f++)ed(p[f],w[f]);if(o)if(h)for(p=p||Ve(s),w=w||Ve(S),f=0,g=p.length;f<g;f++)Da(p[f],w[f]);else Da(s,S);return w=Ve(S,"script"),w.length>0&&Br(w,!k&&Ve(s,"script")),S},cleanData:function(s){for(var o,h,f,g=c.event.special,p=0;(h=s[p])!==void 0;p++)if(Zi(h)){if(o=h[Z.expando]){if(o.events)for(f in o.events)g[f]?c.event.remove(h,f):c.removeEvent(h,f,o.handle);h[Z.expando]=void 0}h[We.expando]&&(h[We.expando]=void 0)}}}),c.fn.extend({detach:function(s){return Ra(this,s,!0)},remove:function(s){return Ra(this,s)},text:function(s){return Lt(this,function(o){return o===void 0?c.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=o)})},null,s,arguments.length)},append:function(){return Ai(this,arguments,function(s){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var o=Aa(this,s);o.appendChild(s)}})},prepend:function(){return Ai(this,arguments,function(s){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var o=Aa(this,s);o.insertBefore(s,o.firstChild)}})},before:function(){return Ai(this,arguments,function(s){this.parentNode&&this.parentNode.insertBefore(s,this)})},after:function(){return Ai(this,arguments,function(s){this.parentNode&&this.parentNode.insertBefore(s,this.nextSibling)})},empty:function(){for(var s,o=0;(s=this[o])!=null;o++)s.nodeType===1&&(c.cleanData(Ve(s,!1)),s.textContent="");return this},clone:function(s,o){return s=s==null?!1:s,o=o==null?s:o,this.map(function(){return c.clone(this,s,o)})},html:function(s){return Lt(this,function(o){var h=this[0]||{},f=0,g=this.length;if(o===void 0&&h.nodeType===1)return h.innerHTML;if(typeof o=="string"&&!Vh.test(o)&&!ht[(Ia.exec(o)||["",""])[1].toLowerCase()]){o=c.htmlPrefilter(o);try{for(;f<g;f++)h=this[f]||{},h.nodeType===1&&(c.cleanData(Ve(h,!1)),h.innerHTML=o);h=0}catch(p){}}h&&this.empty().append(o)},null,s,arguments.length)},replaceWith:function(){var s=[];return Ai(this,arguments,function(o){var h=this.parentNode;c.inArray(this,s)<0&&(c.cleanData(Ve(this)),h&&h.replaceChild(o,this))},s)}}),c.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(s,o){c.fn[s]=function(h){for(var f,g=[],p=c(h),w=p.length-1,S=0;S<=w;S++)f=S===w?this:this.clone(!0),c(p[S])[o](f),u.apply(g,f.get());return this.pushStack(g)}});var Fr=new RegExp("^("+Ea+")(?!px)[a-z%]+$","i"),Ur=/^--/,Un=function(s){var o=s.ownerDocument.defaultView;return(!o||!o.opener)&&(o=t),o.getComputedStyle(s)},Na=function(s,o,h){var f,g,p={};for(g in o)p[g]=s.style[g],s.style[g]=o[g];f=h.call(s);for(g in o)s.style[g]=p[g];return f},td=new RegExp(At.join("|"),"i"),Ma="[\\x20\\t\\r\\n\\f]",id=new RegExp("^"+Ma+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Ma+"+$","g");(function(){function s(){if(C){k.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",C.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ti.appendChild(k).appendChild(C);var L=t.getComputedStyle(C);h=L.top!=="1%",S=o(L.marginLeft)===12,C.style.right="60%",p=o(L.right)===36,f=o(L.width)===36,C.style.position="absolute",g=o(C.offsetWidth/3)===12,ti.removeChild(k),C=null}}function o(L){return Math.round(parseFloat(L))}var h,f,g,p,w,S,k=F.createElement("div"),C=F.createElement("div");C.style&&(C.style.backgroundClip="content-box",C.cloneNode(!0).style.backgroundClip="",A.clearCloneStyle=C.style.backgroundClip==="content-box",c.extend(A,{boxSizingReliable:function(){return s(),f},pixelBoxStyles:function(){return s(),p},pixelPosition:function(){return s(),h},reliableMarginLeft:function(){return s(),S},scrollboxSize:function(){return s(),g},reliableTrDimensions:function(){var L,M,X,D;return w==null&&(L=F.createElement("table"),M=F.createElement("tr"),X=F.createElement("div"),L.style.cssText="position:absolute;left:-11111px;border-collapse:separate",M.style.cssText="border:1px solid",M.style.height="1px",X.style.height="9px",X.style.display="block",ti.appendChild(L).appendChild(M).appendChild(X),D=t.getComputedStyle(M),w=parseInt(D.height,10)+parseInt(D.borderTopWidth,10)+parseInt(D.borderBottomWidth,10)===M.offsetHeight,ti.removeChild(L)),w}}))})();function en(s,o,h){var f,g,p,w,S=Ur.test(o),k=s.style;return h=h||Un(s),h&&(w=h.getPropertyValue(o)||h[o],S&&w&&(w=w.replace(id,"$1")||void 0),w===""&&!Ii(s)&&(w=c.style(s,o)),!A.pixelBoxStyles()&&Fr.test(w)&&td.test(o)&&(f=k.width,g=k.minWidth,p=k.maxWidth,k.minWidth=k.maxWidth=k.width=w,w=h.width,k.width=f,k.minWidth=g,k.maxWidth=p)),w!==void 0?w+"":w}function Pa(s,o){return{get:function(){if(s()){delete this.get;return}return(this.get=o).apply(this,arguments)}}}var Oa=["Webkit","Moz","ms"],qa=F.createElement("div").style,Ba={};function nd(s){for(var o=s[0].toUpperCase()+s.slice(1),h=Oa.length;h--;)if(s=Oa[h]+o,s in qa)return s}function Hr(s){var o=c.cssProps[s]||Ba[s];return o||(s in qa?s:Ba[s]=nd(s)||s)}var rd=/^(none|table(?!-c[ea]).+)/,sd={position:"absolute",visibility:"hidden",display:"block"},za={letterSpacing:"0",fontWeight:"400"};function Fa(s,o,h){var f=Qi.exec(o);return f?Math.max(0,f[2]-(h||0))+(f[3]||"px"):o}function $r(s,o,h,f,g,p){var w=o==="width"?1:0,S=0,k=0;if(h===(f?"border":"content"))return 0;for(;w<4;w+=2)h==="margin"&&(k+=c.css(s,h+At[w],!0,g)),f?(h==="content"&&(k-=c.css(s,"padding"+At[w],!0,g)),h!=="margin"&&(k-=c.css(s,"border"+At[w]+"Width",!0,g))):(k+=c.css(s,"padding"+At[w],!0,g),h!=="padding"?k+=c.css(s,"border"+At[w]+"Width",!0,g):S+=c.css(s,"border"+At[w]+"Width",!0,g));return!f&&p>=0&&(k+=Math.max(0,Math.ceil(s["offset"+o[0].toUpperCase()+o.slice(1)]-p-k-S-.5))||0),k}function Ua(s,o,h){var f=Un(s),g=!A.boxSizingReliable()||h,p=g&&c.css(s,"boxSizing",!1,f)==="border-box",w=p,S=en(s,o,f),k="offset"+o[0].toUpperCase()+o.slice(1);if(Fr.test(S)){if(!h)return S;S="auto"}return(!A.boxSizingReliable()&&p||!A.reliableTrDimensions()&&Le(s,"tr")||S==="auto"||!parseFloat(S)&&c.css(s,"display",!1,f)==="inline")&&s.getClientRects().length&&(p=c.css(s,"boxSizing",!1,f)==="border-box",w=k in s,w&&(S=s[k])),S=parseFloat(S)||0,S+$r(s,o,h||(p?"border":"content"),w,f,S)+"px"}c.extend({cssHooks:{opacity:{get:function(s,o){if(o){var h=en(s,"opacity");return h===""?"1":h}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(s,o,h,f){if(!(!s||s.nodeType===3||s.nodeType===8||!s.style)){var g,p,w,S=St(o),k=Ur.test(o),C=s.style;if(k||(o=Hr(S)),w=c.cssHooks[o]||c.cssHooks[S],h!==void 0){if(p=typeof h,p==="string"&&(g=Qi.exec(h))&&g[1]&&(h=Ta(s,o,g),p="number"),h==null||h!==h)return;p==="number"&&!k&&(h+=g&&g[3]||(c.cssNumber[S]?"":"px")),!A.clearCloneStyle&&h===""&&o.indexOf("background")===0&&(C[o]="inherit"),(!w||!("set"in w)||(h=w.set(s,h,f))!==void 0)&&(k?C.setProperty(o,h):C[o]=h)}else return w&&"get"in w&&(g=w.get(s,!1,f))!==void 0?g:C[o]}},css:function(s,o,h,f){var g,p,w,S=St(o),k=Ur.test(o);return k||(o=Hr(S)),w=c.cssHooks[o]||c.cssHooks[S],w&&"get"in w&&(g=w.get(s,!0,h)),g===void 0&&(g=en(s,o,f)),g==="normal"&&o in za&&(g=za[o]),h===""||h?(p=parseFloat(g),h===!0||isFinite(p)?p||0:g):g}}),c.each(["height","width"],function(s,o){c.cssHooks[o]={get:function(h,f,g){if(f)return rd.test(c.css(h,"display"))&&(!h.getClientRects().length||!h.getBoundingClientRect().width)?Na(h,sd,function(){return Ua(h,o,g)}):Ua(h,o,g)},set:function(h,f,g){var p,w=Un(h),S=!A.scrollboxSize()&&w.position==="absolute",k=S||g,C=k&&c.css(h,"boxSizing",!1,w)==="border-box",L=g?$r(h,o,g,C,w):0;return C&&S&&(L-=Math.ceil(h["offset"+o[0].toUpperCase()+o.slice(1)]-parseFloat(w[o])-$r(h,o,"border",!1,w)-.5)),L&&(p=Qi.exec(f))&&(p[3]||"px")!=="px"&&(h.style[o]=f,f=c.css(h,o)),Fa(h,f,L)}}}),c.cssHooks.marginLeft=Pa(A.reliableMarginLeft,function(s,o){if(o)return(parseFloat(en(s,"marginLeft"))||s.getBoundingClientRect().left-Na(s,{marginLeft:0},function(){return s.getBoundingClientRect().left}))+"px"}),c.each({margin:"",padding:"",border:"Width"},function(s,o){c.cssHooks[s+o]={expand:function(h){for(var f=0,g={},p=typeof h=="string"?h.split(" "):[h];f<4;f++)g[s+At[f]+o]=p[f]||p[f-2]||p[0];return g}},s!=="margin"&&(c.cssHooks[s+o].set=Fa)}),c.fn.extend({css:function(s,o){return Lt(this,function(h,f,g){var p,w,S={},k=0;if(Array.isArray(f)){for(p=Un(h),w=f.length;k<w;k++)S[f[k]]=c.css(h,f[k],!1,p);return S}return g!==void 0?c.style(h,f,g):c.css(h,f)},s,o,arguments.length>1)}});function Ze(s,o,h,f,g){return new Ze.prototype.init(s,o,h,f,g)}c.Tween=Ze,Ze.prototype={constructor:Ze,init:function(s,o,h,f,g,p){this.elem=s,this.prop=h,this.easing=g||c.easing._default,this.options=o,this.start=this.now=this.cur(),this.end=f,this.unit=p||(c.cssNumber[h]?"":"px")},cur:function(){var s=Ze.propHooks[this.prop];return s&&s.get?s.get(this):Ze.propHooks._default.get(this)},run:function(s){var o,h=Ze.propHooks[this.prop];return this.options.duration?this.pos=o=c.easing[this.easing](s,this.options.duration*s,0,1,this.options.duration):this.pos=o=s,this.now=(this.end-this.start)*o+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),h&&h.set?h.set(this):Ze.propHooks._default.set(this),this}},Ze.prototype.init.prototype=Ze.prototype,Ze.propHooks={_default:{get:function(s){var o;return s.elem.nodeType!==1||s.elem[s.prop]!=null&&s.elem.style[s.prop]==null?s.elem[s.prop]:(o=c.css(s.elem,s.prop,""),!o||o==="auto"?0:o)},set:function(s){c.fx.step[s.prop]?c.fx.step[s.prop](s):s.elem.nodeType===1&&(c.cssHooks[s.prop]||s.elem.style[Hr(s.prop)]!=null)?c.style(s.elem,s.prop,s.now+s.unit):s.elem[s.prop]=s.now}}},Ze.propHooks.scrollTop=Ze.propHooks.scrollLeft={set:function(s){s.elem.nodeType&&s.elem.parentNode&&(s.elem[s.prop]=s.now)}},c.easing={linear:function(s){return s},swing:function(s){return .5-Math.cos(s*Math.PI)/2},_default:"swing"},c.fx=Ze.prototype.init,c.fx.step={};var Di,Hn,ad=/^(?:toggle|show|hide)$/,od=/queueHooks$/;function jr(){Hn&&(F.hidden===!1&&t.requestAnimationFrame?t.requestAnimationFrame(jr):t.setTimeout(jr,c.fx.interval),c.fx.tick())}function Ha(){return t.setTimeout(function(){Di=void 0}),Di=Date.now()}function $n(s,o){var h,f=0,g={height:s};for(o=o?1:0;f<4;f+=2-o)h=At[f],g["margin"+h]=g["padding"+h]=s;return o&&(g.opacity=g.width=s),g}function $a(s,o,h){for(var f,g=(gt.tweeners[o]||[]).concat(gt.tweeners["*"]),p=0,w=g.length;p<w;p++)if(f=g[p].call(h,o,s))return f}function ld(s,o,h){var f,g,p,w,S,k,C,L,M="width"in o||"height"in o,X=this,D={},G=s.style,ae=s.nodeType&&zn(s),$=Z.get(s,"fxshow");h.queue||(w=c._queueHooks(s,"fx"),w.unqueued==null&&(w.unqueued=0,S=w.empty.fire,w.empty.fire=function(){w.unqueued||S()}),w.unqueued++,X.always(function(){X.always(function(){w.unqueued--,c.queue(s,"fx").length||w.empty.fire()})}));for(f in o)if(g=o[f],ad.test(g)){if(delete o[f],p=p||g==="toggle",g===(ae?"hide":"show"))if(g==="show"&&$&&$[f]!==void 0)ae=!0;else continue;D[f]=$&&$[f]||c.style(s,f)}if(k=!c.isEmptyObject(o),!(!k&&c.isEmptyObject(D))){M&&s.nodeType===1&&(h.overflow=[G.overflow,G.overflowX,G.overflowY],C=$&&$.display,C==null&&(C=Z.get(s,"display")),L=c.css(s,"display"),L==="none"&&(C?L=C:(Yi([s],!0),C=s.style.display||C,L=c.css(s,"display"),Yi([s]))),(L==="inline"||L==="inline-block"&&C!=null)&&c.css(s,"float")==="none"&&(k||(X.done(function(){G.display=C}),C==null&&(L=G.display,C=L==="none"?"":L)),G.display="inline-block")),h.overflow&&(G.overflow="hidden",X.always(function(){G.overflow=h.overflow[0],G.overflowX=h.overflow[1],G.overflowY=h.overflow[2]})),k=!1;for(f in D)k||($?"hidden"in $&&(ae=$.hidden):$=Z.access(s,"fxshow",{display:C}),p&&($.hidden=!ae),ae&&Yi([s],!0),X.done(function(){ae||Yi([s]),Z.remove(s,"fxshow");for(f in D)c.style(s,f,D[f])})),k=$a(ae?$[f]:0,f,X),f in $||($[f]=k.start,ae&&(k.end=k.start,k.start=0))}}function hd(s,o){var h,f,g,p,w;for(h in s)if(f=St(h),g=o[f],p=s[h],Array.isArray(p)&&(g=p[1],p=s[h]=p[0]),h!==f&&(s[f]=p,delete s[h]),w=c.cssHooks[f],w&&"expand"in w){p=w.expand(p),delete s[f];for(h in p)h in s||(s[h]=p[h],o[h]=g)}else o[f]=g}function gt(s,o,h){var f,g,p=0,w=gt.prefilters.length,S=c.Deferred().always(function(){delete k.elem}),k=function(){if(g)return!1;for(var M=Di||Ha(),X=Math.max(0,C.startTime+C.duration-M),D=X/C.duration||0,G=1-D,ae=0,$=C.tweens.length;ae<$;ae++)C.tweens[ae].run(G);return S.notifyWith(s,[C,G,X]),G<1&&$?X:($||S.notifyWith(s,[C,1,0]),S.resolveWith(s,[C]),!1)},C=S.promise({elem:s,props:c.extend({},o),opts:c.extend(!0,{specialEasing:{},easing:c.easing._default},h),originalProperties:o,originalOptions:h,startTime:Di||Ha(),duration:h.duration,tweens:[],createTween:function(M,X){var D=c.Tween(s,C.opts,M,X,C.opts.specialEasing[M]||C.opts.easing);return C.tweens.push(D),D},stop:function(M){var X=0,D=M?C.tweens.length:0;if(g)return this;for(g=!0;X<D;X++)C.tweens[X].run(1);return M?(S.notifyWith(s,[C,1,0]),S.resolveWith(s,[C,M])):S.rejectWith(s,[C,M]),this}}),L=C.props;for(hd(L,C.opts.specialEasing);p<w;p++)if(f=gt.prefilters[p].call(C,s,L,C.opts),f)return O(f.stop)&&(c._queueHooks(C.elem,C.opts.queue).stop=f.stop.bind(f)),f;return c.map(L,$a,C),O(C.opts.start)&&C.opts.start.call(s,C),C.progress(C.opts.progress).done(C.opts.done,C.opts.complete).fail(C.opts.fail).always(C.opts.always),c.fx.timer(c.extend(k,{elem:s,anim:C,queue:C.opts.queue})),C}c.Animation=c.extend(gt,{tweeners:{"*":[function(s,o){var h=this.createTween(s,o);return Ta(h.elem,s,Qi.exec(o),h),h}]},tweener:function(s,o){O(s)?(o=s,s=["*"]):s=s.match(vt);for(var h,f=0,g=s.length;f<g;f++)h=s[f],gt.tweeners[h]=gt.tweeners[h]||[],gt.tweeners[h].unshift(o)},prefilters:[ld],prefilter:function(s,o){o?gt.prefilters.unshift(s):gt.prefilters.push(s)}}),c.speed=function(s,o,h){var f=s&&typeof s=="object"?c.extend({},s):{complete:h||!h&&o||O(s)&&s,duration:s,easing:h&&o||o&&!O(o)&&o};return c.fx.off?f.duration=0:typeof f.duration!="number"&&(f.duration in c.fx.speeds?f.duration=c.fx.speeds[f.duration]:f.duration=c.fx.speeds._default),(f.queue==null||f.queue===!0)&&(f.queue="fx"),f.old=f.complete,f.complete=function(){O(f.old)&&f.old.call(this),f.queue&&c.dequeue(this,f.queue)},f},c.fn.extend({fadeTo:function(s,o,h,f){return this.filter(zn).css("opacity",0).show().end().animate({opacity:o},s,h,f)},animate:function(s,o,h,f){var g=c.isEmptyObject(s),p=c.speed(o,h,f),w=function(){var S=gt(this,c.extend({},s),p);(g||Z.get(this,"finish"))&&S.stop(!0)};return w.finish=w,g||p.queue===!1?this.each(w):this.queue(p.queue,w)},stop:function(s,o,h){var f=function(g){var p=g.stop;delete g.stop,p(h)};return typeof s!="string"&&(h=o,o=s,s=void 0),o&&this.queue(s||"fx",[]),this.each(function(){var g=!0,p=s!=null&&s+"queueHooks",w=c.timers,S=Z.get(this);if(p)S[p]&&S[p].stop&&f(S[p]);else for(p in S)S[p]&&S[p].stop&&od.test(p)&&f(S[p]);for(p=w.length;p--;)w[p].elem===this&&(s==null||w[p].queue===s)&&(w[p].anim.stop(h),g=!1,w.splice(p,1));(g||!h)&&c.dequeue(this,s)})},finish:function(s){return s!==!1&&(s=s||"fx"),this.each(function(){var o,h=Z.get(this),f=h[s+"queue"],g=h[s+"queueHooks"],p=c.timers,w=f?f.length:0;for(h.finish=!0,c.queue(this,s,[]),g&&g.stop&&g.stop.call(this,!0),o=p.length;o--;)p[o].elem===this&&p[o].queue===s&&(p[o].anim.stop(!0),p.splice(o,1));for(o=0;o<w;o++)f[o]&&f[o].finish&&f[o].finish.call(this);delete h.finish})}}),c.each(["toggle","show","hide"],function(s,o){var h=c.fn[o];c.fn[o]=function(f,g,p){return f==null||typeof f=="boolean"?h.apply(this,arguments):this.animate($n(o,!0),f,g,p)}}),c.each({slideDown:$n("show"),slideUp:$n("hide"),slideToggle:$n("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(s,o){c.fn[s]=function(h,f,g){return this.animate(o,h,f,g)}}),c.timers=[],c.fx.tick=function(){var s,o=0,h=c.timers;for(Di=Date.now();o<h.length;o++)s=h[o],!s()&&h[o]===s&&h.splice(o--,1);h.length||c.fx.stop(),Di=void 0},c.fx.timer=function(s){c.timers.push(s),c.fx.start()},c.fx.interval=13,c.fx.start=function(){Hn||(Hn=!0,jr())},c.fx.stop=function(){Hn=null},c.fx.speeds={slow:600,fast:200,_default:400},c.fn.delay=function(s,o){return s=c.fx&&c.fx.speeds[s]||s,o=o||"fx",this.queue(o,function(h,f){var g=t.setTimeout(h,s);f.stop=function(){t.clearTimeout(g)}})},function(){var s=F.createElement("input"),o=F.createElement("select"),h=o.appendChild(F.createElement("option"));s.type="checkbox",A.checkOn=s.value!=="",A.optSelected=h.selected,s=F.createElement("input"),s.value="t",s.type="radio",A.radioValue=s.value==="t"}();var ja,tn=c.expr.attrHandle;c.fn.extend({attr:function(s,o){return Lt(this,c.attr,s,o,arguments.length>1)},removeAttr:function(s){return this.each(function(){c.removeAttr(this,s)})}}),c.extend({attr:function(s,o,h){var f,g,p=s.nodeType;if(!(p===3||p===8||p===2)){if(typeof s.getAttribute>"u")return c.prop(s,o,h);if((p!==1||!c.isXMLDoc(s))&&(g=c.attrHooks[o.toLowerCase()]||(c.expr.match.bool.test(o)?ja:void 0)),h!==void 0){if(h===null){c.removeAttr(s,o);return}return g&&"set"in g&&(f=g.set(s,h,o))!==void 0?f:(s.setAttribute(o,h+""),h)}return g&&"get"in g&&(f=g.get(s,o))!==null?f:(f=c.find.attr(s,o),f==null?void 0:f)}},attrHooks:{type:{set:function(s,o){if(!A.radioValue&&o==="radio"&&Le(s,"input")){var h=s.value;return s.setAttribute("type",o),h&&(s.value=h),o}}}},removeAttr:function(s,o){var h,f=0,g=o&&o.match(vt);if(g&&s.nodeType===1)for(;h=g[f++];)s.removeAttribute(h)}}),ja={set:function(s,o,h){return o===!1?c.removeAttr(s,h):s.setAttribute(h,h),h}},c.each(c.expr.match.bool.source.match(/\w+/g),function(s,o){var h=tn[o]||c.find.attr;tn[o]=function(f,g,p){var w,S,k=g.toLowerCase();return p||(S=tn[k],tn[k]=w,w=h(f,g,p)!=null?k:null,tn[k]=S),w}});var dd=/^(?:input|select|textarea|button)$/i,fd=/^(?:a|area)$/i;c.fn.extend({prop:function(s,o){return Lt(this,c.prop,s,o,arguments.length>1)},removeProp:function(s){return this.each(function(){delete this[c.propFix[s]||s]})}}),c.extend({prop:function(s,o,h){var f,g,p=s.nodeType;if(!(p===3||p===8||p===2))return(p!==1||!c.isXMLDoc(s))&&(o=c.propFix[o]||o,g=c.propHooks[o]),h!==void 0?g&&"set"in g&&(f=g.set(s,h,o))!==void 0?f:s[o]=h:g&&"get"in g&&(f=g.get(s,o))!==null?f:s[o]},propHooks:{tabIndex:{get:function(s){var o=c.find.attr(s,"tabindex");return o?parseInt(o,10):dd.test(s.nodeName)||fd.test(s.nodeName)&&s.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),A.optSelected||(c.propHooks.selected={get:function(s){var o=s.parentNode;return o&&o.parentNode&&o.parentNode.selectedIndex,null},set:function(s){var o=s.parentNode;o&&(o.selectedIndex,o.parentNode&&o.parentNode.selectedIndex)}}),c.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){c.propFix[this.toLowerCase()]=this});function ii(s){var o=s.match(vt)||[];return o.join(" ")}function ni(s){return s.getAttribute&&s.getAttribute("class")||""}function Gr(s){return Array.isArray(s)?s:typeof s=="string"?s.match(vt)||[]:[]}c.fn.extend({addClass:function(s){var o,h,f,g,p,w;return O(s)?this.each(function(S){c(this).addClass(s.call(this,S,ni(this)))}):(o=Gr(s),o.length?this.each(function(){if(f=ni(this),h=this.nodeType===1&&" "+ii(f)+" ",h){for(p=0;p<o.length;p++)g=o[p],h.indexOf(" "+g+" ")<0&&(h+=g+" ");w=ii(h),f!==w&&this.setAttribute("class",w)}}):this)},removeClass:function(s){var o,h,f,g,p,w;return O(s)?this.each(function(S){c(this).removeClass(s.call(this,S,ni(this)))}):arguments.length?(o=Gr(s),o.length?this.each(function(){if(f=ni(this),h=this.nodeType===1&&" "+ii(f)+" ",h){for(p=0;p<o.length;p++)for(g=o[p];h.indexOf(" "+g+" ")>-1;)h=h.replace(" "+g+" "," ");w=ii(h),f!==w&&this.setAttribute("class",w)}}):this):this.attr("class","")},toggleClass:function(s,o){var h,f,g,p,w=typeof s,S=w==="string"||Array.isArray(s);return O(s)?this.each(function(k){c(this).toggleClass(s.call(this,k,ni(this),o),o)}):typeof o=="boolean"&&S?o?this.addClass(s):this.removeClass(s):(h=Gr(s),this.each(function(){if(S)for(p=c(this),g=0;g<h.length;g++)f=h[g],p.hasClass(f)?p.removeClass(f):p.addClass(f);else(s===void 0||w==="boolean")&&(f=ni(this),f&&Z.set(this,"__className__",f),this.setAttribute&&this.setAttribute("class",f||s===!1?"":Z.get(this,"__className__")||""))}))},hasClass:function(s){var o,h,f=0;for(o=" "+s+" ";h=this[f++];)if(h.nodeType===1&&(" "+ii(ni(h))+" ").indexOf(o)>-1)return!0;return!1}});var cd=/\r/g;c.fn.extend({val:function(s){var o,h,f,g=this[0];return arguments.length?(f=O(s),this.each(function(p){var w;this.nodeType===1&&(f?w=s.call(this,p,c(this).val()):w=s,w==null?w="":typeof w=="number"?w+="":Array.isArray(w)&&(w=c.map(w,function(S){return S==null?"":S+""})),o=c.valHooks[this.type]||c.valHooks[this.nodeName.toLowerCase()],(!o||!("set"in o)||o.set(this,w,"value")===void 0)&&(this.value=w))})):g?(o=c.valHooks[g.type]||c.valHooks[g.nodeName.toLowerCase()],o&&"get"in o&&(h=o.get(g,"value"))!==void 0?h:(h=g.value,typeof h=="string"?h.replace(cd,""):h==null?"":h)):void 0}}),c.extend({valHooks:{option:{get:function(s){var o=c.find.attr(s,"value");return o!=null?o:ii(c.text(s))}},select:{get:function(s){var o,h,f,g=s.options,p=s.selectedIndex,w=s.type==="select-one",S=w?null:[],k=w?p+1:g.length;for(p<0?f=k:f=w?p:0;f<k;f++)if(h=g[f],(h.selected||f===p)&&!h.disabled&&(!h.parentNode.disabled||!Le(h.parentNode,"optgroup"))){if(o=c(h).val(),w)return o;S.push(o)}return S},set:function(s,o){for(var h,f,g=s.options,p=c.makeArray(o),w=g.length;w--;)f=g[w],(f.selected=c.inArray(c.valHooks.option.get(f),p)>-1)&&(h=!0);return h||(s.selectedIndex=-1),p}}}}),c.each(["radio","checkbox"],function(){c.valHooks[this]={set:function(s,o){if(Array.isArray(o))return s.checked=c.inArray(c(s).val(),o)>-1}},A.checkOn||(c.valHooks[this].get=function(s){return s.getAttribute("value")===null?"on":s.value})}),A.focusin="onfocusin"in t;var Ga=/^(?:focusinfocus|focusoutblur)$/,Wa=function(s){s.stopPropagation()};c.extend(c.event,{trigger:function(s,o,h,f){var g,p,w,S,k,C,L,M,X=[h||F],D=E.call(s,"type")?s.type:s,G=E.call(s,"namespace")?s.namespace.split("."):[];if(p=M=w=h=h||F,!(h.nodeType===3||h.nodeType===8)&&!Ga.test(D+c.event.triggered)&&(D.indexOf(".")>-1&&(G=D.split("."),D=G.shift(),G.sort()),k=D.indexOf(":")<0&&"on"+D,s=s[c.expando]?s:new c.Event(D,typeof s=="object"&&s),s.isTrigger=f?2:3,s.namespace=G.join("."),s.rnamespace=s.namespace?new RegExp("(^|\\.)"+G.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,s.result=void 0,s.target||(s.target=h),o=o==null?[s]:c.makeArray(o,[s]),L=c.event.special[D]||{},!(!f&&L.trigger&&L.trigger.apply(h,o)===!1))){if(!f&&!L.noBubble&&!J(h)){for(S=L.delegateType||D,Ga.test(S+D)||(p=p.parentNode);p;p=p.parentNode)X.push(p),w=p;w===(h.ownerDocument||F)&&X.push(w.defaultView||w.parentWindow||t)}for(g=0;(p=X[g++])&&!s.isPropagationStopped();)M=p,s.type=g>1?S:L.bindType||D,C=(Z.get(p,"events")||Object.create(null))[s.type]&&Z.get(p,"handle"),C&&C.apply(p,o),C=k&&p[k],C&&C.apply&&Zi(p)&&(s.result=C.apply(p,o),s.result===!1&&s.preventDefault());return s.type=D,!f&&!s.isDefaultPrevented()&&(!L._default||L._default.apply(X.pop(),o)===!1)&&Zi(h)&&k&&O(h[D])&&!J(h)&&(w=h[k],w&&(h[k]=null),c.event.triggered=D,s.isPropagationStopped()&&M.addEventListener(D,Wa),h[D](),s.isPropagationStopped()&&M.removeEventListener(D,Wa),c.event.triggered=void 0,w&&(h[k]=w)),s.result}},simulate:function(s,o,h){var f=c.extend(new c.Event,h,{type:s,isSimulated:!0});c.event.trigger(f,null,o)}}),c.fn.extend({trigger:function(s,o){return this.each(function(){c.event.trigger(s,o,this)})},triggerHandler:function(s,o){var h=this[0];if(h)return c.event.trigger(s,o,h,!0)}}),A.focusin||c.each({focus:"focusin",blur:"focusout"},function(s,o){var h=function(f){c.event.simulate(o,f.target,c.event.fix(f))};c.event.special[o]={setup:function(){var f=this.ownerDocument||this.document||this,g=Z.access(f,o);g||f.addEventListener(s,h,!0),Z.access(f,o,(g||0)+1)},teardown:function(){var f=this.ownerDocument||this.document||this,g=Z.access(f,o)-1;g?Z.access(f,o,g):(f.removeEventListener(s,h,!0),Z.remove(f,o))}}});var nn=t.location,Va={guid:Date.now()},Wr=/\?/;c.parseXML=function(s){var o,h;if(!s||typeof s!="string")return null;try{o=new t.DOMParser().parseFromString(s,"text/xml")}catch(f){}return h=o&&o.getElementsByTagName("parsererror")[0],(!o||h)&&c.error("Invalid XML: "+(h?c.map(h.childNodes,function(f){return f.textContent}).join(`
`):s)),o};var ud=/\[\]$/,Za=/\r?\n/g,gd=/^(?:submit|button|image|reset|file)$/i,pd=/^(?:input|select|textarea|keygen)/i;function Vr(s,o,h,f){var g;if(Array.isArray(o))c.each(o,function(p,w){h||ud.test(s)?f(s,w):Vr(s+"["+(typeof w=="object"&&w!=null?p:"")+"]",w,h,f)});else if(!h&&z(o)==="object")for(g in o)Vr(s+"["+g+"]",o[g],h,f);else f(s,o)}c.param=function(s,o){var h,f=[],g=function(p,w){var S=O(w)?w():w;f[f.length]=encodeURIComponent(p)+"="+encodeURIComponent(S==null?"":S)};if(s==null)return"";if(Array.isArray(s)||s.jquery&&!c.isPlainObject(s))c.each(s,function(){g(this.name,this.value)});else for(h in s)Vr(h,s[h],o,g);return f.join("&")},c.fn.extend({serialize:function(){return c.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var s=c.prop(this,"elements");return s?c.makeArray(s):this}).filter(function(){var s=this.type;return this.name&&!c(this).is(":disabled")&&pd.test(this.nodeName)&&!gd.test(s)&&(this.checked||!Ji.test(s))}).map(function(s,o){var h=c(this).val();return h==null?null:Array.isArray(h)?c.map(h,function(f){return{name:o.name,value:f.replace(Za,`\r
`)}}):{name:o.name,value:h.replace(Za,`\r
`)}}).get()}});var md=/%20/g,wd=/#.*$/,_d=/([?&])_=[^&]*/,bd=/^(.*?):[ \t]*([^\r\n]*)$/mg,yd=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,kd=/^(?:GET|HEAD)$/,vd=/^\/\//,Ka={},Zr={},Qa="*/".concat("*"),Kr=F.createElement("a");Kr.href=nn.href;function Ja(s){return function(o,h){typeof o!="string"&&(h=o,o="*");var f,g=0,p=o.toLowerCase().match(vt)||[];if(O(h))for(;f=p[g++];)f[0]==="+"?(f=f.slice(1)||"*",(s[f]=s[f]||[]).unshift(h)):(s[f]=s[f]||[]).push(h)}}function eo(s,o,h,f){var g={},p=s===Zr;function w(S){var k;return g[S]=!0,c.each(s[S]||[],function(C,L){var M=L(o,h,f);if(typeof M=="string"&&!p&&!g[M])return o.dataTypes.unshift(M),w(M),!1;if(p)return!(k=M)}),k}return w(o.dataTypes[0])||!g["*"]&&w("*")}function Qr(s,o){var h,f,g=c.ajaxSettings.flatOptions||{};for(h in o)o[h]!==void 0&&((g[h]?s:f||(f={}))[h]=o[h]);return f&&c.extend(!0,s,f),s}function Sd(s,o,h){for(var f,g,p,w,S=s.contents,k=s.dataTypes;k[0]==="*";)k.shift(),f===void 0&&(f=s.mimeType||o.getResponseHeader("Content-Type"));if(f){for(g in S)if(S[g]&&S[g].test(f)){k.unshift(g);break}}if(k[0]in h)p=k[0];else{for(g in h){if(!k[0]||s.converters[g+" "+k[0]]){p=g;break}w||(w=g)}p=p||w}if(p)return p!==k[0]&&k.unshift(p),h[p]}function xd(s,o,h,f){var g,p,w,S,k,C={},L=s.dataTypes.slice();if(L[1])for(w in s.converters)C[w.toLowerCase()]=s.converters[w];for(p=L.shift();p;)if(s.responseFields[p]&&(h[s.responseFields[p]]=o),!k&&f&&s.dataFilter&&(o=s.dataFilter(o,s.dataType)),k=p,p=L.shift(),p){if(p==="*")p=k;else if(k!=="*"&&k!==p){if(w=C[k+" "+p]||C["* "+p],!w){for(g in C)if(S=g.split(" "),S[1]===p&&(w=C[k+" "+S[0]]||C["* "+S[0]],w)){w===!0?w=C[g]:C[g]!==!0&&(p=S[0],L.unshift(S[1]));break}}if(w!==!0)if(w&&s.throws)o=w(o);else try{o=w(o)}catch(M){return{state:"parsererror",error:w?M:"No conversion from "+k+" to "+p}}}}return{state:"success",data:o}}c.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:nn.href,type:"GET",isLocal:yd.test(nn.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Qa,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":c.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(s,o){return o?Qr(Qr(s,c.ajaxSettings),o):Qr(c.ajaxSettings,s)},ajaxPrefilter:Ja(Ka),ajaxTransport:Ja(Zr),ajax:function(s,o){typeof s=="object"&&(o=s,s=void 0),o=o||{};var h,f,g,p,w,S,k,C,L,M,X=c.ajaxSetup({},o),D=X.context||X,G=X.context&&(D.nodeType||D.jquery)?c(D):c.event,ae=c.Deferred(),$=c.Callbacks("once memory"),De=X.statusCode||{},Ae={},tt={},ye="canceled",se={readyState:0,getResponseHeader:function(me){var Ie;if(k){if(!p)for(p={};Ie=bd.exec(g);)p[Ie[1].toLowerCase()+" "]=(p[Ie[1].toLowerCase()+" "]||[]).concat(Ie[2]);Ie=p[me.toLowerCase()+" "]}return Ie==null?null:Ie.join(", ")},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(me,Ie){return k==null&&(me=tt[me.toLowerCase()]=tt[me.toLowerCase()]||me,Ae[me]=Ie),this},overrideMimeType:function(me){return k==null&&(X.mimeType=me),this},statusCode:function(me){var Ie;if(me)if(k)se.always(me[se.status]);else for(Ie in me)De[Ie]=[De[Ie],me[Ie]];return this},abort:function(me){var Ie=me||ye;return h&&h.abort(Ie),Ke(0,Ie),this}};if(ae.promise(se),X.url=((s||X.url||nn.href)+"").replace(vd,nn.protocol+"//"),X.type=o.method||o.type||X.method||X.type,X.dataTypes=(X.dataType||"*").toLowerCase().match(vt)||[""],X.crossDomain==null){S=F.createElement("a");try{S.href=X.url,S.href=S.href,X.crossDomain=Kr.protocol+"//"+Kr.host!=S.protocol+"//"+S.host}catch(me){X.crossDomain=!0}}if(X.data&&X.processData&&typeof X.data!="string"&&(X.data=c.param(X.data,X.traditional)),eo(Ka,X,o,se),k)return se;C=c.event&&X.global,C&&c.active++===0&&c.event.trigger("ajaxStart"),X.type=X.type.toUpperCase(),X.hasContent=!kd.test(X.type),f=X.url.replace(wd,""),X.hasContent?X.data&&X.processData&&(X.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(X.data=X.data.replace(md,"+")):(M=X.url.slice(f.length),X.data&&(X.processData||typeof X.data=="string")&&(f+=(Wr.test(f)?"&":"?")+X.data,delete X.data),X.cache===!1&&(f=f.replace(_d,"$1"),M=(Wr.test(f)?"&":"?")+"_="+Va.guid+++M),X.url=f+M),X.ifModified&&(c.lastModified[f]&&se.setRequestHeader("If-Modified-Since",c.lastModified[f]),c.etag[f]&&se.setRequestHeader("If-None-Match",c.etag[f])),(X.data&&X.hasContent&&X.contentType!==!1||o.contentType)&&se.setRequestHeader("Content-Type",X.contentType),se.setRequestHeader("Accept",X.dataTypes[0]&&X.accepts[X.dataTypes[0]]?X.accepts[X.dataTypes[0]]+(X.dataTypes[0]!=="*"?", "+Qa+"; q=0.01":""):X.accepts["*"]);for(L in X.headers)se.setRequestHeader(L,X.headers[L]);if(X.beforeSend&&(X.beforeSend.call(D,se,X)===!1||k))return se.abort();if(ye="abort",$.add(X.complete),se.done(X.success),se.fail(X.error),h=eo(Zr,X,o,se),!h)Ke(-1,"No Transport");else{if(se.readyState=1,C&&G.trigger("ajaxSend",[se,X]),k)return se;X.async&&X.timeout>0&&(w=t.setTimeout(function(){se.abort("timeout")},X.timeout));try{k=!1,h.send(Ae,Ke)}catch(me){if(k)throw me;Ke(-1,me)}}function Ke(me,Ie,sn,jn){var it,ri,si,Qe,Ut,dt=Ie;k||(k=!0,w&&t.clearTimeout(w),h=void 0,g=jn||"",se.readyState=me>0?4:0,it=me>=200&&me<300||me===304,sn&&(Qe=Sd(X,se,sn)),!it&&c.inArray("script",X.dataTypes)>-1&&c.inArray("json",X.dataTypes)<0&&(X.converters["text script"]=function(){}),Qe=xd(X,Qe,se,it),it?(X.ifModified&&(Ut=se.getResponseHeader("Last-Modified"),Ut&&(c.lastModified[f]=Ut),Ut=se.getResponseHeader("etag"),Ut&&(c.etag[f]=Ut)),me===204||X.type==="HEAD"?dt="nocontent":me===304?dt="notmodified":(dt=Qe.state,ri=Qe.data,si=Qe.error,it=!si)):(si=dt,(me||!dt)&&(dt="error",me<0&&(me=0))),se.status=me,se.statusText=(Ie||dt)+"",it?ae.resolveWith(D,[ri,dt,se]):ae.rejectWith(D,[se,dt,si]),se.statusCode(De),De=void 0,C&&G.trigger(it?"ajaxSuccess":"ajaxError",[se,X,it?ri:si]),$.fireWith(D,[se,dt]),C&&(G.trigger("ajaxComplete",[se,X]),--c.active||c.event.trigger("ajaxStop")))}return se},getJSON:function(s,o,h){return c.get(s,o,h,"json")},getScript:function(s,o){return c.get(s,void 0,o,"script")}}),c.each(["get","post"],function(s,o){c[o]=function(h,f,g,p){return O(f)&&(p=p||g,g=f,f=void 0),c.ajax(c.extend({url:h,type:o,dataType:p,data:f,success:g},c.isPlainObject(h)&&h))}}),c.ajaxPrefilter(function(s){var o;for(o in s.headers)o.toLowerCase()==="content-type"&&(s.contentType=s.headers[o]||"")}),c._evalUrl=function(s,o,h){return c.ajax({url:s,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(f){c.globalEval(f,o,h)}})},c.fn.extend({wrapAll:function(s){var o;return this[0]&&(O(s)&&(s=s.call(this[0])),o=c(s,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&o.insertBefore(this[0]),o.map(function(){for(var h=this;h.firstElementChild;)h=h.firstElementChild;return h}).append(this)),this},wrapInner:function(s){return O(s)?this.each(function(o){c(this).wrapInner(s.call(this,o))}):this.each(function(){var o=c(this),h=o.contents();h.length?h.wrapAll(s):o.append(s)})},wrap:function(s){var o=O(s);return this.each(function(h){c(this).wrapAll(o?s.call(this,h):s)})},unwrap:function(s){return this.parent(s).not("body").each(function(){c(this).replaceWith(this.childNodes)}),this}}),c.expr.pseudos.hidden=function(s){return!c.expr.pseudos.visible(s)},c.expr.pseudos.visible=function(s){return!!(s.offsetWidth||s.offsetHeight||s.getClientRects().length)},c.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(s){}};var Ed={0:200,1223:204},rn=c.ajaxSettings.xhr();A.cors=!!rn&&"withCredentials"in rn,A.ajax=rn=!!rn,c.ajaxTransport(function(s){var o,h;if(A.cors||rn&&!s.crossDomain)return{send:function(f,g){var p,w=s.xhr();if(w.open(s.type,s.url,s.async,s.username,s.password),s.xhrFields)for(p in s.xhrFields)w[p]=s.xhrFields[p];s.mimeType&&w.overrideMimeType&&w.overrideMimeType(s.mimeType),!s.crossDomain&&!f["X-Requested-With"]&&(f["X-Requested-With"]="XMLHttpRequest");for(p in f)w.setRequestHeader(p,f[p]);o=function(S){return function(){o&&(o=h=w.onload=w.onerror=w.onabort=w.ontimeout=w.onreadystatechange=null,S==="abort"?w.abort():S==="error"?typeof w.status!="number"?g(0,"error"):g(w.status,w.statusText):g(Ed[w.status]||w.status,w.statusText,(w.responseType||"text")!=="text"||typeof w.responseText!="string"?{binary:w.response}:{text:w.responseText},w.getAllResponseHeaders()))}},w.onload=o(),h=w.onerror=w.ontimeout=o("error"),w.onabort!==void 0?w.onabort=h:w.onreadystatechange=function(){w.readyState===4&&t.setTimeout(function(){o&&h()})},o=o("abort");try{w.send(s.hasContent&&s.data||null)}catch(S){if(o)throw S}},abort:function(){o&&o()}}}),c.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),c.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(s){return c.globalEval(s),s}}}),c.ajaxPrefilter("script",function(s){s.cache===void 0&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),c.ajaxTransport("script",function(s){if(s.crossDomain||s.scriptAttrs){var o,h;return{send:function(f,g){o=c("<script>").attr(s.scriptAttrs||{}).prop({charset:s.scriptCharset,src:s.url}).on("load error",h=function(p){o.remove(),h=null,p&&g(p.type==="error"?404:200,p.type)}),F.head.appendChild(o[0])},abort:function(){h&&h()}}}});var to=[],Jr=/(=)\?(?=&|$)|\?\?/;c.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var s=to.pop()||c.expando+"_"+Va.guid++;return this[s]=!0,s}}),c.ajaxPrefilter("json jsonp",function(s,o,h){var f,g,p,w=s.jsonp!==!1&&(Jr.test(s.url)?"url":typeof s.data=="string"&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Jr.test(s.data)&&"data");if(w||s.dataTypes[0]==="jsonp")return f=s.jsonpCallback=O(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,w?s[w]=s[w].replace(Jr,"$1"+f):s.jsonp!==!1&&(s.url+=(Wr.test(s.url)?"&":"?")+s.jsonp+"="+f),s.converters["script json"]=function(){return p||c.error(f+" was not called"),p[0]},s.dataTypes[0]="json",g=t[f],t[f]=function(){p=arguments},h.always(function(){g===void 0?c(t).removeProp(f):t[f]=g,s[f]&&(s.jsonpCallback=o.jsonpCallback,to.push(f)),p&&O(g)&&g(p[0]),p=g=void 0}),"script"}),A.createHTMLDocument=function(){var s=F.implementation.createHTMLDocument("").body;return s.innerHTML="<form></form><form></form>",s.childNodes.length===2}(),c.parseHTML=function(s,o,h){if(typeof s!="string")return[];typeof o=="boolean"&&(h=o,o=!1);var f,g,p;return o||(A.createHTMLDocument?(o=F.implementation.createHTMLDocument(""),f=o.createElement("base"),f.href=F.location.href,o.head.appendChild(f)):o=F),g=Vi.exec(s),p=!h&&[],g?[o.createElement(g[1])]:(g=Xa([s],o,p),p&&p.length&&c(p).remove(),c.merge([],g.childNodes))},c.fn.load=function(s,o,h){var f,g,p,w=this,S=s.indexOf(" ");return S>-1&&(f=ii(s.slice(S)),s=s.slice(0,S)),O(o)?(h=o,o=void 0):o&&typeof o=="object"&&(g="POST"),w.length>0&&c.ajax({url:s,type:g||"GET",dataType:"html",data:o}).done(function(k){p=arguments,w.html(f?c("<div>").append(c.parseHTML(k)).find(f):k)}).always(h&&function(k,C){w.each(function(){h.apply(this,p||[k.responseText,C,k])})}),this},c.expr.pseudos.animated=function(s){return c.grep(c.timers,function(o){return s===o.elem}).length},c.offset={setOffset:function(s,o,h){var f,g,p,w,S,k,C,L=c.css(s,"position"),M=c(s),X={};L==="static"&&(s.style.position="relative"),S=M.offset(),p=c.css(s,"top"),k=c.css(s,"left"),C=(L==="absolute"||L==="fixed")&&(p+k).indexOf("auto")>-1,C?(f=M.position(),w=f.top,g=f.left):(w=parseFloat(p)||0,g=parseFloat(k)||0),O(o)&&(o=o.call(s,h,c.extend({},S))),o.top!=null&&(X.top=o.top-S.top+w),o.left!=null&&(X.left=o.left-S.left+g),"using"in o?o.using.call(s,X):M.css(X)}},c.fn.extend({offset:function(s){if(arguments.length)return s===void 0?this:this.each(function(g){c.offset.setOffset(this,s,g)});var o,h,f=this[0];if(f)return f.getClientRects().length?(o=f.getBoundingClientRect(),h=f.ownerDocument.defaultView,{top:o.top+h.pageYOffset,left:o.left+h.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var s,o,h,f=this[0],g={top:0,left:0};if(c.css(f,"position")==="fixed")o=f.getBoundingClientRect();else{for(o=this.offset(),h=f.ownerDocument,s=f.offsetParent||h.documentElement;s&&(s===h.body||s===h.documentElement)&&c.css(s,"position")==="static";)s=s.parentNode;s&&s!==f&&s.nodeType===1&&(g=c(s).offset(),g.top+=c.css(s,"borderTopWidth",!0),g.left+=c.css(s,"borderLeftWidth",!0))}return{top:o.top-g.top-c.css(f,"marginTop",!0),left:o.left-g.left-c.css(f,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var s=this.offsetParent;s&&c.css(s,"position")==="static";)s=s.offsetParent;return s||ti})}}),c.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(s,o){var h=o==="pageYOffset";c.fn[s]=function(f){return Lt(this,function(g,p,w){var S;if(J(g)?S=g:g.nodeType===9&&(S=g.defaultView),w===void 0)return S?S[o]:g[p];S?S.scrollTo(h?S.pageXOffset:w,h?w:S.pageYOffset):g[p]=w},s,f,arguments.length)}}),c.each(["top","left"],function(s,o){c.cssHooks[o]=Pa(A.pixelPosition,function(h,f){if(f)return f=en(h,o),Fr.test(f)?c(h).position()[o]+"px":f})}),c.each({Height:"height",Width:"width"},function(s,o){c.each({padding:"inner"+s,content:o,"":"outer"+s},function(h,f){c.fn[f]=function(g,p){var w=arguments.length&&(h||typeof g!="boolean"),S=h||(g===!0||p===!0?"margin":"border");return Lt(this,function(k,C,L){var M;return J(k)?f.indexOf("outer")===0?k["inner"+s]:k.document.documentElement["client"+s]:k.nodeType===9?(M=k.documentElement,Math.max(k.body["scroll"+s],M["scroll"+s],k.body["offset"+s],M["offset"+s],M["client"+s])):L===void 0?c.css(k,C,S):c.style(k,C,L,S)},o,w?g:void 0,w)}})}),c.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(s,o){c.fn[o]=function(h){return this.on(o,h)}}),c.fn.extend({bind:function(s,o,h){return this.on(s,null,o,h)},unbind:function(s,o){return this.off(s,null,o)},delegate:function(s,o,h,f){return this.on(o,s,h,f)},undelegate:function(s,o,h){return arguments.length===1?this.off(s,"**"):this.off(o,s||"**",h)},hover:function(s,o){return this.mouseenter(s).mouseleave(o||s)}}),c.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(s,o){c.fn[o]=function(h,f){return arguments.length>0?this.on(o,null,h,f):this.trigger(o)}});var Td=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;c.proxy=function(s,o){var h,f,g;if(typeof o=="string"&&(h=s[o],o=s,s=h),!!O(s))return f=a.call(arguments,2),g=function(){return s.apply(o||this,f.concat(a.call(arguments)))},g.guid=s.guid=s.guid||c.guid++,g},c.holdReady=function(s){s?c.readyWait++:c.ready(!0)},c.isArray=Array.isArray,c.parseJSON=JSON.parse,c.nodeName=Le,c.isFunction=O,c.isWindow=J,c.camelCase=St,c.type=z,c.now=Date.now,c.isNumeric=function(s){var o=c.type(s);return(o==="number"||o==="string")&&!isNaN(s-parseFloat(s))},c.trim=function(s){return s==null?"":(s+"").replace(Td,"$1")};var Cd=t.jQuery,Id=t.$;return c.noConflict=function(s){return t.$===c&&(t.$=Id),s&&t.jQuery===c&&(t.jQuery=Cd),c},typeof e>"u"&&(t.jQuery=t.$=c),c})})(ff);class cf{constructor(t,e,n=5e3,r){l(this,"element");l(this,"duration",5e3);l(this,"timer");l(this,"static",!1);this.instance=t,this.position=r,this.timer=new hf(Date.now(),n),this.element=this.createBlob(t,e),this.static=!!this.position}update(t,e){this.timer.time=e,_t(this.element).find("p").html(t)}isOver(t){return this.timer.isOver(t)}destroy(){_t(this.element).remove()}createBlob(t,e){return _t(`<div id="${t}" class="bubble"><p>${e}</p><div class="bubble-tip"></div></div>`)}}class uf{constructor(t){l(this,"container",_t("#bubbles"));l(this,"bubbles",{});this.game=t}create(t,e,n=5e3,r){let a=this.bubbles[t];if(a)return a.update(e,Date.now());this.bubbles[t]=new cf(t,e,n,r),this.bubbles[t].element.appendTo(this.container)}setTo(t,e,n){let r=this.bubbles[t],{zoomFactor:a}=this.game.camera,d=this.game.renderer.tileSize*a,u=parseInt(r.element.css("width"))+24,y=u/2-d/2,m=-20;e=(e-this.game.camera.x)*a,n=(n-this.game.camera.y)*a-d*2-m,r.element.css({left:`${e-y+3}px`,top:`${n}px`})}update(t){for(let e of Object.values(this.bubbles)){let n=this.game.entities.get(e.instance);n&&this.setTo(n.instance,n.x,n.y),e.static&&this.setTo(e.instance,e.position.x,e.position.y),e.isOver(t)&&this.destroy(e)}}clear(t){this.bubbles[t]&&this.destroy(this.bubbles[t])}destroy(t){t.destroy(),delete this.bubbles[t.instance]}clean(){for(let t of Object.values(this.bubbles))t.destroy();this.bubbles={}}}let Dl=class{constructor(t){l(this,"game");l(this,"entities");this.character=t,this.game=t.game,this.entities=this.game.entities,this.character.onRequestPath(this.handleRequestPath.bind(this)),this.character.onStartPathing(this.handleStartPathing.bind(this)),this.character.onBeforeStep(this.handleBeforeStep.bind(this)),this.character.onStep(this.handleStep.bind(this)),this.character.onSecondStep(this.handleSecondStep.bind(this)),this.character.onStopPathing(this.handleStopPathing.bind(this)),this.character.onMove(this.handleMove.bind(this)),this.character.onFallback(this.handleFallback.bind(this))}handleRequestPath(t,e){return this.character.gridX===t&&this.character.gridY===e?[]:this.game.map.isColliding(t,e)?[]:this.game.findPath(this.character,t,e)}handleStartPathing(t){}handleBeforeStep(){this.entities.unregisterPosition(this.character)}handleStep(){this.entities.registerPosition(this.character),this.character.forEachAttacker(t=>{if(!t.target||t.target.instance!==this.character.instance)return this.character.removeAttacker(t);t.canAttackTarget()||t.follow(this.character)}),this.character.forEachFollower(t=>{if(!t.target||t.target.instance!==this.character.instance)return this.character.removeFollower(t);t.follow(this.character)}),(this.character.hasTarget()||this.character.hasAttackers())&&this.game.socket.send(B.Movement,{opcode:Ct.Entity,targetInstance:this.character.instance,requestX:this.character.gridX,requestY:this.character.gridY}),this.character.canAttackTarget()&&this.character.stop(!0)}handleSecondStep(){}handleStopPathing(t,e){}handleMove(){}handleFallback(t,e){this.game.teleport(this.character,t,e)}};class go{constructor(){l(this,"startValue",0);l(this,"endValue",0);l(this,"duration",0);l(this,"inProgress",!1);l(this,"startTime");l(this,"updateCallback");l(this,"stopCallback")}start(t,e,n,r,a,d){this.startTime=t,this.startValue=e,this.endValue=n,this.duration=r,this.updateCallback=a,this.stopCallback=d,this.inProgress=!0}step(t){var a,d;if(!this.inProgress)return;let e=t-this.startTime;e>this.duration&&(e=this.duration);let n=this.endValue-this.startValue,r=Math.round(this.startValue+n/this.duration*e);e===this.duration||r===this.endValue?(this.inProgress=!1,(a=this.stopCallback)==null||a.call(this)):(d=this.updateCallback)==null||d.call(this,r)}}class Rn{constructor(t="",e){l(this,"x",0);l(this,"y",0);l(this,"gridX",0);l(this,"gridY",0);l(this,"nextGridX",-1);l(this,"nextGridY",-1);l(this,"movementSpeed",-1);l(this,"attackRange",-1);l(this,"frozen",!1);l(this,"dead",!1);l(this,"name","");l(this,"region",-1);l(this,"healthBarVisible",!1);l(this,"sprite");l(this,"spriteFlipX",!1);l(this,"spriteFlipY",!1);l(this,"animation");l(this,"shadowOffsetY",0);l(this,"hidden",!1);l(this,"visible",!0);l(this,"fading",!1);l(this,"angle",0);l(this,"angled",!1);l(this,"hasCounter",!1);l(this,"counter",0);l(this,"countdownTime",0);l(this,"fadingDuration",1e3);l(this,"orientation",re.Down);l(this,"fadingTime");l(this,"blinking");l(this,"normalSprite");l(this,"hurtSprite");l(this,"silhouetteSprite");l(this,"ready",!1);l(this,"hitPoints",0);l(this,"maxHitPoints",0);l(this,"mana",0);l(this,"maxMana",0);l(this,"level",1);l(this,"experience",0);l(this,"teleporting",!1);l(this,"pvp",!1);l(this,"nameColour");l(this,"customScale");l(this,"fadingAlpha");l(this,"lastUpdate",Date.now());this.instance=t,this.type=e}fadeIn(t){this.fading=!0,this.fadingTime=t}blink(t=150){this.blinking=window.setInterval(()=>this.toggleVisibility(),t)}stopBlinking(){this.blinking&&clearInterval(this.blinking),this.setVisible(!0)}idle(){}animateDeath(t,e=120,n=1){this.setAnimation("death",e,n,t)}updateSilhouette(t=!1){this.silhouetteSprite&&(this.sprite=t?this.silhouetteSprite:this.normalSprite)}setSprite(t){var e;if(!(!t.loaded&&(t.load(),((e=this.sprite)==null?void 0:e.key)===t.key))){if(this.sprite=t,this.normalSprite=t,t.loading){setTimeout(()=>this.setSprite(t),100);return}t.hurtSprite&&(this.hurtSprite=t.hurtSprite),t.silhouetteSprite&&(this.silhouetteSprite=t.silhouetteSprite),t.onLoad(()=>{this.normalSprite=t,t.hurtSprite&&(this.hurtSprite=t.hurtSprite),t.silhouetteSprite&&(this.silhouetteSprite=t.silhouetteSprite),this.customScale&&(this.sprite.offsetX*=this.customScale,this.sprite.offsetY*=this.customScale)})}}setAnimation(t,e=this.sprite.idleSpeed,n=1,r){var m;if(((m=this.animation)==null?void 0:m.name)===t)return;let{length:a,row:d,width:u,height:y}=this.sprite.animations[t];this.animation=new je(t,a,d,u,y),t.startsWith("atk")&&this.animation.reset(),this.animation.setSpeed(e),this.animation.setCount(n,r||(()=>this.idle()))}setPosition(t,e){this.x=t,this.y=e}setGridPosition(t,e){this.gridX=t,this.gridY=e,this.region=q.getRegion(t,e),this.setPosition(t*q.tileSize,e*q.tileSize)}setCountdown(t){this.counter=t,this.countdownTime=Date.now(),this.hasCounter=!0}setVisible(t){this.visible=t}getDistance(t){let{gridX:e,gridY:n}=this;return Math.abs(e-t.gridX)+Math.abs(n-t.gridY)}getAngle(){return this.angle}toggleVisibility(){this.setVisible(!this.visible)}isVisible(){return this.visible}drawNames(){return!0}hasShadow(){return!1}hasMedal(){return!1}isPlayer(){return this.type===xe.Player}isMob(){return this.type===xe.Mob}isNPC(){return this.type===xe.NPC}isItem(){return this.type===xe.Item}isChest(){return this.type===xe.Chest}isProjectile(){return this.type===xe.Projectile}isObject(){return this.type===xe.Object}isModerator(){return!1}isAdmin(){return!1}}class Qt extends Rn{constructor(e,n,r){super(e,n);l(this,"moving",!1);l(this,"following",!1);l(this,"stunned",!1);l(this,"forced",!1);l(this,"trading",!1);l(this,"interrupted",!1);l(this,"path",null);l(this,"target",null);l(this,"lastTarget","");l(this,"statusEffects",[]);l(this,"attackers",{});l(this,"followers",{});l(this,"movement",new go);l(this,"handler");l(this,"attackAnimationSpeed",50);l(this,"walkAnimationSpeed",120);l(this,"effect",_e.None);l(this,"destination");l(this,"newDestination");l(this,"step");l(this,"healthBarTimeout");l(this,"effects",{[_e.Critical]:{key:"effect-critical",animation:new je("effect",10,0,48,48)},[_e.Terror]:{key:"effect-terror",animation:new je("effect",8,0,64,64)},[_e.TerrorStatus]:{key:"effect-terror2",animation:new je("effect",5,0,32,32),perpetual:!0,speed:200},[_e.Stun]:{key:"effect-stun",animation:new je("effect",6,0,48,48),perpetual:!0},[_e.Healing]:{key:"effect-heal",animation:new je("effect",8,0,64,64)},[_e.Fireball]:{key:"effect-fireball",animation:new je("effect",8,0,64,64)},[_e.Iceball]:{key:"effect-iceball",animation:new je("effect",8,0,64,64)},[_e.Burning]:{key:"effect-burn",animation:new je("effect",5,0,32,32),perpetual:!0,speed:150},[_e.Freezing]:{key:"effect-freeze",animation:new je("effect",6,0,32,32),perpetual:!0,speed:200},[_e.Poisonball]:{key:"effect-poisonball",animation:new je("effect",10,0,40,40),speed:175},[_e.Boulder]:{key:"effect-boulder",animation:new je("effect",7,0,32,32)}});l(this,"requestPathCallback");l(this,"startPathingCallback");l(this,"beforeStepCallback");l(this,"stepCallback");l(this,"secondStepCallback");l(this,"stopPathingCallback");l(this,"moveCallback");l(this,"fallbackCallback");l(this,"hitPointsCallback");this.game=r,this.loadAnimations(),this.handler=new Dl(this)}loadAnimations(){for(let e in this.effects){let n=this.effects[e],r=parseInt(e);n.animation.setSpeed(n.speed||50),n.animation.setCount(1,()=>{n.perpetual||this.removeEffect(r),r===_e.Terror&&this.addEffect(_e.TerrorStatus),n.animation.reset(),n.animation.count=1})}}setAnimation(e,n=120,r=0,a){var u;let d=["atk","walk","idle"];((u=this.animation)==null?void 0:u.name)!=="death"&&(this.spriteFlipX=!1,this.spriteFlipY=!1,d.includes(e)&&(e+=`_${this.orientation===re.Left?"right":this.orientationToString()}`,this.spriteFlipX=this.orientation===re.Left),super.setAnimation(e,n,r,a))}animateDeath(e,n=120,r=0){this.setAnimation("death",n,r,e)}toggleHurt(){this.dead||this.teleporting||!this.hurtSprite||(this.sprite=this.hurtSprite,window.setTimeout(()=>this.sprite=this.normalSprite,100))}despawn(){this.hitPoints=0,this.dead=!0,this.removeTarget(),this.stop(),this.orientation=re.Down}trade(e){this.trading=!0,this.follow(e)}follow(e,n=!1){this.following=!0,this.setTarget(e),this.move(e.gridX,e.gridY,n)}pursue(e){this.setTarget(e),this.move(e.gridX,e.gridY),e.addFollower(this)}followPosition(e,n){this.following=!0,this.move(e,n)}addEffect(e){this.hasEffect(e)||this.statusEffects.push(e)}addAttacker(e){this.attackers[e.instance]=e}addFollower(e){this.followers[e.instance]=e}removeEffect(e){e===_e.Terror&&this.removeEffect(_e.TerrorStatus),this.statusEffects=this.statusEffects.filter(n=>n!==e)}removeAllEffects(){this.statusEffects=[]}removeAttacker(e){delete this.attackers[e.instance]}removeFollower(e){delete this.followers[e.instance]}hasEffect(e){return this.statusEffects.includes(e)}hasActiveEffect(){return this.statusEffects.length>0}hasAttackers(){return Object.keys(this.attackers).length>0}hasFollowers(){return Object.keys(this.followers).length>0}performAction(e,n){switch(this.setOrientation(e),n){case st.Idle:{this.setAnimation("idle",this.sprite.idleSpeed);break}case st.Orientate:{this.setAnimation("idle",this.sprite.idleSpeed);break}case st.Attack:{this.setAnimation("atk",this.attackAnimationSpeed,1);break}case st.Walk:{this.setAnimation("walk",this.walkAnimationSpeed);break}}}idle(e,n=!1){if(this.hasPath()&&!n)return;let r=e||this.orientation;this.performAction(r,st.Idle)}orientationToString(){switch(this.orientation){case re.Left:return"left";case re.Right:return"right";case re.Up:return"up";case re.Down:return"down"}}lookAt(e){let{gridX:n,gridY:r}=this;e.gridX>n?this.setOrientation(re.Right):e.gridX<n?this.setOrientation(re.Left):e.gridY>r?this.setOrientation(re.Down):e.gridY<r&&this.setOrientation(re.Up),this.idle()}go(e,n,r=!1,a=!1){this.frozen||(this.following&&(this.following=!1,this.removeTarget()),this.move(e,n,r,a))}move(e,n,r=!1,a=!1){var d;if(this.hasPath()&&!r)this.proceed(e,n);else{let u=this.requestPathfinding(e,n);if((!u||u.length<2)&&a)return(d=this.fallbackCallback)==null?void 0:d.call(this,e,n);this.followPath(u)}this.destination={x:e,y:n}}proceed(e,n){this.newDestination={x:e,y:n}}nextStep(){var d,u,y;let e=!1,n,r,a;if(this.step%2===0&&this.secondStepCallback&&this.secondStepCallback(),!!this.hasPath()){if((d=this.beforeStepCallback)==null||d.call(this),this.updateGridPosition(),!this.interrupted&&this.path)if(this.hasNextStep()&&([this.nextGridX,this.nextGridY]=this.path[this.step+1]),(u=this.stepCallback)==null||u.call(this),this.changedPath()){if({x:n,y:r}=this.newDestination,a=this.requestPathfinding(n,r),!a)return;this.newDestination=null,a.length<2?e=!0:((y=this.startPathingCallback)==null||y.call(this,a),this.followPath(a))}else this.hasNextStep()?(this.step++,this.updateMovement()):e=!0;else e=!0,this.interrupted=!1;e&&(this.path=null,this.idle(),this.stopPathingCallback&&this.stopPathingCallback(this.gridX,this.gridY,this.forced),this.forced=!1)}}updateMovement(){let{path:e,step:n}=this;e&&(e[n][0]<e[n-1][0]&&this.performAction(re.Left,st.Walk),e[n][0]>e[n-1][0]&&this.performAction(re.Right,st.Walk),e[n][1]<e[n-1][1]&&this.performAction(re.Up,st.Walk),e[n][1]>e[n-1][1]&&this.performAction(re.Down,st.Walk))}followPath(e){var n;!e||e.length<2||(this.path=e,this.step=0,this.following&&e.pop(),!this.moving&&!this.changedPath()&&((n=this.startPathingCallback)==null||n.call(this,e)),this.nextStep())}stop(e=!1){e?this.hasPath()&&(this.path=null,this.destination=null,this.newDestination=null,this.movement=new go,this.performAction(this.orientation,st.Idle),this.nextGridX=this.gridX,this.nextGridY=this.gridY):this.interrupted=!0}canAttackTarget(){return!(!this.hasTarget()||!this.target.isMob()&&!this.target.isPlayer()||this.getDistance(this.target)>this.attackRange-1)}getEffect(e){return this.effects[e]}triggerHealthBar(){this.healthBarVisible=!0,this.healthBarTimeout&&clearTimeout(this.healthBarTimeout),this.healthBarTimeout=window.setTimeout(()=>{this.healthBarVisible=!1},7e3)}clearHealthBar(){this.healthBarVisible=!1,clearTimeout(this.healthBarTimeout),this.healthBarTimeout=null}requestPathfinding(e,n){var r;return((r=this.requestPathCallback)==null?void 0:r.call(this,e,n))||null}updateGridPosition(){!this.path||this.path.length===0||this.setGridPosition(this.path[this.step][0],this.path[this.step][1])}hasShadow(){return!0}hasPath(){return this.path!==null}hasNextStep(){return this.path&&this.path.length-1>this.step}changedPath(){return!!this.newDestination}removeTarget(){this.target=null}moved(){var e;(e=this.moveCallback)==null||e.call(this)}setTarget(e){this.target=e,this.lastTarget=e.instance}hasTarget(e){return e?this.target===e:!!this.target}setObjectTarget(e){let n=new Qt(`${e.gridX}-${e.gridY}`,xe.Object,this.game);n.setGridPosition(e.gridX,e.gridY),this.setTarget(n),this.followPosition(e.gridX,e.gridY)}setHitPoints(e,n){var a;let r=!1;e<0&&(e=0),e<this.hitPoints&&(r=!0),this.hitPoints=e,n&&(this.maxHitPoints=n),(a=this.hitPointsCallback)==null||a.call(this,this.hitPoints,n||this.maxHitPoints,r)}setOrientation(e){this.orientation=e}forEachAttacker(e){for(let n of Object.values(this.attackers))e(n)}forEachFollower(e){for(let n of Object.values(this.followers))e(n)}onRequestPath(e){this.requestPathCallback=e}onStartPathing(e){this.startPathingCallback=e}onStopPathing(e){this.stopPathingCallback=e}onBeforeStep(e){this.beforeStepCallback=e}onStep(e){this.stepCallback=e}onSecondStep(e){this.secondStepCallback=e}onMove(e){this.moveCallback=e}onHitPoints(e){this.hitPointsCallback=e}onFallback(e){this.fallbackCallback=e}}class gf extends Qt{constructor(e,n){super(e,xe.Mob,n);l(this,"hiddenName",!1)}hasShadow(){return!this.hiddenName}drawNames(){return!this.hiddenName}}class pf extends Rn{constructor(t){super(t,xe.NPC)}idle(){this.setAnimation("idle_down",this.sprite.idleSpeed)}}class hs{constructor(t,e,n,r=1,a=1,d,u){l(this,"secret",!1);this.id=t,this.name=e,this.description=n,this.stage=r,this.stageCount=a,this.subStage=d,this.rewards=u}update(t,e,n,r){this.stage=t,e&&(this.subStage=e),n&&(this.name=n),r&&(this.description=r)}isFinished(){return this.stage>=this.stageCount}isStarted(){return this.stage>0}}class mf{constructor(t,e=0,n=1){l(this,"name");l(this,"percentage",0);l(this,"nextExperience",0);this.type=t,this.experience=e,this.level=n,this.name=ot[t]}update(t,e,n,r){this.experience=t,this.nextExperience=e,this.level=n||this.level,this.percentage=r||0}}class wf{constructor(t,e,n,r=-1){l(this,"active",!1);this.type=t,this.key=e,this.level=n,this.quickSlot=r}update(t,e=this.quickSlot){this.level=t,this.quickSlot=e}toggle(){this.active=!this.active}}class po{constructor(t,e,n,r){this.id=t,this.username=e,this.online=n,this.serverId=r}}class Jt{constructor(t="",e="",n=-1,r={}){l(this,"attackStats",q.getEmptyStats());l(this,"defenseStats",q.getEmptyStats());l(this,"bonuses",q.getEmptyBonuses());l(this,"attackStyle",He.None);l(this,"attackStyles",[]);this.key=t,this.name=e,this.count=n,this.enchantments=r}update(t="",e="",n=-1,r={},a,d,u,y=He.None,m=[]){this.key=t,this.name=e,this.count=n,this.enchantments=r,this.attackStats=a||q.getEmptyStats(),this.defenseStats=d||q.getEmptyStats(),this.bonuses=u||q.getEmptyBonuses(),this.attackStyle=y,this.attackStyles=m}exists(){return this.key!==""}}class _f extends Jt{constructor(t="clotharmor",e="Cloth Armor",n=-1,r={}){super(t,e,n,r)}update(t="clotharmor",e="Cloth Armor",n=-1,r={},a,d,u){super.update(t,e,n,r,a,d,u)}}class bf extends Jt{}class yf extends Jt{}class kf extends Jt{}class vf extends Jt{}class Sf extends Jt{}class xf extends Jt{}class Ef extends Jt{}class Rl extends Qt{constructor(e,n){super(e,xe.Player,n);l(this,"rank",$e.None);l(this,"wanted",!1);l(this,"serverId",-1);l(this,"pvpKills",-1);l(this,"pvpDeaths",-1);l(this,"moveLeft",!1);l(this,"moveRight",!1);l(this,"moveUp",!1);l(this,"moveDown",!1);l(this,"poison",!1);l(this,"disableAction",!1);l(this,"medal",Ye.None);l(this,"guild");l(this,"hitPoints",0);l(this,"maxHitPoints",0);l(this,"mana",0);l(this,"maxMana",0);l(this,"equipments",{[le.Armour]:new _f,[le.ArmourSkin]:new bf,[le.Boots]:new yf,[le.Pendant]:new kf,[le.Ring]:new vf,[le.Weapon]:new Sf,[le.WeaponSkin]:new xf,[le.Arrows]:new Ef});l(this,"skills",{});l(this,"abilities",{});l(this,"quests",{});l(this,"achievements",{});l(this,"friends",{});l(this,"syncCallback");l(this,"poisonCallback");l(this,"abilityCallback");l(this,"manaCallback")}load(e,n=!1){if(this.instance=e.instance,this.name=e.name,this.level=e.level,this.movementSpeed=e.movementSpeed,this.orientation=e.orientation,this.attackRange=e.attackRange,e.displayInfo&&(this.nameColour=e.displayInfo.colour),this.setRank(e.rank),this.setOrientation(e.orientation),n||this.setGridPosition(e.x,e.y),this.setHitPoints(e.hitPoints,e.maxHitPoints),this.setMana(e.mana,e.maxMana),e.equipments)for(let r of e.equipments)this.equip(r)}loadSkills(e){for(let n of e)this.setSkill(n)}loadQuests(e){for(let[n,r]of e.entries())this.quests[r.key]=new hs(n,r.name,r.description,r.stage,r.stageCount,r.subStage,r.rewards)}loadAchievements(e){for(let n in e){let r=e[n],a=new hs(parseInt(n),r.name,r.description,r.stage,r.stageCount);r.secret&&(a.secret=!0),this.achievements[r.key]=a}}loadAbilities(e){for(let n of e)this.setAbility(n.key,n.level,n.type,n.quickSlot)}loadFriends(e){let n=0;for(let r in e){let a=e[r];this.friends[r]=new po(n,r,a.online,a.serverId),n++}}equip(e){let{type:n,name:r,key:a,count:d,enchantments:u,attackRange:y,attackStats:m,defenseStats:b,bonuses:E,attackStyle:Y,attackStyles:I}=e;if(!a)return this.unequip(n);this.equipments[n].update(a,r,d,u,m,b,E),n===le.Weapon&&(this.attackRange=y||1,this.setAttackStyle(Y,I))}addFriend(e,n,r){this.friends[e]=new po(Object.keys(this.friends).length,e,n,r)}unequip(e,n=-1){n>0?this.equipments[e].count=n:this.equipments[e].update()}sync(){var e;(e=this.syncCallback)==null||e.call(this)}getSpriteName(){return this.equipments[le.ArmourSkin].key?this.equipments[le.ArmourSkin].key:this.equipments[le.Armour].key}getWeaponSpriteName(){return this.equipments[le.WeaponSkin].key?this.equipments[le.WeaponSkin].key:this.equipments[le.Weapon].key}getArmour(){return this.equipments[le.Armour]}getArmourSkin(){return this.equipments[le.ArmourSkin]}getBoots(){return this.equipments[le.Boots]}getArrows(){return this.equipments[le.Arrows]}getPendant(){return this.equipments[le.Pendant]}getRing(){return this.equipments[le.Ring]}getWeapon(){return this.equipments[le.Weapon]}getWeaponSkin(){return this.equipments[le.WeaponSkin]}isAdmin(){return this.rank===$e.Admin||this.rank===$e.HollowAdmin}isModerator(){return this.rank===$e.Moderator}getTotalExperience(){let e=0;for(let n of Object.values(this.skills))e+=n.experience;return e}getMedalKey(){switch(this.medal){case Ye.Silver:return"silvermedal";case Ye.Gold:return"goldmedal";case Ye.Artist:return"crown-artist";case Ye.Tier1:return"crown-tier1";case Ye.Tier2:return"crown-tier2";case Ye.Tier3:return"crown-tier3";case Ye.Tier4:return"crown-tier4";case Ye.Tier5:return"crown-tier5";case Ye.Tier6:return"crown-tier6";case Ye.Tier7:return"crown-tier7";default:return""}}getRankMedal(){switch(this.rank){case $e.Artist:return Ye.Artist;case $e.TierOne:return Ye.Tier1;case $e.TierTwo:return Ye.Tier2;case $e.TierThree:return Ye.Tier3;case $e.TierFour:return Ye.Tier4;case $e.TierFive:return Ye.Tier5;case $e.TierSix:return Ye.Tier6;case $e.TierSeven:return Ye.Tier7;default:return Ye.None}}setMana(e,n){var r;this.mana=e,n&&(this.maxMana=n),(r=this.manaCallback)==null||r.call(this,this.mana,n||this.maxMana)}setSkill({type:e,experience:n,level:r,percentage:a,nextExperience:d}){this.skills[e]||(this.skills[e]=new mf(e)),this.skills[e].update(n,d,r,a)}setQuest(e,n,r){var a;(a=this.quests[e])==null||a.update(n,r)}setAchievement(e,n,r,a){var d;if(!(e in this.achievements)){let u=new hs(Object.keys(this.achievements).length-1,r,a);u.secret=!0,this.achievements[e]=u;return}(d=this.achievements[e])==null||d.update(n,void 0,r,a)}setAbility(e,n,r,a=-1){var d,u;e in this.abilities?(d=this.abilities[e])==null||d.update(n,a):this.abilities[e]=new wf(r,e,n,a),(r===yr.Active||a!==-1)&&((u=this.abilityCallback)==null||u.call(this,e,n,a))}setPoison(e){var n;this.poison=e,(n=this.poisonCallback)==null||n.call(this,e)}setFriendStatus(e,n,r){this.friends[e].online=n,this.friends[e].serverId=r}setAttackStyle(e,n){this.getWeapon().attackStyle=e,n&&(this.getWeapon().attackStyles=n)}setRank(e){this.rank=e,this.medal=this.getRankMedal()}setGuild(e){if(!e){this.guild=void 0;return}this.guild={name:e.name,members:e.members}}toggleAbility(e){var n;(n=this.abilities[e])==null||n.toggle()}isRanged(){return this.attackRange>1}isMagic(){return this.getWeapon().bonuses.magic>0&&this.isRanged()}hasWeapon(){return this.equipments[le.Weapon].exists()}hasMedal(){return this.medal!==Ye.None}hasKeyboardMovement(){return this.moveLeft||this.moveRight||this.moveUp||this.moveDown}hasFriend(e){return e.toLowerCase()in this.friends}onPoison(e){this.poisonCallback=e}onSync(e){this.syncCallback=e}onAbility(e){this.abilityCallback=e}onMana(e){this.manaCallback=e}}class Tf extends Rn{constructor(t){super(t,xe.Chest)}idle(){this.setAnimation("idle_down",150)}}class mo extends Rn{constructor(e,n=1,r={}){super(e,xe.Item);l(this,"dropped",!1);l(this,"originalY",-1);this.count=n,this.enchantments=r}setAnimation(e,n,r,a){var d;super.setAnimation(e,n,r,a),!(this.animation.length>1)&&(this.originalY=this.sprite.offsetY,(d=this.animation)==null||d.onBop(u=>{this.sprite.offsetY=this.originalY-u}))}idle(){this.setAnimation("idle",150)}hasShadow(){return!0}}class Nl extends Rn{constructor(e,n){super(e,xe.Projectile);l(this,"type",xe.Projectile);l(this,"speed",150);l(this,"fadingDuration",100);l(this,"target");this.owner=n}idle(){this.setAnimation("travel")}impact(){var e;(e=this.impactCallback)==null||e.call(this)}setStart(e,n){this.setGridPosition(Math.floor(e/q.tileSize),Math.floor(n/q.tileSize))}setTarget(e){this.target=e,this.updateAngle()}getAnimationSpeed(){return this.sprite.idleSpeed}getTimeDiff(){return(Date.now()-this.lastUpdate)/1e3}getImpactEffect(){switch(this.sprite.key){case"projectile-boulder":return _e.Boulder;case"projectile-poisonball":return _e.Poisonball;case"projectile-fireball":case"projectile-gift6":return _e.Fireball;case"projectile-iceball":return _e.Iceball;case"projectile-terror":return _e.Terror}return _e.None}updateAngle(){this.target&&(this.angle=Math.atan2(this.target.y-this.y,this.target.x-this.x)*(180/Math.PI)-90)}getAngle(){return this.angle*Math.PI/180}onImpact(e){this.impactCallback=e}}class Cf{constructor(t){l(this,"renderingGrid",[]);this.map=t,this.load()}load(){for(let t=0;t<this.map.height;t++){this.renderingGrid[t]=[];for(let e=0;e<this.map.width;e++)this.renderingGrid[t][e]={}}de.debug("Finished generating the rendering grid.")}addToRenderingGrid(t){let{instance:e,gridX:n,gridY:r}=t;this.map.isOutOfBounds(n,r)||(this.renderingGrid[r][n][e]=t)}removeFromRenderingGrid({instance:t,gridX:e,gridY:n}){delete this.renderingGrid[n][e][t]}getEntitiesAround(t,e,n=2){let r=[];for(let a=e-n;a<e+n;a++)for(let d=t-n;d<t+n;d++)this.map.isOutOfBounds(d,a)||(r=[...r,...Object.values(this.renderingGrid[a][d])]);return r}}class If{constructor(t){l(this,"grids");l(this,"sprites");l(this,"entities",{});l(this,"decrepit",[]);this.game=t,this.grids=new Cf(t.map),this.sprites=t.sprites,t.input.loadCursors()}create(t){if(this.isPlayer(t.instance)||t.instance in this.entities)return;let e;switch(t.type){case xe.Chest:{e=this.createChest(t.instance);break}case xe.NPC:{e=this.createNPC(t.instance);break}case xe.Item:{e=this.createItem(t);break}case xe.Mob:{e=this.createMob(t);break}case xe.Projectile:{e=this.createProjectile(t);break}case xe.Player:{e=this.createPlayer(t);break}}if(!e)return de.error(`Failed to create entity ${t.instance}`);let n=this.game.sprites.get(e.isItem()?`items/${t.key}`:t.key);if(!n)return de.error(`Failed to create sprite for entity ${t.key}.`);e.name=t.name,e.setGridPosition(t.x,t.y),e.setSprite(n),e.idle(),this.addEntity(e)}createChest(t){return new Tf(t)}createNPC(t){return new pf(t)}createItem(t){return new mo(t.instance,t.count,t.enchantments)}createMob(t){let e=new gf(t.instance,this.game);return e.setHitPoints(t.hitPoints,t.maxHitPoints),e.attackRange=t.attackRange,e.level=t.level,e.hiddenName=t.hiddenName,e.movementSpeed=t.movementSpeed,e.orientation=t.orientation,t.displayInfo&&(t.displayInfo.colour&&(e.nameColour=t.displayInfo.colour),t.displayInfo.scale&&(e.customScale=t.displayInfo.scale)),e}createProjectile(t){let e=this.get(t.ownerInstance),n=this.get(t.targetInstance);if(!e||!n)return;e.lookAt(n);let r=new Nl(t.instance,e);return r.name=t.name,r.setStart(e.x,e.y),r.setTarget(n),r.angled=!0,r.type=t.type,r.onImpact(()=>{let a=r.getImpactEffect();a!==_e.None&&n.addEffect(a),this.game.info.create(Ne.Normal,t.damage,n.x,n.y,this.isPlayer(n.instance)),n.triggerHealthBar(),this.unregisterPosition(r),delete this.entities[r.instance]}),e.performAction(e.orientation,st.Attack),e.triggerHealthBar(),r}createPlayer(t){let e=new Rl(t.instance,this.game);return e.load(t),e.setSprite(this.game.sprites.get(e.getSpriteName())),e.ready=!0,e}isPlayer(t){return this.game.player.instance===t}get(t){return this.entities[t]}addEntity(t){this.entities[t.instance]=t,this.registerPosition(t),t instanceof mo&&t.dropped||t.fadeIn(this.game.time)}removeEntity(t){t.isPlayer()&&(t.ready=!1),this.unregisterPosition(t),delete this.entities[t.instance]}removeItem(t){this.unregisterPosition(t),delete this.entities[t.instance]}removeChest(t){t.setSprite(this.game.sprites.getDeath()),t.animateDeath(()=>{this.unregisterPosition(t),delete this.entities[t.instance]})}removeNPC(t){t.setSprite(this.game.sprites.getDeath()),t.animateDeath(()=>{this.unregisterPosition(t),delete this.entities[t.instance]})}registerPosition(t){this.grids.addToRenderingGrid(t)}unregisterPosition(t){this.grids.removeFromRenderingGrid(t)}clean(){if(this.decrepit.length!==0)for(let t of this.decrepit)t&&this.removeEntity(t)}cleanDisplayInfo(){for(let t of Object.values(this.entities))t.nameColour="",t.customScale=0}clearPlayers(t){for(let e of Object.values(this.entities))e.isPlayer()&&e.instance!==t.instance&&this.removeEntity(e)}getAll(){return this.entities}forEachEntity(t){for(let e of Object.values(this.entities))t(e)}}class Yf{constructor(t,e,n,r,a,d=!1,u=-1){l(this,"opacity",1);l(this,"text");l(this,"prefix");l(this,"suffix");l(this,"lastTime");l(this,"speed");l(this,"updateY");l(this,"duration");l(this,"colour");l(this,"fill");l(this,"stroke");l(this,"destroyCallback");this.id=t,this.type=e,this.value=n,this.x=r,this.y=a,this.text=`${n}`,this.prefix="",this.suffix="",this.lastTime=0,this.speed=100,this.updateY=this.isHeal()?2:1,this.duration=this.isHeal()?400:1e3,this.colour=nf[e],u>-1&&(this.colour=rf[u]),this.fill=this.colour.fill,this.stroke=this.colour.stroke,d&&this.hasInflicted()&&(this.fill=this.colour.inflicted.fill,this.stroke=this.colour.inflicted.stroke),this.isDamage()&&n<1&&(this.text="MISS"),(this.isPoison()||this.isFreezing())&&(this.prefix="--"),this.isPoints()&&(this.prefix="++"),this.isExperience()&&(this.prefix="+",this.suffix="EXP")}update(t){var e;t-this.lastTime>this.speed&&(this.y-=this.updateY,this.lastTime=t,this.opacity-=70/this.duration,this.opacity<0&&((e=this.destroyCallback)==null||e.call(this,this.id)))}getText(){return`${this.prefix}${this.text} ${this.suffix}`}isHeal(){return this.type===Ne.Heal}isPoison(){return this.type===Ne.Poison}isFreezing(){return this.type===Ne.Freezing}isExperience(){return this.type===Ne.Experience||this.type===Ne.Profession}isPoints(){return this.type===Ne.Heal||this.type===Ne.Mana}isDamage(){return this.type===Ne.Normal||this.type===Ne.Stun||this.type===Ne.Critical}hasInflicted(){return this.colour.inflicted!==void 0}onDestroy(t){this.destroyCallback=t}}class Xf{constructor(){l(this,"infos",{})}create(t,e,n,r,a=!1,d=-1,u=!1){u&&(n+=q.randomInt(-16,16),r+=q.randomInt(-10,10));let y=q.createId(Date.now(),n,r);this.addInfo(new Yf(y,t,e,n,r,a,d))}addInfo(t){this.infos[t.id]=t,t.onDestroy(e=>delete this.infos[e])}isEmpty(){return Object.keys(this.infos).length===0}update(t){this.forEachInfo(e=>e.update(t))}forEachInfo(t){for(let e of Object.values(this.infos))t(e)}}class Lf{constructor(t){l(this,"chatBox",document.querySelector("#chat"));l(this,"log",document.querySelector("#chat-log"));l(this,"input",document.querySelector("#chat-input"));l(this,"button",document.querySelector("#chat-button"));l(this,"fadingDuration",5e3);l(this,"fadingTimeout");this.game=t,this.button.addEventListener("click",()=>this.toggle()),this.input.addEventListener("blur",()=>this.hide())}keyDown(t){if(t==="Enter"&&this.input.value!=="")return this.send();(t==="Escape"||t==="Enter")&&this.toggle()}privateMessage(t){this.inputVisible()||(this.toggle(),this.input.value=`/pm *${t}* `,this.input.focus())}add(t,e,n="",r=!1){let a=this.createElement(t,e);a.style.color=n||"white",r&&(a.style.fontWeight="bold"),this.log.append(a),this.log.scrollTop=this.log.scrollHeight,this.displayChatBox(),this.hideChatBox()}createElement(t,e){let n=document.createElement("p");return n.innerHTML=`${t} » ${e}`,n}send(){this.game.socket.send(B.Chat,[this.input.value]),this.hide()}toggle(){this.clearTimeout(),this.inputVisible()?this.hide():this.display()}display(){this.button.classList.add("active"),this.inputVisible()?this.input.style.display="block":q.fadeIn(this.input),this.displayChatBox(),this.input.focus(),this.input.value="",this.log.scrollTop=this.log.scrollHeight,q.fadeIn(this.input)}displayChatBox(){q.fadeIn(this.chatBox)}hide(){this.button.classList.remove("active"),this.hideChatBox(),this.input.blur(),this.input.value="",this.log.scrollTop=this.log.scrollHeight,q.fadeOut(this.input)}hideChatBox(){this.clearTimeout(),this.fadingTimeout=window.setTimeout(()=>{this.inputVisible()||q.fadeOut(this.chatBox)},this.fadingDuration)}inputVisible(){return this.input.style.display==="block"}clear(){this.inputVisible()&&this.toggle(),this.clearTimeout()}clearTimeout(){clearTimeout(this.fadingTimeout),window.clearTimeout(this.fadingTimeout),this.fadingTimeout=void 0}}class Af{constructor(t){l(this,"hovering");l(this,"attackInfo",_t("#attack-info"));l(this,"name");l(this,"details");l(this,"health");l(this,"updateCallback");this.input=t,this.name=this.attackInfo.find(".name"),this.details=this.attackInfo.find(".details"),this.health=this.attackInfo.find(".health"),this.onUpdate(this.handleUpdate.bind(this))}update(t){let{name:e,health:n,details:r}=this;if(!t||!this.validEntity(t))return this.hovering=void 0,this.hide();this.isVisible()||this.display(),this.hovering=t,e.html(t.name),this.hasHealth()?this.setHealth(t.hitPoints):(n.hide(),r.html(""))}handleUpdate(t,e){this.hasHealth()&&this.hovering.instance===t&&(e<1?this.hide():this.setHealth(e))}setHealth(t){if(!this.hasHealth())return;this.health.show();let{maxHitPoints:e}=this.hovering;this.health.css("width",`${Math.ceil(t/e*100)-10}%`),this.details.html(`${t} / ${e}`)}validEntity(t){return t.instance!==this.input.player.instance&&!t.isProjectile()}hasHealth(){return this.hovering?this.hovering.isMob()||this.hovering.isPlayer():!1}display(){this.attackInfo.fadeIn("fast")}hide(){this.attackInfo.fadeOut("fast")}isVisible(){return this.attackInfo.css("display")==="block"}onUpdate(t){this.updateCallback=t}}class Df{constructor(t){l(this,"app");l(this,"map");l(this,"camera");l(this,"player");l(this,"friends");l(this,"interact");l(this,"inventory");l(this,"trade");l(this,"leaderboards");l(this,"LeaderboardsFooter");l(this,"guilds");l(this,"selectedCellVisible",!1);l(this,"keyMovement",!1);l(this,"targetVisible",!0);l(this,"selectedX",-1);l(this,"selectedY",-1);l(this,"cursor");l(this,"targetColour","rgba(255, 255, 255, 0.5)");l(this,"cursors",{});l(this,"lastMousePosition",{x:0,y:0});l(this,"hovering");l(this,"mouse",{x:0,y:0});l(this,"targetAnimation",new je("move",4,0,16,16));l(this,"chatHandler");l(this,"hud");l(this,"entity");l(this,"interactEntity");this.game=t,this.app=t.app,this.map=t.map,this.camera=t.camera,this.player=t.player,this.friends=t.menu.getFriends(),this.inventory=t.menu.getInventory(),this.interact=t.menu.getInteract(),this.trade=t.menu.getTrade(),this.leaderboards=t.menu.getLeaderboards(),this.LeaderboardsFooter=t.menu.getLeaderboards2(),this.guilds=t.menu.getGuilds(),this.chatHandler=new Lf(t),this.hud=new Af(this),this.app.onLeftClick(this.handleLeftClick.bind(this)),this.app.onRightClick(this.handleRightClick.bind(this)),this.app.onKeyDown(this.handleKeyDown.bind(this)),this.app.onKeyUp(this.handleKeyUp.bind(this)),this.app.onMouseMove(e=>{this.game.started&&(this.setCoords(e),this.moveCursor())}),this.interact.onButton(this.handleInteract.bind(this)),this.interact.onClose(()=>this.interactEntity=void 0),this.friends.onMessage(e=>this.chatHandler.privateMessage(e)),this.targetAnimation.setSpeed(150)}loadCursors(){this.cursors.hand=this.game.sprites.get("hand"),this.cursors.sword=this.game.sprites.get("sword"),this.cursors.loot=this.game.sprites.get("loot"),this.cursors.target=this.game.sprites.get("target"),this.cursors.arrow=this.game.sprites.get("arrow"),this.cursors.talk=this.game.sprites.get("talk"),this.cursors.spell=this.game.sprites.get("spell"),this.cursors.bow=this.game.sprites.get("bow"),this.cursors.axe=this.game.sprites.get("axe_cursor"),this.cursors.pickaxe=this.game.sprites.get("pickaxe_cursor"),this.cursors.cooking=this.game.sprites.get("cooking"),this.cursors.fishing=this.game.sprites.get("fishing"),this.cursors.smithing=this.game.sprites.get("smithing"),this.cursors.crafting=this.game.sprites.get("crafting"),this.cursors.foraging=this.game.sprites.get("foraging"),de.debug("Loaded Cursors!")}handleLeftClick(t){if(this.setCoords(t),this.keyMovement=!1,this.player.disableAction=!1,this.isCtrlKey())return this.game.socket.send(B.Command,[Il.CtrlClick,this.getCoords()]);this.move(this.getCoords())}handleRightClick(t){this.setCoords(t);let e=this.getCoords(),n=this.game.searchForEntityAt(e);if(!n||n.instance===this.player.instance)return this.interact.hide();this.interact.show(this.mouse,n,this.game.pvp),this.interactEntity=n}handleKeyDown(t){if(this.guilds.isVisible())return this.guilds.keyDown(t.key);if(this.leaderboards.isVisible())return this.leaderboards.keyDown(t.key);if(this.LeaderboardsFooter.isVisible())return this.LeaderboardsFooter.keyDown(t.key);if(this.trade.isInputDialogueVisible())return this.trade.keyDown(t.key);if(this.inventory.isDropDialogVisible())return this.inventory.keyDown(t.key);if(this.friends.isPopupActive())return this.friends.keyDown(t.key);if(this.chatHandler.inputVisible())return this.chatHandler.keyDown(t.key);let e;switch(t.key){case"w":case"ц":case"ArrowUp":{this.player.moveUp=!0;return}case"a":case"ф":case"ArrowLeft":{this.player.moveLeft=!0;return}case"s":case"ы":case"ArrowDown":{this.player.moveDown=!0;return}case"d":case"в":case"ArrowRight":{this.player.moveRight=!0;return}case"Enter":{this.chatHandler.toggle();return}case"i":{this.game.menu.getInventory().toggle();return}case"m":{this.game.menu.getWarp().toggle();return}case"p":{this.game.menu.getProfile().toggle();return}case"h":{this.game.menu.getInventory().selectEdible();break}case"t":{if(e=this.game.entities.get(this.player.lastTarget),!e)return;this.setAttackTarget(),this.setPosition(e.gridX,e.gridY),this.player.follow(e);return}case"Escape":{this.game.menu.hide(),this.player.moving&&this.player.stop();return}case"+":case"=":return this.game.zoom(.2);case"-":case"_":return this.game.zoom(-.2);case"0":case")":return this.camera.setZoom(),this.game.zoom(0)}}handleKeyUp(t){switch(t.key){case"w":case"ArrowUp":{this.player.moveUp=!1;break}case"a":case"ArrowLeft":{this.player.moveLeft=!1;break}case"s":case"ArrowDown":{this.player.moveDown=!1;break}case"d":case"ArrowRight":{this.player.moveRight=!1;break}}this.player.disableAction=!1}handleInteract(t){if(this.interactEntity){switch(t){case ke.Attack:return this.move({x:this.interactEntity.x,y:this.interactEntity.y,gridX:this.interactEntity.gridX,gridY:this.interactEntity.gridY});case ke.Trade:{this.game.player.trade(this.interactEntity);break}case ke.Follow:{this.interactEntity instanceof Qt&&this.game.player.pursue(this.interactEntity);break}case ke.Examine:{this.game.socket.send(B.Examine,[this.interactEntity.instance]);break}case ke.AddFriend:{this.game.socket.send(B.Friends,{opcode:wt.Add,username:this.interactEntity.name});break}}this.interact.hide()}}keyMove(t){this.player.hasPath()||(this.keyMovement=!0,this.move(t))}move(t,e=!this.keyMovement){if(!(this.player.stunned||this.player.teleporting)&&(this.setPassiveTarget(),!(this.player.disableAction||this.game.zoning.direction)&&!this.game.map.isOutOfBounds(t.gridX,t.gridY))){if(yi()&&this.chatHandler.inputVisible()&&this.chatHandler.toggle(),this.game.menu.hide(),this.game.map.isObject(t.gridX,t.gridY))return this.player.setObjectTarget(t);if(this.player.removeTarget(),this.entity=this.getEntity(t,e),this.entity&&this.entity.instance!==this.player.instance&&(this.setAttackTarget(),this.isTargetable(this.entity))){this.player.follow(this.entity),this.isAttackable(this.entity)&&this.entity.addAttacker(this.player),this.player.isRanged()&&this.game.socket.send(B.Target,[di.Attack,this.entity.instance]);return}this.player.go(t.gridX,t.gridY)}}moveCursor(){if(yi())return;let t=this.getCoords(),e=this.game.searchForEntityAt(t);if((e==null?void 0:e.instance)!==this.player.instance){if(this.entity=this.getEntity(t),this.hud.update(this.entity),!this.entity){if(this.map.isObject(t.gridX,t.gridY)){let n=this.map.getTileCursor(t.gridX,t.gridY);this.setCursor(this.cursors[n||"talk"]),this.hovering=Oi.Object;return}this.setCursor(this.cursors.hand),this.hovering=null;return}switch(this.entity.updateSilhouette(!0),this.entity.type){case xe.Item:case xe.Chest:{this.setCursor(this.cursors.loot),this.hovering=Oi.Item;break}case xe.Mob:{this.setCursor(this.getAttackCursor()),this.hovering=Oi.Mob;break}case xe.NPC:{this.setCursor(this.cursors.talk),this.hovering=Oi.NPC;break}case xe.Player:{this.game.pvp&&(this.setCursor(this.getAttackCursor()),this.hovering=Oi.Player);break}}}}getEntity(t,e=!0){let n=e?this.game.searchForEntityAt(t):this.game.getEntityAt(t.gridX,t.gridY);return this.entity&&(!n||n.instance!==this.entity.instance)&&this.entity.updateSilhouette(!1),n}saveMouse(){this.lastMousePosition.x=this.mouse.x,this.lastMousePosition.y=this.mouse.y}setPosition(t,e){this.selectedX=t,this.selectedY=e}setCursor(t){t&&(this.cursor=t)}setPassiveTarget(){this.targetAnimation.setRow(0)}setAttackTarget(){this.targetAnimation.setRow(1)}setCoords(t){let{width:e,height:n}=this.game.renderer.background;this.mouse.x=t.x,this.mouse.y=t.y,this.mouse.x>=e?this.mouse.x=e-1:this.mouse.x<=0&&(this.mouse.x=0),this.mouse.y>=n?this.mouse.y=n-1:this.mouse.y<=0&&(this.mouse.y=0)}getAttackCursor(){return this.player.isMagic()?this.cursors.spell:this.player.isRanged()?this.cursors.bow:this.cursors.sword}getCoords(){let t=this.mouse.x%this.camera.zoomFactor,e=this.mouse.y%this.camera.zoomFactor,n=(this.mouse.x-t)/this.camera.zoomFactor+this.camera.x,r=(this.mouse.y-e)/this.camera.zoomFactor+this.camera.y,a=Math.floor(n/this.map.tileSize),d=Math.floor(r/this.map.tileSize);return{x:n,y:r,gridX:a,gridY:d}}getTargetData(){let t=this.game.sprites.get("target");if(!t)return;let{frame:e}=this.targetAnimation,{tileSize:n}=this.game.map,{zoomFactor:r}=this.game.camera;return t.loaded||t.load(),{sprite:t,x:e.x,y:e.y,width:t.width,height:t.height,dx:this.selectedX*n*r,dy:this.selectedY*n*r,dw:t.width*r,dh:t.height*r}}isCtrlKey(){return window.event.ctrlKey}isTargetable(t){return this.isAttackable(t)||t.isNPC()||t.isChest()}isAttackable(t){return t.isMob()||t.isPlayer()&&this.game.pvp}isMouseRendered(){return this.mouse.x===this.lastMousePosition.x&&this.mouse.y===this.lastMousePosition.y}}class Xe{constructor(t,e,n){l(this,"hideOnShow",!0);l(this,"container");l(this,"close");l(this,"button");l(this,"showCallback");var r,a;this.containerName=t,this.closeButton=e,this.toggleButton=n,this.container=document.querySelector(this.containerName),this.close=document.querySelector(this.closeButton),this.button=document.querySelector(this.toggleButton),(r=this.close)==null||r.addEventListener("click",this.hide.bind(this)),(a=this.button)==null||a.addEventListener("click",this.toggle.bind(this))}batch(t){de.debug("Unimplemented menu batch() function.")}synchronize(t){}add(t,e,n,r){de.debug("Unimplemented menu add() function.")}remove(t,e){de.debug("Unimplemented menu remove() function.")}show(t,e,n,r,a,d){var u,y;(u=this.showCallback)==null||u.call(this),(y=this.button)==null||y.classList.add("active"),q.fadeIn(this.container)}hide(){var t;(t=this.button)==null||t.classList.remove("active"),q.fadeOut(this.container)}toggle(){this.isVisible()?this.hide():this.show()}resize(){}isVisible(){return this.container.style.display==="block"}onShow(t){this.showCallback=t}}class Rf extends Xe{constructor(){super("#action-container");l(this,"page",document.querySelector("#action-page"));l(this,"list",document.querySelector("#action-page > ul"));l(this,"name",document.querySelector("#action-page > .action-item-name"));l(this,"description",document.querySelector("#action-page > .action-item-description"));l(this,"dropDialog",document.querySelector("#action-drop"));l(this,"dropCount",document.querySelector("#action-drop .dialog-count"));l(this,"dropAccept",document.querySelector("#action-drop .dialog-accept"));l(this,"dropCancel",document.querySelector("#action-drop .dialog-cancel"));l(this,"buttonCallback");l(this,"dropCallback");this.dropCancel.addEventListener("click",this.hideDropDialog.bind(this)),this.dropAccept.addEventListener("click",this.handleDrop.bind(this))}handleDrop(){var n;let e=this.dropCount.valueAsNumber;this.dropCount.value="",this.hideDropDialog(),this.hide(),(n=this.dropCallback)==null||n.call(this,e)}show(e,n,r,a,d,u,y=""){this.clear();for(let m of e)this.add(m);if(this.name.innerHTML=n,y)this.description.innerHTML=y;else{this.description.innerHTML="";let m=document.createElement("div"),b=document.createElement("div"),E=document.createElement("div"),Y=document.createElement("div");if(m.id="action-description-attack",b.id="action-description-defense",E.id="action-description-bonuses",Y.id="action-description-enchantments",m.innerHTML=`<u>Attack Stats:</u> <br>
                Crush: ${r.crush} <br>
                Slash: ${r.slash} <br>
                Stab: ${r.stab} <br>
                Archery: ${r.archery} <br>
                Magic: ${r.magic} <br>`,b.innerHTML=`<u>Defense Stats:</u> <br>
                Crush: ${a.crush} <br>
                Slash: ${a.slash} <br>
                Stab: ${a.stab} <br>
                Archery: ${a.archery} <br>
                Magic: ${a.magic} <br>`,E.innerHTML=`<u>Bonuses:</u> <br>
                Accuracy: ${d.accuracy} <br>
                Strength: ${d.strength} <br>
                Archery: ${d.archery} <br>
                Magic: ${d.magic} <br>`,Object.keys(u).length>0){Y.innerHTML="<u>Enchantments:</u> <br>";for(let I in u){let A=Xl[I];Y.innerHTML+=`${A}: ${u[I].level} <br>`}}this.description.append(m,b,E,Y)}super.show()}hide(){super.hide(),this.hideDropDialog()}add(e){let n=document.querySelector(`.action-${e}`);n||(n=document.createElement("li"),n.classList.add("action-button",`action-${e}`),this.list.append(n)),n.addEventListener("click",r=>{var a;r.preventDefault(),(a=this.buttonCallback)==null||a.call(this,e)})}showDropDialog(){q.fadeIn(this.dropDialog),q.fadeOut(this.description),this.page.classList.add("dimmed"),this.dropCount.value="1",this.dropCount.focus()}hideDropDialog(){q.fadeOut(this.dropDialog),q.fadeIn(this.description),this.page.classList.remove("dimmed")}clear(){this.list.innerHTML=""}onButton(e){this.buttonCallback=e}onDrop(e){this.dropCallback=e}}class Nf extends Xe{constructor(e){super("#inventory",void 0,"#inventory-button");l(this,"list",document.querySelector("#inventory-container > ul"));l(this,"selectedSlot",-1);l(this,"selectCallback");l(this,"batchCallback");this.actions=e,this.load(),this.actions.onButton(n=>this.handleAction(n)),this.actions.onDrop(n=>this.handleDrop(n))}load(){if(!this.list)return de.error("Could not create the skeleton for the inventory.");for(let e=0;e<kt.INVENTORY_SIZE;e++)this.list.append(this.createSlot(e))}keyDown(e){switch(e){case"Escape":return this.actions.hideDropDialog();case"Enter":return this.actions.handleDrop()}}handleAction(e){var n;if(e===ke.DropMany)return this.actions.showDropDialog();(n=this.selectCallback)==null||n.call(this,q.getContainerAction(e),this.selectedSlot,1),this.actions.hide()}handleDrop(e){var n;return(n=this.selectCallback)==null?void 0:n.call(this,It.Remove,this.selectedSlot,e)}batch(e){var n;for(let r of e)r.key&&this.setSlot(r);(n=this.batchCallback)==null||n.call(this)}add(e){this.setSlot(e)}remove(e){this.setSlot(e)}select(e,n=!1){let r=this.getElement(e);if(this.isEmpty(r))return this.actions.hide();if(this.selectedSlot=e,n){r.edible?this.handleAction(ke.Eat):(r.equippable||r.interactable)&&this.handleAction(ke.Equip),this.actions.hide();return}let a=[];r.edible&&a.push(ke.Eat),r.interactable&&a.push(ke.Eat2),r.equippable&&a.push(ke.Equip),a.push(ke.DropOne),r.count>1&&a.push(ke.DropMany),this.actions.show(a,r.name,r.attackStats,r.defenseStats,r.bonuses,r.enchantments,r.description)}selectEdible(){let e=this.getFirstEdible();e!==-1&&(this.selectedSlot=e,this.handleAction(ke.Eat))}swap(e,n){var r;(r=this.selectCallback)==null||r.call(this,It.Swap,e,n),this.selectedSlot=-1}setSlot(e){let n=this.getElement(e.index);if(!n)return de.error(`Could not find slot element at: ${e.index}`);let r=n.querySelector(".item-image"),a=n.querySelector(".item-count");if(!r)return de.error(`Could not find image element at: ${e.index}`);a&&(a.textContent=q.getCount(e.count)),r.style.backgroundImage=e.key?q.getImageURL(e.key):"",n.dataset.key=e.key,n.dataset.count=`${e.count}`,n.edible=e.edible,n.interactable=e.interactable,n.equippable=e.equippable,n.name=e.name,n.count=e.count,n.description=this.formatDescription(e.name,e.count,e.description),n.attackStats=e.attackStats,n.defenseStats=e.defenseStats,n.bonuses=e.bonuses,n.enchantments=e.enchantments}createSlot(e){let n=document.createElement("li"),r=document.createElement("div"),a=document.createElement("div"),d=document.createElement("div");return r.dataset.index=`${e}`,r.classList.add("item-slot"),a.classList.add("item-image"),d.classList.add("item-count"),r.append(a),r.append(d),n.append(r),n.addEventListener("click",()=>this.select(e)),n.addEventListener("dblclick",()=>this.select(e,!0)),Al(r,this.handleHold.bind(this),()=>this.isEmpty(this.getElement(e))),n}handleHold(e,n){var d,u;let r=(d=e==null?void 0:e.dataset)==null?void 0:d.index,a=(u=n==null?void 0:n.dataset)==null?void 0:u.index;!r||!a||this.swap(parseInt(r),parseInt(a))}hide(){super.hide(),this.selectedSlot=-1,this.actions.hide()}formatDescription(e,n,r){return n<1e3?r:`${r} You have a stack of ${n.toLocaleString("en-US")} ${e.toLowerCase()}. `}isEmpty(e){let n=e.querySelector(".item-image");return!n||n.style.backgroundImage===""}isDropDialogVisible(){return this.actions.dropDialog.style.display==="block"}getElement(e){return this.list.children[e].querySelector("div")}getCount(e){var n;return((n=this.getElement(e))==null?void 0:n.count)||0}getFirstEdible(){for(let e=0;e<this.list.children.length;e++)if(this.getElement(e).edible)return e;return-1}forEachSlot(e){for(let n=0;n<this.list.children.length;n++)e(n,this.getElement(n))}onSelect(e){this.selectCallback=e}onBatch(e){this.batchCallback=e}}class Mf extends Xe{constructor(e){super("#bank","#close-bank");l(this,"bankList",document.querySelector("#bank-slot > ul"));l(this,"inventoryList",document.querySelector("#bank-inventory-slots > ul"));l(this,"selectCallback");this.inventory=e,this.load()}load(){if(!this.bankList)return de.error("[Bank] Could not find the bank slot list.");if(!this.inventoryList)return de.error("[Bank] Could not find the inventory slot list.");for(let e=0;e<kt.BANK_SIZE;e++){let n=this.draggableSlot(e,qe.Bank,qe.Inventory);this.bankList.append(n)}for(let e=0;e<kt.INVENTORY_SIZE;e++){let n=this.draggableSlot(e,qe.Inventory,qe.Bank);this.inventoryList.append(n)}this.inventory.onBatch(this.synchronize.bind(this))}draggableSlot(e,n,r){let a=q.createSlot(n,e,()=>this.select(n,e,r)),d=a.querySelector(".item-slot");return Al(d,this.handleHold.bind(this),()=>this.inventory.isEmpty(this.getElement(e,n))),a}handleHold(e,n){var y,m,b,E;let r=(y=e==null?void 0:e.dataset)==null?void 0:y.type,a=(m=e==null?void 0:e.dataset)==null?void 0:m.index,d=(b=n==null?void 0:n.dataset)==null?void 0:b.type,u=(E=n==null?void 0:n.dataset)==null?void 0:E.index;!r||!a||!d||!u||this.select(parseInt(r),parseInt(a),parseInt(d),parseInt(u))}select(e,n,r,a){var d;(d=this.selectCallback)==null||d.call(this,e,n,r,a)}setSlot(e){let n=this.getBankElement(e.index).querySelector(".item-image"),r=this.getBankElement(e.index).querySelector(".item-count");n.style.backgroundImage=q.getImageURL(e.key),r.textContent=q.getCount(e.count)}synchronize(){this.isVisible()&&this.inventory.forEachSlot((e,n)=>{let r=this.getInventoryElement(e),a=r.querySelector(".item-image"),d=r.querySelector(".item-count"),u=n.querySelector(".item-image");u&&(a.style.backgroundImage=u.style.backgroundImage,d.textContent=n.textContent)})}batch(e){for(let n of e)n.key&&this.setSlot(n)}add(e){this.setSlot(e)}remove(e){this.setSlot(e)}show(e){super.show(),this.synchronize();for(let n of e)this.setSlot(n)}hide(){super.hide()}getElement(e,n){return n===qe.Bank?this.getBankElement(e):this.getInventoryElement(e)}getBankElement(e){return this.bankList.children[e].querySelector("div")}getInventoryElement(e){return this.inventoryList.children[e].querySelector("div")}onSelect(e){this.selectCallback=e}}class Pf extends Xe{constructor(e){super("#store","#close-store");l(this,"key","");l(this,"currency","gold");l(this,"selectedIndex",-1);l(this,"selectedCount",-1);l(this,"selectedBuyIndex",-1);l(this,"storeContainer",document.querySelector("#store-container"));l(this,"storeHelp",document.querySelector("#store-help"));l(this,"confirmSell",document.querySelector("#confirm-sell"));l(this,"sellSlot",document.querySelector("#store-sell-slot"));l(this,"sellSlotText",document.querySelector("#store-sell-slot-text"));l(this,"sellSlotReturn",document.querySelector("#store-sell-slot-return"));l(this,"sellSlotReturnText",document.querySelector("#store-sell-slot-return-text"));l(this,"storeList",document.querySelector("#store-container"));l(this,"inventoryList",document.querySelector("#store-inventory-slots"));l(this,"buyDialog",document.querySelector("#store-buy"));l(this,"buyCount",document.querySelector("#store-buy .dialog-count"));l(this,"buyAccept",document.querySelector("#store-buy .dialog-accept"));l(this,"buyCancel",document.querySelector("#store-buy .dialog-cancel"));l(this,"selectCallback");this.inventory=e,this.resize(),this.sellSlot.addEventListener("click",this.synchronize.bind(this)),this.confirmSell.addEventListener("click",this.sell.bind(this)),this.buyCancel.addEventListener("click",this.hideBuyDialog.bind(this)),this.buyAccept.addEventListener("click",this.handleBuy.bind(this));for(let n=0;n<kt.INVENTORY_SIZE;n++)this.inventoryList.append(q.createSlot(qe.Inventory,n,this.select.bind(this)))}resize(){let e=yi()?"Long tap":"Right click";this.storeHelp.textContent=`${e} to buy multiple items.`}update(e){this.clear(),this.key=e.key,this.currency=e.currency;for(let n=0;n<e.items.length;n++)this.storeList.append(this.createStoreItem(e.items[n],n))}select(e,n){var r;(r=this.selectCallback)==null||r.call(this,wi.Select,this.key,n)}sell(){var e;(e=this.selectCallback)==null||e.call(this,wi.Sell,this.key,this.selectedIndex,this.selectedCount)}buy(e,n=1){var r;(r=this.selectCallback)==null||r.call(this,wi.Buy,this.key,e,n)}handleBuy(){this.buy(this.selectedBuyIndex,this.buyCount.valueAsNumber),this.hideBuyDialog()}showBuyDialog(){q.fadeIn(this.buyDialog),this.storeContainer.classList.add("dimmed"),this.buyCount.value="1",this.buyCount.focus()}hideBuyDialog(){q.fadeOut(this.buyDialog),this.storeContainer.classList.remove("dimmed")}synchronize(){this.isVisible()&&(this.clearSellSlot(),this.inventory.forEachSlot((e,n)=>{let r=this.getElement(e).querySelector(".item-image"),a=this.getElement(e).querySelector(".item-count"),d=n.querySelector(".item-image");d&&(r.style.backgroundImage=d.style.backgroundImage,a.textContent=n.textContent)}))}show(e){super.show(),this.update(e),this.synchronize()}clear(){this.key="",this.currency="gold",this.storeList.innerHTML=""}clearSellSlot(){this.selectedIndex=-1,this.selectedCount=-1,this.sellSlot.style.backgroundImage="",this.sellSlotText.textContent="",this.sellSlotReturn.style.backgroundImage="",this.sellSlotReturnText.textContent=""}move(e){if(e.key!==this.key)return de.error("Invalid store key provided for the select.");this.synchronize();let n=this.getElement(e.item.index).querySelector(".item-image"),r=this.getElement(e.item.index).querySelector(".item-count");if(!n||!r)return de.error("[Store] Could not find image and count elements.");this.sellSlot.style.backgroundImage=n.style.backgroundImage,this.sellSlotText.textContent=r.textContent,this.sellSlotReturn.style.backgroundImage=q.getImageURL(this.currency),this.sellSlotReturnText.textContent=e.item.price.toString()||"",n.style.backgroundImage="",r.textContent="",this.selectedIndex=e.item.index,this.selectedCount=e.item.count}createStoreItem(e,n){let r=document.createElement("li"),a=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div"),y=document.createElement("div");return r.classList.add("store-item"),a.classList.add("store-item-image"),d.classList.add("store-item-name","stroke"),u.classList.add("store-item-count","stroke"),y.classList.add("store-item-price","stroke"),e.count!==-1&&(u.textContent=`x${e.count.toString()}`),d.textContent=e.name,y.textContent=`${e.price.toString()}${this.currency[0]}`,a.style.backgroundImage=q.getImageURL(e.key),r.addEventListener("click",()=>this.buy(n)),ra(r,()=>{this.selectedBuyIndex=n,this.showBuyDialog()}),r.append(a,d,u,y),r}getElement(e){return this.inventoryList.children[e].querySelector("div")}onSelect(e){this.selectCallback=e}}class Of{constructor(t){l(this,"health",document.querySelector("#health"));l(this,"healthBar",document.querySelector("#health-bar"));l(this,"mana",document.querySelector("#mana"));l(this,"manaBar",document.querySelector("#mana-bar"));l(this,"healthText",document.querySelector("#health-bar-text"));l(this,"manaText",document.querySelector("#mana-bar-text"));this.player=t,this.player.onHitPoints(this.handleHitPoints.bind(this)),this.player.onMana(this.handleMana.bind(this)),this.player.onPoison(this.handlePoison.bind(this))}handleHitPoints(t,e,n){this.setPoints(this.health,this.healthBar,this.healthText,t,e,n)}handleMana(t,e){this.setPoints(this.mana,this.manaBar,this.manaText,t,e)}handlePoison(t){this.health.style.background=t?"linear-gradient(to right, #046E20, #19B047)":"linear-gradient(to right, #f00, #ef5a5a)"}resize(){this.handleHitPoints(this.player.hitPoints,this.player.maxHitPoints),this.handleMana(this.player.mana,this.player.maxMana)}setPoints(t,e,n,r,a,d){let u=r/a;t.style.width=`${Math.floor(e.offsetWidth*u).toString()}px`,n.textContent=`${r}/${a}`,d&&this.flash(this.player.poison?"poison":"white")}flash(t){this.health.classList.add(t),window.setTimeout(()=>this.health.classList.remove(t),500)}}let Me;function er(i,t){Me!=null||(Me=document.createElement("div"));let e=i.getBoundingClientRect();Me.classList.add("bubble"),Me.textContent=t,document.querySelector("#bubbles").append(Me),Me.style.padding="5px 10px",Me.style.left=`${e.left+e.width/2-Me.offsetWidth/2}px`,Me.style.top=`${e.top-Me.offsetHeight}px`,i.addEventListener("blur",()=>Me.remove()),i.addEventListener("mouseout",()=>Me.remove()),i.addEventListener("mouseleave",()=>Me.remove()),i.addEventListener("touchend",n=>{n.target!==i&&Me.remove()}),i.addEventListener("touchcancel",n=>{n.target!==i&&Me.remove()}),document.addEventListener("touchend",n=>{n.target!==i&&Me.remove()}),document.addEventListener("touchcancel",n=>{n.target!==i&&Me.remove()})}function qf(i,t){i.addEventListener("focus",()=>er(i,t)),i.addEventListener("mouseover",()=>er(i,t)),i.addEventListener("mouseenter",()=>er(i,t)),i.addEventListener("touchstart",()=>er(i,t))}class Bf extends Xe{constructor(e){super("#state-page");l(this,"level",document.querySelector("#profile-level"));l(this,"experience",document.querySelector("#profile-experience"));l(this,"attackStyleList",document.querySelector("#attack-style-list"));l(this,"weapon",document.querySelector("#state-page > .weapon-slot"));l(this,"weaponSkin",document.querySelector("#state-page > .weapon-skin-slot"));l(this,"armour",document.querySelector("#state-page > .armour-slot"));l(this,"armourSkin",document.querySelector("#state-page > .armour-skin-slot"));l(this,"pendant",document.querySelector("#state-page > .pendant-slot"));l(this,"ring",document.querySelector("#state-page > .ring-slot"));l(this,"boots",document.querySelector("#state-page > .boots-slot"));l(this,"arrow",document.querySelector("#state-page > .arrows-slot"));l(this,"unequipCallback");l(this,"styleCallback");this.player=e,this.weapon.addEventListener("click",()=>{var n;return(n=this.unequipCallback)==null?void 0:n.call(this,le.Weapon)}),this.weaponSkin.addEventListener("click",()=>{var n;return(n=this.unequipCallback)==null?void 0:n.call(this,le.WeaponSkin)}),this.armour.addEventListener("click",()=>{var n;return(n=this.unequipCallback)==null?void 0:n.call(this,le.Armour)}),this.armourSkin.addEventListener("click",()=>{var n;return(n=this.unequipCallback)==null?void 0:n.call(this,le.ArmourSkin)}),this.pendant.addEventListener("click",()=>{var n;return(n=this.unequipCallback)==null?void 0:n.call(this,le.Pendant)}),this.ring.addEventListener("click",()=>{var n;return(n=this.unequipCallback)==null?void 0:n.call(this,le.Ring)}),this.boots.addEventListener("click",()=>{var n;return(n=this.unequipCallback)==null?void 0:n.call(this,le.Boots)}),this.arrow.addEventListener("click",()=>{var n;return(n=this.unequipCallback)==null?void 0:n.call(this,le.Arrows)})}synchronize(){this.level.textContent=`Level ${this.player.level}`,this.experience.textContent=`${this.player.getTotalExperience()}`,this.weapon.style.backgroundImage=q.getImageURL(this.player.getWeapon().key),this.weaponSkin.style.backgroundImage=q.getImageURL(this.player.getWeaponSkin().key),this.armour.style.backgroundImage=q.getImageURL(this.player.getArmour().key==="clotharmor"?"":this.player.getArmour().key),this.armourSkin.style.backgroundImage=q.getImageURL(this.player.getArmourSkin().key),this.pendant.style.backgroundImage=q.getImageURL(this.player.getPendant().key),this.ring.style.backgroundImage=q.getImageURL(this.player.getRing().key),this.boots.style.backgroundImage=q.getImageURL(this.player.getBoots().key),this.arrow.style.backgroundImage=q.getImageURL(this.player.getArrows().key),this.loadAttackStyles()}loadAttackStyles(){this.attackStyleList.innerHTML="";for(let e of this.player.getWeapon().attackStyles)this.attackStyleList.append(this.createStyle(e))}createStyle(e){let n=document.createElement("li"),r=document.createElement("div");return n.classList.add("attack-style-box"),qf(n,this.getTooltip(e)),r.classList.add("attack-style",`attack-style-${He[e].toLowerCase()}`),e===this.player.getWeapon().attackStyle&&n.classList.add("active"),n.append(r),n.addEventListener("click",()=>{var a;return(a=this.styleCallback)==null?void 0:a.call(this,e)}),n}getTooltip(e){switch(e){case He.Stab:return"Stab (Accuracy EXP)";case He.Slash:return"Slash (Strength EXP)";case He.Defensive:return"Defensive (Defense EXP)";case He.Crush:return"Crush (Accuracy + Strength EXP)";case He.Shared:return"Shared (Accuracy + Strength + Defense EXP)";case He.Hack:return"Hack (Strength + Defense EXP)";case He.Chop:return"Chop (Accuracy + Defense EXP)";case He.Accurate:return"Accurate (Increased Accuracy)";case He.Fast:return"Fast (Increased Speed)";case He.Focused:return"Focused (Increased Damage)";case He.LongRange:return"Long Range"}return"Report as bug if you see this :)"}onUnequip(e){this.unequipCallback=e}onStyle(e){this.styleCallback=e}}class zf extends Xe{constructor(e){super("#abilities-page");l(this,"activeAbilities",document.querySelector("#active-abilities"));l(this,"passiveAbilities",document.querySelector("#passive-abilities"));l(this,"abilityBar",document.querySelector("#ability-shortcut"));l(this,"draggedElement","");l(this,"selectCallback");this.player=e;for(let n=0;n<this.activeAbilities.children.length;n++)this.activeAbilities.children[n].addEventListener("click",()=>this.handleAction(n));for(let n=0;n<this.abilityBar.children.length;n++){let r=this.abilityBar.children[n];r.draggable=!0,r.addEventListener("dragover",a=>this.dragOver(a)),r.addEventListener("drop",a=>this.dragDrop(a,n))}}synchronize(){this.hideAll();let e=0,n=0;for(let r of Object.values(this.player.abilities))switch(r.type){case yr.Active:{this.setActiveAbility(e,r.key,r.level,r.active),e++;break}case yr.Passive:{this.setPassiveAbility(n,r.key,r.level),n++;break}}}handleAction(e){var r;let n=this.activeAbilities.children[e];n.style.display==="none"||!n.key||(r=this.selectCallback)==null||r.call(this,ci.Use,n.key)}dragStart(e){this.draggedElement=e}dragDrop(e,n){var r;(r=this.selectCallback)==null||r.call(this,ci.QuickSlot,this.draggedElement,n),this.draggedElement=""}dragOver(e){!e.target||!e.target.draggable||e.preventDefault()}dragLeave(e){}setAbility(e,n,r=1,a=!1){e.innerHTML="",e.className="ability",e.style.display="block";let d=document.createElement("div");d.classList.add("ability-icon"),d.classList.add(`ability-icon-${n}`),d.draggable=!0,a||(d.addEventListener("dragleave",u=>this.dragLeave(u)),d.addEventListener("dragstart",()=>this.dragStart(n))),r>4&&(r=4),r<1&&(r=1);for(let u=0;u<r;u++){let y=document.createElement("div");y.classList.add("ability-level"),y.classList.add(`ability-level${u+1}`),e.append(y,d)}}setActiveAbility(e,n,r=1,a=!1){let d=this.activeAbilities.children[e];if(!d)return de.error(`Could not find ability with index ${e}, key: ${n}.`);if(!n)return this.hideAbility(d);this.setAbility(d,n,r),d.key=n;let u=d.querySelector(".ability-icon");u&&(a?u.classList.add("active"):u.classList.remove("active"))}setPassiveAbility(e,n,r=1){let a=this.passiveAbilities.children[e];if(!a)return de.error(`Could not find ability with index ${e}, key: ${n}.`);if(!n)return this.hideAbility(a);this.setAbility(a,n,r,!0)}hideAbility(e){e.style.display="none"}hideAll(){for(let e of this.activeAbilities.children)this.hideAbility(e);for(let e of this.passiveAbilities.children)this.hideAbility(e)}onSelect(e){this.selectCallback=e}}class Ff extends Xe{constructor(e){super("#skills-page");l(this,"list",document.querySelector("#skills-list > ul"));l(this,"info",document.querySelector("#profile-info"));l(this,"selectedSkill");l(this,"loaded",!1);this.player=e}synchronize(e=!1){if(Object.keys(this.player.skills).length!==0){e&&(this.list.innerHTML="");for(let n of na){let r=this.player.skills[n],a=this.get(r.name);a?this.update(a,r):(a=this.createElement(r),this.list.append(a),this.update(a,r))}this.isInfoVisible()&&this.showInfo()}}show(){super.show(),!this.loaded&&(this.loaded=!0,this.synchronize())}hide(){super.hide(),this.hideInfo()}hideInfo(){q.fadeOut(this.info)}createElement(e){let n=document.createElement("li"),r=document.createElement("div"),a=document.createElement("div"),d=document.createElement("div");return n.classList.add("skill"),r.classList.add("skill-level","stroke"),a.classList.add("skill-image",`skill-image-${e.name.toLowerCase()}`),d.classList.add("skill-experience"),n.append(r,d,a),n.name=e.name,n.level=e.level,n.percentage=e.percentage,n.addEventListener("click",()=>this.showInfo(e)),n}showInfo(e=this.selectedSkill){q.fadeIn(this.info);let n=this.info.querySelector(".profile-info-skill-image"),r=this.info.querySelector(".profile-info-title"),a=this.info.querySelector(".profile-info-details");n.className=`profile-info-skill-image skill-image-${e.name.toLowerCase()}`,r.innerHTML=e.name,a.innerHTML=`
            <p><span>Level:</span> ${e.level}</p>
            <br>
            <p><span>Exp:</span> ${e.experience}</p>
            <br>
            <p><span>Next Exp:</span> ${e.nextExperience}</p>
            <br>
            <p><span>Percent:</span> ${(e.percentage*100).toFixed(3)}%</p>
        `,this.selectedSkill=e}update(e,n){let r=e.querySelector(".skill-level"),a=e.querySelector(".skill-experience");r.innerHTML=`${n.level}/${kt.MAX_LEVEL}`,!e.originalWidth&&a.offsetWidth!==0&&(e.originalWidth=a.offsetWidth),e.originalWidth&&(a.style.width=`${e.originalWidth*n.percentage}px`,e.level=n.level,e.percentage=n.percentage)}get(e){for(let n of this.list.children)if(n.name===e)return n}isInfoVisible(){return this.info.style.display==="block"}}class Uf extends Xe{constructor(e){super("#profile-dialog",void 0,"#profile-button");l(this,"state");l(this,"skills");l(this,"abilities");l(this,"pages",[]);l(this,"activePage",0);l(this,"previous",document.querySelector("#profile-navigator > .previous"));l(this,"next",document.querySelector("#profile-navigator > .next"));l(this,"unequipCallback");l(this,"attackStyleCallback");l(this,"abilityCallback");this.player=e,this.state=new Bf(this.player),this.skills=new Ff(this.player),this.abilities=new zf(this.player),this.pages.push(this.state,this.skills,this.abilities),this.update(),this.previous.addEventListener("click",()=>this.handleNavigation("previous")),this.next.addEventListener("click",()=>this.handleNavigation("next")),this.state.onUnequip(n=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,n)}),this.state.onStyle(n=>{var r;return(r=this.attackStyleCallback)==null?void 0:r.call(this,n)}),this.abilities.onSelect((n,r,a)=>{var d;return(d=this.abilityCallback)==null?void 0:d.call(this,n,r,a)})}hide(){super.hide(),this.skills.hideInfo()}handleNavigation(e){var n;this.isDisabled(e)||(this.previous.classList.remove("disabled"),this.next.classList.remove("disabled"),(n=this.pages[this.activePage])==null||n.hide(),this.activePage+=e==="previous"?-1:1,this.update())}update(){var e;this.activePage<=0&&(this.activePage=0,this.previous.classList.add("disabled")),this.activePage>=this.pages.length-1&&(this.activePage=this.pages.length-1,this.next.classList.add("disabled")),(e=this.pages[this.activePage])==null||e.show()}synchronize(){this.forEachPage(e=>e.synchronize())}resize(){this.skills.synchronize(!0)}isDisabled(e){return e==="previous"&&this.previous.classList.contains("disabled")||e==="next"&&this.next.classList.contains("disabled")}forEachPage(e){for(let n of this.pages)e(n)}onUnequip(e){this.unequipCallback=e}onAttackStyle(e){this.attackStyleCallback=e}onAbility(e){this.abilityCallback=e}}class Hf extends Xe{constructor(e){super("#enchant","#close-enchant");l(this,"list",document.querySelector("#enchant-inventory-slots"));l(this,"selectedItem",document.querySelector("#enchant-selected-item"));l(this,"selectedShards",document.querySelector("#enchant-shards"));l(this,"selectedShardsCount",document.querySelector("#shards-count"));l(this,"confirmButton",document.querySelector("#confirm-enchant"));l(this,"selectedSlot",-1);l(this,"selectedShard",-1);l(this,"selectCallback");l(this,"confirmCallback");this.inventory=e,this.selectedItem.addEventListener("click",this.clear.bind(this)),this.selectedShards.addEventListener("click",this.clear.bind(this)),this.confirmButton.addEventListener("click",this.confirm.bind(this));for(let n=0;n<kt.INVENTORY_SIZE;n++)this.list.append(q.createSlot(qe.Inventory,n,this.select.bind(this)))}synchronize(){this.isVisible()&&(this.clearSelections(),this.inventory.forEachSlot((e,n)=>{let r=this.getElement(e).querySelector(".item-image"),a=this.getElement(e).querySelector(".item-count"),d=n.querySelector(".item-image");d&&(r.style.backgroundImage=d.style.backgroundImage,a.textContent=n.textContent)}))}show(){super.show(),this.synchronize()}confirm(){var e;this.selectedSlot===-1||this.selectedShard===-1||(e=this.confirmCallback)==null||e.call(this,this.selectedSlot,this.selectedShard)}select(e,n){var r;(r=this.selectCallback)==null||r.call(this,n)}move(e,n=!1){let r=this.getElement(e).querySelector(".item-image"),a=this.getElement(e).querySelector(".item-count");if(this.selectedSlot!==-1&&!n){let d=this.getElement(this.selectedSlot),u=d.querySelector(".item-image");u.style.backgroundImage=this.selectedItem.style.backgroundImage}if(this.selectedShard!==-1&&n){let d=this.getElement(this.selectedShard),u=d.querySelector(".item-image"),y=d.querySelector(".item-count");u.style.backgroundImage=this.selectedShards.style.backgroundImage,y.textContent=this.selectedShardsCount.textContent}n?this.selectedShard=e:this.selectedSlot=e,(n?this.selectedShards:this.selectedItem).style.backgroundImage=r.style.backgroundImage,n&&(this.selectedShardsCount.textContent=a.textContent),r.style.backgroundImage="",a.textContent=""}clear(){this.clearSelections(),this.synchronize()}clearSelections(){this.selectedSlot=-1,this.selectedShard=-1,this.selectedItem.style.backgroundImage="",this.selectedShards.style.backgroundImage="",this.selectedShardsCount.textContent=""}getElement(e){return this.list.children[e].querySelector("div")}onSelect(e){this.selectCallback=e}onConfirm(e){this.confirmCallback=e}}class $f extends Xe{constructor(e){super("#map-frame","#close-map-frame","#warp-button");l(this,"list",document.querySelectorAll(".map-button"));l(this,"selectCallback");this.socket=e;for(let n of this.list)n.addEventListener("click",()=>this.handleWarp(n))}handleWarp(e){var r;let n=parseInt(e.id.replace("warp",""));if(isNaN(n))return de.error("Invalid warp element clicked.");(r=this.selectCallback)==null||r.call(this,n),this.hide()}onSelect(e){this.selectCallback=e}}class jf extends Xe{constructor(){super("#notification");l(this,"title",document.querySelector("#notification-text-title"));l(this,"description",document.querySelector("#notification-text-description"));l(this,"timeout")}show(e,n,r){if(this.isVisible()){this.hide(!1),window.setTimeout(()=>this.show(e,n,r),700);return}this.container.classList.add("active"),this.setPosition(),this.title.style.color=r,this.title.innerHTML=e,this.description.innerHTML=n,clearTimeout(this.timeout),this.timeout=window.setTimeout(()=>this.hide(!1),7e3)}hide(e=!0){e||(this.container.classList.remove("active"),this.container.style.top="100%")}resize(){this.isVisible()&&this.setPosition()}isVisible(){return this.container.classList.contains("active")}getPosition(){return window.innerHeight-this.container.offsetHeight}setPosition(){this.container.style.top=`${this.getPosition()}px`}}class Gf extends Xe{constructor(e){super("#settings-page",void 0,"#settings-button");l(this,"musicSlider",document.querySelector("#music"));l(this,"soundSlider",document.querySelector("#sound"));l(this,"brightnessSlider",document.querySelector("#brightness"));l(this,"audioEnabledCheckbox",document.querySelector("#audio-enabled-checkbox > input"));l(this,"lowPowerCheckbox",document.querySelector("#low-power-checkbox > input"));l(this,"debugCheckbox",document.querySelector("#debug-mode-checkbox > input"));l(this,"showNamesCheckbox",document.querySelector("#show-names-checkbox > input"));l(this,"showLevelsCheckbox",document.querySelector("#show-levels-checkbox > input"));l(this,"disableCachingCheckbox",document.querySelector("#disable-region-caching-checkbox > input"));this.game=e,this.musicSlider.addEventListener("input",this.handleMusic.bind(this)),this.soundSlider.addEventListener("input",this.handleSoundVolume.bind(this)),this.brightnessSlider.addEventListener("input",this.handleBrightness.bind(this)),this.audioEnabledCheckbox.addEventListener("change",this.handleAudioEnabled.bind(this)),this.lowPowerCheckbox.addEventListener("change",this.handleLowPower.bind(this)),this.debugCheckbox.addEventListener("change",this.handleDebug.bind(this)),this.showNamesCheckbox.addEventListener("change",this.handleName.bind(this)),this.showLevelsCheckbox.addEventListener("change",this.handleLevel.bind(this)),this.disableCachingCheckbox.addEventListener("change",this.handleCaching.bind(this)),this.load()}load(){var n,r,a;let e=this.game.storage.getSettings();this.musicSlider.value=(n=e.musicVolume)==null?void 0:n.toString(),this.soundSlider.value=(r=e.soundVolume)==null?void 0:r.toString(),this.brightnessSlider.value=(a=e.brightness)==null?void 0:a.toString(),this.audioEnabledCheckbox.checked=e.audioEnabled,this.lowPowerCheckbox.checked=e.lowPowerMode,this.debugCheckbox.checked=e.debugMode,this.showNamesCheckbox.checked=e.showNames,this.showLevelsCheckbox.checked=e.showLevels,this.disableCachingCheckbox.checked=e.disableCaching,this.handleBrightness(),this.handleDebug(),this.handleLowPower(),this.handleName(),this.handleLevel()}handleMusic(){this.game.storage.setMusicVolume(this.musicSlider.valueAsNumber),this.game.audio.updateVolume()}handleSoundVolume(){this.game.storage.setSoundVolume(this.soundSlider.valueAsNumber)}handleBrightness(){this.game.storage.setBrightness(this.brightnessSlider.valueAsNumber),this.game.renderer.setBrightness(this.brightnessSlider.valueAsNumber)}handleAudioEnabled(){this.game.storage.setAudioEnabled(this.audioEnabledCheckbox.checked),this.game.audio.updateVolume()}handleLowPower(){this.game.storage.setLowPowerMode(this.lowPowerCheckbox.checked),this.game.renderer.animateTiles=!this.lowPowerCheckbox.checked,this.lowPowerCheckbox.checked?this.game.camera.decenter():(this.game.camera.center(),this.game.camera.centreOn(this.game.player),this.game.renderer.updateAnimatedTiles())}handleDebug(){this.game.storage.setDebug(this.debugCheckbox.checked),this.game.renderer.debugging=this.debugCheckbox.checked}handleName(){this.game.storage.setShowNames(this.showNamesCheckbox.checked),this.game.renderer.drawNames=this.showNamesCheckbox.checked}handleLevel(){this.game.storage.setShowLevels(this.showLevelsCheckbox.checked),this.game.renderer.drawLevels=this.showLevelsCheckbox.checked}handleCaching(){this.game.storage.setDisableCaching(this.disableCachingCheckbox.checked)}}class Wf extends Xe{constructor(e,n){super("#equipments","#close-equipments","#equipment-button");l(this,"playerArmour",document.querySelector("#player-image-armour"));l(this,"playerWeapon",document.querySelector("#player-image-weapon"));l(this,"weapon",document.querySelector(".equip-weapon-slot"));l(this,"weaponSkin",document.querySelector(".equip-weapon-skin-slot"));l(this,"armour",document.querySelector(".equip-armour-slot"));l(this,"armourSkin",document.querySelector(".equip-armour-skin-slot"));l(this,"pendant",document.querySelector(".equip-pendant-slot"));l(this,"ring",document.querySelector(".equip-ring-slot"));l(this,"boots",document.querySelector(".equip-boots-slot"));l(this,"arrow",document.querySelector(".equip-arrows-slot"));l(this,"arrowsCount",document.querySelector("#arrows-count"));l(this,"previous",document.querySelector("#player-image-navigator > .previous"));l(this,"next",document.querySelector("#player-image-navigator > .next"));l(this,"attackStats",document.querySelector("#attack-stats"));l(this,"defenseStats",document.querySelector("#defense-stats"));l(this,"bonuses",document.querySelector("#bonuses"));l(this,"imageOrientation",re.Down);l(this,"unequipCallback");this.player=e,this.sprites=n,this.previous.addEventListener("click",()=>this.handleNavigation("previous")),this.next.addEventListener("click",()=>this.handleNavigation("next")),this.weapon.addEventListener("click",()=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,le.Weapon)}),this.weaponSkin.addEventListener("click",()=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,le.WeaponSkin)}),this.armour.addEventListener("click",()=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,le.Armour)}),this.armourSkin.addEventListener("click",()=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,le.ArmourSkin)}),this.pendant.addEventListener("click",()=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,le.Pendant)}),this.ring.addEventListener("click",()=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,le.Ring)}),this.boots.addEventListener("click",()=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,le.Boots)}),this.arrow.addEventListener("click",()=>{var r;return(r=this.unequipCallback)==null?void 0:r.call(this,le.Arrows)})}synchronize(){this.loadStats(),this.loadPlayerImage(),this.weapon.style.backgroundImage=q.getImageURL(this.player.getWeapon().key),this.weaponSkin.style.backgroundImage=q.getImageURL(this.player.getWeaponSkin().key),this.armour.style.backgroundImage=q.getImageURL(this.player.getArmour().key==="clotharmor"?"":this.player.getArmour().key),this.armourSkin.style.backgroundImage=q.getImageURL(this.player.getArmourSkin().key),this.pendant.style.backgroundImage=q.getImageURL(this.player.getPendant().key),this.ring.style.backgroundImage=q.getImageURL(this.player.getRing().key),this.boots.style.backgroundImage=q.getImageURL(this.player.getBoots().key),this.arrow.style.backgroundImage=q.getImageURL(this.player.getArrows().key);let e=this.player.getArrows().count;this.arrowsCount.innerHTML=e<1?"":`+${e}`}resize(){this.loadPlayerImage()}handleNavigation(e){let n=[re.Left,re.Up,re.Right,re.Down],r=n.indexOf(this.imageOrientation);switch(e){case"previous":{r=r===0?n.length-1:r-1;break}case"next":{r=r===n.length-1?0:r+1;break}}this.imageOrientation=n[r],this.loadPlayerImage()}loadStats(){let e=q.getEmptyStats(),n=q.getEmptyStats(),r=q.getEmptyBonuses();for(let u of Object.values(this.player.equipments))u.exists()&&(e.crush+=u.attackStats.crush,e.slash+=u.attackStats.slash,e.stab+=u.attackStats.stab,e.archery+=u.attackStats.archery,e.magic+=u.attackStats.magic,n.crush+=u.defenseStats.crush,n.slash+=u.defenseStats.slash,n.stab+=u.defenseStats.stab,n.archery+=u.defenseStats.archery,n.magic+=u.defenseStats.magic,r.accuracy+=u.bonuses.accuracy,r.strength+=u.bonuses.strength,r.archery+=u.bonuses.archery,r.magic+=u.bonuses.magic);let a=["Crush","Slash","Stab","Archery","Magic"],d=["Accuracy","Strength","Archery","Magic"];for(let u of a){let y=u.toLowerCase(),m=this.attackStats.querySelector(`.${y.toLowerCase()}`),b=this.defenseStats.querySelector(`.${y.toLowerCase()}`),E=e[y],Y=n[y];m.textContent=`${u}: ${E>0?"+":""}${E}`,b.textContent=`${u}: ${Y>0?"+":""}${Y}`}for(let u of d){let y=u.toLowerCase(),m=this.bonuses.querySelector(`.${y.toLowerCase()}`),b=r[y];m.textContent=`${u}: ${b>0?"+":""}${b}`}}loadPlayerImage(){let e=`url("/img/sprites/${this.player.getArmour().key}.png")`,n=this.player.sprite,r=this.imageOrientation===re.Left,a=this.getOrientationIndex();if(n){if(this.playerArmour.style.backgroundImage=e,this.playerArmour.style.backgroundPosition=`0 -${a*n.height}px`,this.player.hasWeapon()){let d=`url("/img/sprites/${this.player.getWeapon().key}.png")`,u=this.sprites.get(this.player.getWeapon().key),y=Math.floor(u.offsetX/2),m=Math.floor(u.offsetY/2);this.playerWeapon.style.width=`${u.width}px`,this.playerWeapon.style.height=`${u.height}px`,this.playerWeapon.style.marginLeft=`${y}px`,this.playerWeapon.style.marginTop=`${m}px`,this.playerWeapon.style.backgroundImage=d,this.playerWeapon.style.backgroundPosition=`0 -${a*u.height}px`}else this.playerWeapon.style.backgroundImage="none";this.playerArmour.style.transform=`scaleX(${r?-1:1})`,this.playerWeapon.style.transform=`scaleX(${r?-1:1})`}}getOrientationIndex(){switch(this.imageOrientation){case re.Left:case re.Right:return 1;case re.Up:return 4;case re.Down:return 7}}onUnequip(e){this.unequipCallback=e}}class Vf extends Xe{constructor(e){super("#achievements","#close-achievements","#achievements-button");l(this,"list",document.querySelector("#achievements-container > ul"));this.player=e}handle(e,n){if(e===_r.Batch){for(let a in this.player.achievements)this.createAchievement(this.player.achievements[a],a);return}let r=this.player.achievements[n];if(r){if(r.secret)return this.createAchievement(r,n);this.update(this.list.children[r.id],r)}}createAchievement(e,n){let r=document.createElement("li"),a=document.createElement("div"),d=document.createElement("p"),u=document.createElement("p");r.classList.add("achievement-element"),d.classList.add("stroke"),d.classList.add("achievement-title"),u.classList.add("achievement-description"),d.innerHTML=e.name,u.innerHTML=e.description,r.append(d),r.append(u),e.isFinished()?(d.style.color="#fcda1d",a.classList.add("coin",e.secret?`coin-${n}`:"coin-default"),r.prepend(a)):e.isStarted()&&r.append(this.createProgress(e)),this.list.append(r)}createProgress(e){let n=document.createElement("p");return n.classList.add("stroke"),n.classList.add("achievement-progress"),n.innerHTML=e.isStarted()?`${e.stage-1}/${e.stageCount-1}`:"",n}update(e,n){let r=e.querySelector(".achievement-title"),a=e.querySelector(".achievement-description"),d=e.querySelector(".achievement-progress");if(r.innerHTML=n.name,a.innerHTML=n.description,n.isFinished()){r.style.color="#fcda1d",d==null||d.remove();let u=document.createElement("div");u.classList.add("coin"),u.classList.add("coin-default"),e.prepend(u)}else{r.style.color="#fff";let u=e.querySelector(".coin");u==null||u.remove(),d?d.innerHTML=n.isStarted()?`${n.stage-1}/${n.stageCount-1}`:"":(d=this.createProgress(n),e.append(d))}}}class Zf extends Xe{constructor(e){super("#quests","#close-quests","#quests-button");l(this,"list",document.querySelector("#quests-container > ul"));l(this,"title",document.querySelector("#quest-log-title"));l(this,"shortDescription",document.querySelector("#quest-log-shortdesc"));l(this,"description",document.querySelector("#quest-log-description"));l(this,"rewards",document.querySelector("#quest-log-rewards"));this.player=e}handle(e,n=""){switch(e){case Sn.Batch:{for(let r of Object.values(this.player.quests))this.createElement(r);break}case Sn.Progress:return this.handleProgress(n)}this.buildLog(this.player.quests.tutorial)}handleProgress(e){if(!e)return;let n=this.player.quests[e];if(!n)return;let r=this.list.children[n.id],a=r.querySelector("p");a&&(a.classList.remove("green","yellow"),n.isFinished()?a.classList.add("green"):n.isStarted()&&a.classList.add("yellow"))}createElement(e){let n=document.createElement("li"),r=document.createElement("p");n.classList.add("container-slot"),r.classList.add("stroke"),r.innerHTML=e.name,e.isFinished()?r.classList.add("green"):e.isStarted()&&r.classList.add("yellow"),n.append(r),this.list.append(n),n.addEventListener("click",()=>this.buildLog(e))}buildLog(e){let[n,r]=e.description.split("|");this.title.innerHTML=e.name,this.shortDescription.innerHTML=n,this.description.innerHTML=r,e.rewards&&(this.rewards.innerHTML=e.rewards.join("<br>"))}}class Kf extends Xe{constructor(e){super("#friends-container",void 0,"#friends-button");l(this,"page",document.querySelector("#friends-page"));l(this,"list",document.querySelector("#friends-page > ul"));l(this,"addButton",document.querySelector("#add-friend"));l(this,"removeButton",document.querySelector("#remove-friend"));l(this,"input",document.querySelector("#popup-friend-input"));l(this,"confirm",document.querySelector("#popup-friend-confirm"));l(this,"cancel",document.querySelector("#popup-friend-cancel"));l(this,"popup",document.querySelector("#popup-container"));l(this,"confirmCallback");l(this,"messageCallback");l(this,"popupActive",!1);l(this,"removeActive",!1);this.player=e,this.addButton.addEventListener("click",()=>this.showPopup()),this.removeButton.addEventListener("click",()=>this.showPopup(!0)),this.confirm.addEventListener("click",this.handleConfirm.bind(this)),this.cancel.addEventListener("click",this.hidePopup.bind(this))}resize(){for(let e in this.player.friends){let n=this.player.friends[e],r=this.list.children[n.id];if(!r)return;let a=r.children[0],d=this.getMaxLength();n.username.length>d&&(a.innerHTML=`${n.username.slice(0,d)}...`)}}handle(e,n="",r=!1,a=-1){switch(e){case wt.List:{for(let d of Object.values(this.player.friends))this.createElement(d.username,d.online,d.serverId);break}case wt.Add:return this.createElement(n,r,a);case wt.Remove:return this.removeElement(n);case wt.Status:return this.updateStatus(n,r,a)}}handleConfirm(){var r;let e=this.input.value,n=this.removeActive;this.input.value="",this.hidePopup(),!(!e||e.length>32)&&((r=this.confirmCallback)==null||r.call(this,e,n))}handleMessage(e){var n;this.player.friends[e].online&&((n=this.messageCallback)==null||n.call(this,e))}keyDown(e){e==="Escape"&&this.hidePopup(),e==="Enter"&&this.input.value!==""&&this.handleConfirm()}showPopup(e=!1){this.popupActive=!0,this.removeActive=e,this.input.placeholder=e?"Enter name to remove...":"Enter name to add...",q.fadeIn(this.popup),this.page.classList.add("dimmed"),this.input.focus()}hidePopup(){this.popupActive=!1,this.removeActive=!1,q.fadeOut(this.popup),this.page.classList.remove("dimmed")}createElement(e,n=!1,r=-1){let a=document.createElement("li"),d=document.createElement("p"),u=document.createElement("p");a.classList.add("container-slot"),d.classList.add("stroke","left"),u.classList.add("stroke","right"),n&&u.classList.add(this.player.serverId===r?"green":"yellow");let y=this.getMaxLength();e.length>y&&(e=`${e.slice(0,y)}...`),d.innerHTML=q.formatName(e),u.innerHTML=n?`World ${r}`:"Offline",a.append(d,u),this.list.append(a),a.addEventListener("click",()=>this.handleMessage(e))}removeElement(e){let n=this.player.friends[e];n&&(this.list.children[n.id].remove(),delete this.player.friends[e])}updateStatus(e,n,r){let a=this.player.friends[e];if(!a)return;let d=this.list.children[a.id].children[1];n?(d.classList.add(this.player.serverId===r?"green":"yellow"),d.innerHTML=`World ${a.serverId}`):(d.classList.remove("green","yellow"),d.innerHTML="Offline")}isPopupActive(){return this.popupActive}getMaxLength(){return Qd()?16:10}onConfirm(e){this.confirmCallback=e}onMessage(e){this.messageCallback=e}}class Qf extends Xe{constructor(e){super("#trade-container",void 0,"#close-trade");l(this,"hideOnShow",!1);l(this,"inventoryList",document.querySelector("#trade-inventory-slots > ul"));l(this,"playerSlots",document.querySelector("#trade-player-slots > ul"));l(this,"otherPlayerSlots",document.querySelector("#trade-oplayer-slots > ul"));l(this,"playerName",document.querySelector("#trade-player-name"));l(this,"otherPlayerName",document.querySelector("#trade-oplayer-name"));l(this,"tradeStatus",document.querySelector("#trade-status"));l(this,"acceptButton",document.querySelector("#trade-accept"));l(this,"tradeDialog",document.querySelector("#trade-count"));l(this,"tradeCount",document.querySelector("#trade-count .dialog-count"));l(this,"tradeCountAccept",document.querySelector("#trade-count .dialog-accept"));l(this,"tradeCountCancel",document.querySelector("#trade-count .dialog-cancel"));l(this,"inventoryIndex",-1);l(this,"selectCallback");l(this,"acceptCallback");l(this,"closeCallback");this.inventory=e,this.load(),this.acceptButton.addEventListener("click",()=>{var n;return(n=this.acceptCallback)==null?void 0:n.call(this)}),this.tradeCountAccept.addEventListener("click",()=>this.sendTradeAmount()),this.tradeCountCancel.addEventListener("click",()=>this.hideTradeAmountDialog())}load(){for(let e=0;e<kt.INVENTORY_SIZE;e++)this.inventoryList.append(q.createSlot(qe.Inventory,e,this.select.bind(this),this.showTradeAmountDialog.bind(this))),this.playerSlots.append(q.createSlot(qe.Trade,e,this.select.bind(this))),this.otherPlayerSlots.append(q.createSlot(qe.Trade,e))}keyDown(e){switch(e){case"Escape":return this.hideTradeAmountDialog();case"Enter":return this.sendTradeAmount()}}synchronize(){this.isVisible()&&this.inventory.forEachSlot((e,n)=>{let r=this.getElement(e).querySelector(".item-image"),a=this.getElement(e).querySelector(".item-count"),d=n.querySelector(".item-image");d&&(r.style.backgroundImage=d.style.backgroundImage,a.textContent=n.textContent)})}show(e,n){super.show(),this.synchronize(),this.playerName.textContent=e.name,this.otherPlayerName.textContent=n.name}hide(e=!1){var n;super.hide(),e||(n=this.closeCallback)==null||n.call(this),this.clearAll(),this.inventoryIndex=-1,this.tradeStatus.innerHTML=""}add(e,n,r,a=!1){let d=a?this.otherPlayerSlots.children[e]:this.playerSlots.children[e],u=d.querySelector(".item-image"),y=d.querySelector(".item-count");if(this.tradeStatus.innerHTML="",u.style.backgroundImage=a?q.getImageURL(r):this.getElementImage(this.inventoryIndex),y.innerHTML=n>1?q.getCount(n):"",!a){let m=this.getElement(this.inventoryIndex).querySelector(".item-count"),b=this.inventory.getCount(this.inventoryIndex)-n;if(d.inventoryIndex=this.inventoryIndex,isNaN(b)||b<1)return this.clearSlot(this.inventoryIndex);m.innerHTML=q.getCount(b)}}remove(e,n=!1){let r=n?this.otherPlayerSlots.children[e]:this.playerSlots.children[e],a=r.querySelector(".item-image"),d=r.querySelector(".item-count");if(!n){let u=r.inventoryIndex;this.setSlot(u,a.style.backgroundImage,this.inventory.getCount(u))}a.style.backgroundImage="",d.innerHTML="",this.tradeStatus.innerHTML="",this.inventoryIndex=-1}sendTradeAmount(){let e=this.tradeCount.valueAsNumber;e<1||(this.select(qe.Inventory,this.inventoryIndex,e),this.hideTradeAmountDialog())}showTradeAmountDialog(e,n){this.inventoryIndex=n,q.fadeIn(this.tradeDialog),this.inventoryList.classList.add("dimmed"),this.tradeCount.value="1",this.tradeCount.focus()}hideTradeAmountDialog(){q.fadeOut(this.tradeDialog),this.inventoryList.classList.remove("dimmed")}accept(e){this.tradeStatus.innerHTML=e||""}select(e,n,r){var a;this.inventoryIndex=n,(a=this.selectCallback)==null||a.call(this,e,n,r)}getElement(e){return this.inventoryList.children[e].querySelector("div")}getElementImage(e){return this.getElement(e).querySelector(".item-image").style.backgroundImage}isInputDialogueVisible(){return this.tradeDialog.style.display==="block"}clearSlot(e){let n=this.getElement(e),r=n.querySelector(".item-image"),a=n.querySelector(".item-count");r.style.backgroundImage="",a.innerHTML=""}clearAll(){for(let e of this.playerSlots.children){let n=e.querySelector(".item-image"),r=e.querySelector(".item-count");n.style.backgroundImage="",r.innerHTML=""}for(let e of this.otherPlayerSlots.children){let n=e.querySelector(".item-image"),r=e.querySelector(".item-count");n.style.backgroundImage="",r.innerHTML=""}}setSlot(e,n,r){let a=this.getElement(e),d=a.querySelector(".item-image"),u=a.querySelector(".item-count");d.style.backgroundImage=n,u.innerHTML=q.getCount(r)}onSelect(e){this.selectCallback=e}onAccept(e){this.acceptCallback=e}onClose(e){this.closeCallback=e}}class Jf extends Xe{constructor(e){super("#interact");l(this,"list",document.querySelector("#interact > ul"));l(this,"buttonCallback");l(this,"closeCallback");this.player=e}show(e,n,r=!1){this.clear();let a=[];n.isItem()&&a.push(ke.Examine),n.isMob()&&a.push(ke.Attack,ke.Examine),n.isPlayer()&&(r?a.push(ke.Attack):a.push(ke.Follow),a.push(ke.Trade),this.player.hasFriend(n.name)||a.push(ke.AddFriend));for(let d of a)this.add(d);if(a.length>0){let d=e.x+this.container.offsetWidth>window.innerWidth?window.innerWidth-this.container.offsetWidth:e.x,u=e.y+this.container.offsetHeight>window.innerHeight?window.innerHeight-this.container.offsetHeight:e.y;this.container.style.left=`${d}px`,this.container.style.top=`${u}px`,super.show()}}hide(){var e;super.hide(),(e=this.closeCallback)==null||e.call(this)}add(e){let n=document.createElement("li");n.classList.add("action-button",`action-${e}`),n.addEventListener("click",()=>this.buttonCallback(e)),this.list.append(n)}clear(){this.list.innerHTML=""}onButton(e){this.buttonCallback=e}onClose(e){this.closeCallback=e}}let Ml=class extends Xe{constructor(e){super("#leaderboards","#close-leaderboards","#leaderboards-button");l(this,"searchList",document.querySelector("#leaderboards-search"));l(this,"resultsList",document.querySelector("#leaderboards-results"));l(this,"search",document.querySelector("#leaderboards-search-input"));l(this,"searchElements",[{name:"Total Experience",key:"",type:""},{name:"PVP Kills",key:"pvp",type:"pvp"}]);l(this,"availableMobs",{});this.app=e,this.search.addEventListener("input",this.handleInput.bind(this));for(let n of na)this.searchElements.push({name:ot[n],key:n,type:"skill"});if(!this.app.config.hub){this.load();return}fetch(`${this.app.config.hub}/leaderboards`).then(n=>n.json()).then(n=>{if(n.availableMobs){this.availableMobs=n.availableMobs;for(let r in this.availableMobs)this.searchElements.push({name:this.availableMobs[r],key:r,type:"mob"});this.load()}}).catch(n=>{de.error(n)})}load(){this.searchList.innerHTML="";for(let e of this.searchElements)this.createSearchElement(e);this.handleSearchElement(this.searchElements[0])}handleInput(e){let n=e.target.value.toLowerCase();for(let r of this.searchList.children)r.querySelector("p").innerHTML.toLowerCase().includes(n)?r.hidden=!1:r.hidden=!0}handleSearchElement(e){if(!this.app.config.hub)return;let n=`${this.app.config.hub}/leaderboards`;e.type&&(n+=`?${e.type}=${e.key}`),fetch(n).then(r=>r.json()).then(r=>{if(!r.list)return de.info("No results found.");this.resultsList.innerHTML="";for(let a of r.list)this.createResultElement(a,e.type)}).catch(r=>{de.error(r)})}hide(){super.hide(),this.search.value=""}keyDown(e){e==="Escape"&&this.hide()}createSearchElement(e){let n=document.createElement("li"),r=document.createElement("p");n.classList.add("container-slot"),r.classList.add("stroke","white"),r.innerHTML=e.name,n.append(r),n.addEventListener("click",()=>this.handleSearchElement(e)),this.searchList.append(n)}createResultElement(e,n){let r=document.createElement("li"),a=document.createElement("p"),d=document.createElement("p");r.classList.add("container-slot-large"),a.classList.add("stroke",e.cheater?"red":"white","left"),d.classList.add("stroke",e.cheater?"red":"white","right"),a.innerHTML=e._id,d.innerHTML=n==="skill"||n===""?`${e.experience}`:`${e.kills}`,r.append(a,d),this.resultsList.append(r)}};class ec extends Xe{constructor(e){super("#guilds","#close-guilds","#guilds-button");l(this,"banner",document.querySelector("#guilds > .banner"));l(this,"listContainer",document.querySelector("#guilds-list-container"));l(this,"createButton",document.querySelector("#create-guild"));l(this,"create",document.querySelector("#guilds-create-container"));l(this,"createError",document.querySelector("#create-error"));l(this,"backButton",document.querySelector("#guild-back"));l(this,"createConfirmButton",document.querySelector("#guild-create"));l(this,"bannerColours",document.querySelector("#banner-colours"));l(this,"bannerOutlines",document.querySelector("#banner-outline-colours"));l(this,"bannerCrests",document.querySelector("#banner-crests"));l(this,"nameInput",document.querySelector("#guild-name-input"));l(this,"bannerColour",qi.Grey);l(this,"bannerOutline","");l(this,"bannerCrest",un.None);l(this,"infoContainer",document.querySelector("#guilds-info-container"));l(this,"chatLog",document.querySelector("#guild-chat-log"));l(this,"chatInput",document.querySelector("#guild-chat-input"));l(this,"guildName",document.querySelector("#guild-name"));l(this,"leaveButton",document.querySelector("#guild-leave"));l(this,"guildList",document.querySelector("#guilds-list-container > ul"));l(this,"memberList",document.querySelector("#member-list"));l(this,"sidebarList",document.querySelector("#sidebar-list"));l(this,"from",0);l(this,"to",10);l(this,"currentSidebar","sidebar-members");this.game=e,this.createButton.addEventListener("click",this.handleCreate.bind(this)),this.backButton.addEventListener("click",this.handleBackButton.bind(this)),this.createConfirmButton.addEventListener("click",this.handleCreateConfirm.bind(this)),this.leaveButton.addEventListener("click",this.handleLeave.bind(this)),this.loadSidebar(),this.loadDecorations()}handle(e,n){switch(e){case Be.Join:return this.handleMemberJoin(n.username,n.serverId);case Be.Login:return this.handleConnect(n);case Be.Leave:return n!=null&&n.username?this.handleMemberLeave(n.username):this.handleBackButton();case Be.Rank:{console.log(n);break}case Be.Update:return this.loadMembers(n.members);case Be.Experience:{console.log(n);break}case Be.List:return this.loadList(n.guilds,n.total);case Be.Error:return this.setError(n.message);case Be.Chat:return this.handleChat(n)}}handleCreate(){this.listContainer.style.display="none",this.infoContainer.style.display="none",this.create.style.display="block"}handleBackButton(){this.bannerColour=qi.Grey,this.bannerOutline="",this.bannerCrest=un.None,this.updateBanner(),this.cleanSelectedCrests(!0),this.setError(),this.memberList.innerHTML="",this.chatLog.innerHTML="",this.create.style.display="none",this.infoContainer.style.display="none",this.listContainer.style.display="block",this.requestList()}handleCreateConfirm(){if(this.setError(),this.bannerOutline==="")return this.setError("Please select an outline colour.");if(this.nameInput.value.length<3||this.nameInput.value.length>16)return this.setError("Guild name must be between 3 and 15 characters.");this.game.socket.send(B.Guild,{opcode:Be.Create,name:this.nameInput.value,colour:this.bannerColour,outline:this.bannerOutline,crest:this.bannerCrest})}handleLeave(){this.game.socket.send(B.Guild,{opcode:Be.Leave})}handleConnect(e){var r,a,d;this.setError(),this.listContainer.style.display="none",this.create.style.display="none",this.infoContainer.style.display="block",this.bannerColour=((r=e.decoration)==null?void 0:r.banner)||qi.Grey,this.bannerOutline=((a=e.decoration)==null?void 0:a.outline)||"",this.bannerCrest=(d=e.decoration)==null?void 0:d.crest,this.updateBanner(),this.guildName.innerHTML="",this.memberList.innerHTML="";let n=document.createElement("p");n.className="stroke",n.innerHTML=e.name||"Unknown",this.guildName.append(n),this.game.player.name.toLowerCase()===e.owner&&(this.leaveButton.innerHTML="Disband");for(let u of e.members)this.createElement(this.memberList,u.rank,u.username)}handleMemberJoin(e,n=-1){e!==this.game.player.name.toLowerCase()&&(this.createElement(this.memberList,qs.Fledgling,e),this.loadMembers([{username:e,serverId:n}]))}handleMemberLeave(e){let n=this.getElement(this.memberList,e);n==null||n.remove()}handleSidebar(e){if(this.game.player.guild&&this.currentSidebar!==e){switch(e){case"sidebar-members":{this.memberList.style.display="block",this.infoContainer.className="",this.chatInput.style.display="none",this.chatLog.style.display="none";break}case"sidebar-chat":{this.memberList.style.display="none",this.infoContainer.className="guild-chat",this.chatInput.style.display="block",this.chatLog.style.display="block";break}}this.currentSidebar=e}}handleChat(e){if(!e.username||!e.serverId)return;let n=`[W${e.serverId}] ${q.formatName(e.username)}`,r=document.createElement("p");r.innerHTML=`${n} » ${e.message}`,this.chatLog.append(r)}keyDown(e){e!=="Enter"||this.currentSidebar!=="sidebar-chat"||this.chatInput.value.length!==0&&this.sendChat()}requestList(){if(!this.game.player.guild)return this.game.socket.send(B.Guild,{opcode:Be.List,from:this.from,to:this.to})}sendChat(){this.chatInput.value.length!==0&&(this.game.socket.send(B.Guild,{opcode:Be.Chat,message:this.chatInput.value}),this.chatInput.value="")}loadList(e=[],n=0){if(n===0)return;this.guildList.innerHTML="";let r=this.listContainer.querySelector("#guilds-info");r.innerHTML="";for(let a of e)this.createElement(this.guildList,"guild",a.name,a.members)}loadSidebar(){for(let e of this.sidebarList.children)e.addEventListener("click",()=>{this.cleanSidebar(),e.classList.add("active"),this.handleSidebar(e.id)})}loadDecorations(){this.loadColours(),this.loadOutlines(),this.loadCrests()}loadColours(){for(let e in qi){let n=document.createElement("li"),r=qi[e];n.className=`banner-colour-button banner-colour-button-${r}`,n.addEventListener("click",()=>{this.bannerColour=r,this.updateBanner()}),this.bannerColours.append(n)}}loadOutlines(){for(let e in Bs){let n=document.createElement("li"),r=Bs[e];n.className=`banner-outline-button banner-outline-button-${r}`,n.addEventListener("click",()=>{this.bannerOutline=r,this.updateBanner()}),this.bannerOutlines.append(n)}}loadCrests(){for(let e in un){let n=document.createElement("li"),r=document.createElement("div"),a=un[e];n.className="crest-element",r.className=`banner-crest-icon banner-crest-icon-${a}`,n.append(r),a==="none"&&n.classList.add("active"),n.addEventListener("click",()=>{this.cleanSelectedCrests(),this.bannerCrest=a,this.updateBanner(),n.classList.add("active")}),this.bannerCrests.append(n)}}loadMembers(e){for(let n of e){let r=this.getElement(this.memberList,n.username);if(!r)continue;let a=r.querySelector(".name"),d=r.querySelector(".server"),u=n.serverId===-1?"red":n.serverId===this.game.player.serverId?"green":"yellow";a.className="name",d.className=`server ${u}`,d.innerHTML=n.serverId===-1?"Offline":`${this.game.app.config.name} ${n.serverId}`}}show(){super.show(),this.requestList()}hide(){super.hide(),this.from=0,this.to=10,this.game.player.guild||this.handleBackButton()}createElement(e,n,r,a=0){let d=document.createElement("li"),u=document.createElement("span"),y=n==="guild",m=n==="guild"?"guild":qs[n].toLowerCase();if(d.identifier=r,d.className=`slot-element slot-${m} stroke`,u.className="name",u.innerHTML=y?r:q.formatName(r,14),y){if(a>0){let E=document.createElement("span");E.classList.add("count"),E.innerHTML=`${a}/${kt.MAX_GUILD_MEMBERS}`,d.append(E)}let b=document.createElement("div");b.className="element-button stroke",b.innerHTML="Join",b.addEventListener("click",()=>{this.game.socket.send(B.Guild,{opcode:Be.Join,identifier:r.toLowerCase()})}),d.append(u,b)}if(!y){d.append(u);let b=document.createElement("span"),E=this.game.player.name.toLowerCase()===d.identifier;b.className=`server ${E?"green":"red"}`,b.innerHTML=E?"Online":"Offline",d.append(b)}e.append(d)}cleanSelectedCrests(e=!1){for(let n of this.bannerCrests.children)n.classList.remove("active");e&&this.bannerCrests.children[0].classList.add("active")}cleanSidebar(){for(let e of this.sidebarList.children)e.classList.remove("active")}updateBanner(){let e=this.banner.querySelector(".banner-outline"),n=this.banner.querySelector(".banner-crest");this.banner.className=`banner banner-${this.bannerColour}`,e.className=`banner-outline${this.bannerOutline?` banner-outline-${this.bannerOutline}`:""}`,this.bannerCrest&&(n.className=`banner-crest banner-crest-${this.bannerCrest}`)}getElement(e,n){for(let r of e.children)if(r.identifier===n)return r}setError(e=""){this.createError.innerHTML=e}}class Pl extends Xe{constructor(e){super("#leaderboards","#close-leaderboards","#leaderboards-button2");l(this,"searchList",document.querySelector("#leaderboards-search"));l(this,"resultsList",document.querySelector("#leaderboards-results"));l(this,"search",document.querySelector("#leaderboards-search-input"));l(this,"searchElements",[{name:"Total Experience",key:"",type:"totalExperience"},{name:"Rank",key:"rank",type:"rank"}]);l(this,"availableMobs",{});this.app=e,this.search.addEventListener("input",this.handleInput.bind(this));for(let n of na)this.searchElements.push({name:ot[n],key:n,type:"skill"});if(!this.app.config.hub){this.load();return}fetch(`${this.app.config.hub}/leaderboards`).then(n=>n.json()).then(n=>{if(n.availableMobs){this.availableMobs=n.availableMobs;for(let r in this.availableMobs)this.searchElements.push({name:this.availableMobs[r],key:r,type:"mob"});this.load()}}).catch(n=>{de.error(n)})}load(){this.searchList.innerHTML="";for(let e of this.searchElements)this.createSearchElement(e);this.handleSearchElement(this.searchElements[0])}handleInput(e){let n=e.target.value.toLowerCase();for(let r of this.searchList.children)r.querySelector("p").innerHTML.toLowerCase().includes(n)?r.hidden=!1:r.hidden=!0}async handleSearchElement(e){this.resultsList.innerHTML="";let r=(await fetch("http://localhost:9003/").then(d=>d.json())).data;if(r.forEach(d=>{let u=0;d.skills.skills.forEach(y=>{u=u+y.experience}),r=[...r.filter(y=>y._id!==d._id),{...d,totalExperience:u}]}),!this.app.config.hub){for(let d of r.sort(function(u,y){return y[e.type]-u[e.type]}))this.createResultElement(d,e.type);return}let a=`${this.app.config.hub}/leaderboards`;e.type&&(a+=`?${e.type}=${e.key}`),fetch(a).then(d=>d.json()).then(d=>{if(!d.list)return de.info("No results found.");this.resultsList.innerHTML="";for(let u of d.list)this.createResultElement(u,e.type)}).catch(d=>{de.error(d)})}hide(){super.hide(),this.search.value=""}keyDown(e){e==="Escape"&&this.hide()}createSearchElement(e){let n=document.createElement("li"),r=document.createElement("p");n.classList.add("container-slot"),r.classList.add("stroke","white"),r.innerHTML=e.name,n.append(r),n.addEventListener("click",()=>this.handleSearchElement(e)),this.searchList.append(n)}createResultElement(e,n){console.log(e);let r=document.createElement("li"),a=document.createElement("p"),d=document.createElement("p");r.classList.add("container-slot-large"),a.classList.add("stroke",e.cheater?"red":"white","left"),d.classList.add("stroke",e.cheater?"red":"white","right"),a.innerHTML=e.username,d.innerHTML=e[n]||0,r.append(a,d),this.resultsList.append(r)}}class tc extends Xe{constructor(){super("#crafting","#close-crafting");l(this,"options",document.querySelector("#crafting-options"));l(this,"requirements",document.querySelector("#crafting-requirements"));l(this,"result",document.querySelector("#crafting-result"));l(this,"level",document.querySelector("#crafting-level"));l(this,"name",document.querySelector("#crafting-result-name"));l(this,"craftOne",document.querySelector("#craft-one"));l(this,"craftFive",document.querySelector("#craft-five"));l(this,"craftTen",document.querySelector("#craft-ten"));l(this,"craftButton",document.querySelector("#craft-button"));l(this,"selectedKey","");l(this,"craftAmount",1);l(this,"type",ot.Crafting);l(this,"selectCallback");l(this,"craftCallback");this.craftOne.addEventListener("click",()=>this.handleAmount(1)),this.craftFive.addEventListener("click",()=>this.handleAmount(5)),this.craftTen.addEventListener("click",()=>this.handleAmount(10)),this.craftButton.addEventListener("click",()=>{var e;(e=this.craftCallback)==null||e.call(this,this.selectedKey,this.craftAmount),this.hide()})}handle(e,n){switch(e){case xn.Open:return this.show(n.type,n.keys);case xn.Select:return this.handleSelect(n.key,n.name,n.level,n.result,n.requirements)}}handleSelect(e,n,r,a,d){this.requirements.innerHTML="",this.selectedKey=e;let u=this.result.querySelector(".crafting-option-icon"),y=this.result.querySelector(".crafting-option-count"),m=this.level.querySelector(".crafting-option-icon"),b=this.level.querySelector(".crafting-option-count");u.style.backgroundImage=q.getImageURL(e),m.style.backgroundImage=this.getSkillIcon(),y.innerHTML=`x${a}`,b.innerHTML=`${r}`,this.name.innerHTML=n;for(let E of d)this.requirements.append(this.createSlot(E.key,E.count,!0))}handleAmount(e){switch(this.craftAmount=e,this.craftOne.classList.remove("active"),this.craftFive.classList.remove("active"),this.craftTen.classList.remove("active"),e){case 1:{this.craftOne.classList.add("active");break}case 5:{this.craftFive.classList.add("active");break}case 10:{this.craftTen.classList.add("active");break}}}show(e,n){var a;super.show(),this.options.innerHTML="",this.type=e;for(let d of n)this.options.append(this.createSlot(d));n.length>0&&((a=this.selectCallback)==null||a.call(this,n[0]),this.options.children[0].classList.add("active"));let r="Craft";switch(e){case ot.Cooking:{r="Cook";break}case ot.Crafting:{r="Craft";break}case ot.Fletching:{r="Fletch";break}case ot.Smithing:{r="Smith";break}case ot.Smelting:{r="Smelt";break}}this.craftButton.innerHTML=r}createSlot(e,n,r=!1){let a=document.createElement("li"),d=document.createElement("div");if(a.classList.add("crafting-option"),d.classList.add("crafting-option-icon"),d.style.backgroundImage=q.getImageURL(e),a.append(d),n){let u=document.createElement("div");u.classList.add("crafting-option-count","stroke"),u.innerHTML=`x${n}`,a.append(u)}return r?a.classList.add("disabled"):a.addEventListener("click",()=>{var u;for(let y of this.options.children)y.classList.remove("active");a.classList.add("active"),(u=this.selectCallback)==null||u.call(this,e)}),a}getSkillIcon(){let e=ot[this.type].toLowerCase();switch(this.type){case ot.Smelting:case ot.Smithing:return"url(/img/interface/skills/smithing.png)"}return`url(/img/interface/skills/${e}.png)`}onSelect(e){this.selectCallback=e}onCraft(e){this.craftCallback=e}}class ic{constructor(t){l(this,"actions",new Rf);l(this,"crafting",new tc);l(this,"inventory");l(this,"bank");l(this,"store");l(this,"profile");l(this,"enchant");l(this,"warp");l(this,"notification");l(this,"settings");l(this,"equipments");l(this,"achievements");l(this,"quests");l(this,"friends");l(this,"trade");l(this,"interact");l(this,"leaderboards");l(this,"LeaderboardsFooter");l(this,"guilds");l(this,"header");l(this,"menus");this.game=t,this.inventory=new Nf(this.actions),this.bank=new Mf(this.inventory),this.store=new Pf(this.inventory),this.profile=new Uf(t.player),this.enchant=new Hf(this.inventory),this.warp=new $f(t.socket),this.notification=new jf,this.settings=new Gf(t),this.header=new Of(t.player),this.equipments=new Wf(t.player,t.sprites),this.achievements=new Vf(t.player),this.quests=new Zf(t.player),this.friends=new Kf(t.player),this.trade=new Qf(this.inventory),this.interact=new Jf(t.player),this.leaderboards=new Ml(t.app),this.LeaderboardsFooter=new Pl(t.app),this.guilds=new ec(t),this.menus={inventory:this.inventory,bank:this.bank,store:this.store,profile:this.profile,enchant:this.enchant,warp:this.warp,notification:this.notification,settings:this.settings,equipments:this.equipments,achievements:this.achievements,quests:this.quests,friends:this.friends,trade:this.trade,interact:this.interact,leaderboards:this.leaderboards,LeaderboardsFooter:this.LeaderboardsFooter,guilds:this.guilds,crafting:this.crafting},this.inventory.onSelect(this.handleInventorySelect.bind(this)),this.bank.onSelect(this.handleBankSelect.bind(this)),this.store.onSelect(this.handleStoreSelect.bind(this)),this.equipments.onUnequip(this.handleProfileUnequip.bind(this)),this.profile.onUnequip(this.handleProfileUnequip.bind(this)),this.profile.onAttackStyle(this.handleProfileAttackStyle.bind(this)),this.profile.onAbility(this.handleAbility.bind(this)),this.enchant.onSelect(this.handleEnchantSelect.bind(this)),this.enchant.onConfirm(this.handleEnchantConfirm.bind(this)),this.warp.onSelect(this.handleWarp.bind(this)),this.friends.onConfirm(this.handleFriendConfirm.bind(this)),this.trade.onSelect(this.handleTradeSelect.bind(this)),this.trade.onAccept(this.handleTradeAccept.bind(this)),this.trade.onClose(this.handleTradeClose.bind(this)),this.crafting.onSelect(this.handleCraftingSelect.bind(this)),this.crafting.onCraft(this.handleCraftingConfirm.bind(this)),this.load()}load(){this.forEachMenu(t=>t.onShow(()=>this.hide()))}hide(){this.forEachMenu(t=>{t.isVisible()&&t.hide()})}synchronize(t){var e;if(t)return(e=this.menus[t])==null?void 0:e.synchronize();this.forEachMenu(n=>n.synchronize())}resize(){this.header.resize(),this.forEachMenu(t=>t.resize())}getInteract(){return this.interact}getInventory(){return this.inventory}getBank(){return this.bank}getStore(){return this.store}getProfile(){return this.profile}getNotification(){return this.notification}getEnchant(){return this.enchant}getWarp(){return this.warp}getAchievements(){return this.achievements}getQuests(){return this.quests}getFriends(){return this.friends}getTrade(){return this.trade}getLeaderboards(){return this.leaderboards}getLeaderboards2(){return this.LeaderboardsFooter}getGuilds(){return this.guilds}getCrafting(){return this.crafting}handleInventorySelect(t,e,n){this.game.socket.send(B.Container,{opcode:t,type:qe.Inventory,fromIndex:e,value:n})}handleBankSelect(t,e,n,r){this.game.socket.send(B.Container,{opcode:It.Select,type:qe.Bank,fromContainer:t,fromIndex:e,toContainer:n,value:r})}handleStoreSelect(t,e,n,r=1){this.game.socket.send(B.Store,{opcode:t,key:e,index:n,count:r})}handleProfileUnequip(t){this.game.socket.send(B.Equipment,{opcode:fi.Unequip,type:t})}handleProfileAttackStyle(t){this.game.socket.send(B.Equipment,{opcode:fi.Style,style:t})}handleAbility(t,e,n){this.game.socket.send(B.Ability,{opcode:t,key:e,index:n})}handleEnchantSelect(t){this.game.socket.send(B.Enchant,{opcode:br.Select,index:t})}handleEnchantConfirm(t,e){this.game.socket.send(B.Enchant,{opcode:br.Confirm,index:t,shardIndex:e})}handleWarp(t){this.game.socket.send(B.Warp,{id:t})}handleFriendConfirm(t,e=!1){this.game.socket.send(B.Friends,{opcode:e?wt.Remove:wt.Add,username:t})}handleTradeSelect(t,e,n){switch(t){case qe.Inventory:return this.game.socket.send(B.Trade,{opcode:mt.Add,index:e,count:n});case qe.Trade:return this.game.socket.send(B.Trade,{opcode:mt.Remove,index:e,count:n})}}handleTradeAccept(){this.game.socket.send(B.Trade,{opcode:mt.Accept})}handleTradeClose(){this.game.socket.send(B.Trade,{opcode:mt.Close})}handleCraftingSelect(t){this.game.socket.send(B.Crafting,{opcode:xn.Select,key:t})}handleCraftingConfirm(t,e){this.game.socket.send(B.Crafting,{opcode:xn.Craft,key:t,count:e})}forEachMenu(t){for(let e of Object.values(this.menus))t(e)}}class wo{constructor(t,e,n){l(this,"x",-1);l(this,"y",-1);l(this,"blinkInterval");l(this,"visible",!0);this.id=t,this.element=e,this.type=n,this.load()}load(){this.blinkInterval=window.setInterval(()=>{this.visible?this.hide():this.show(),this.visible=!this.visible},600)}setPosition(t,e){this.x=t,this.y=e}destroy(){clearInterval(this.blinkInterval),this.type===Je.Button?this.hide():this.element.remove()}show(){this.type===Je.Button?this.element.addClass("active"):this.element.show()}hide(){this.type===Je.Button?this.element.removeClass("active"):this.element.hide()}}class nc{constructor(t){l(this,"camera");l(this,"pointers",{});l(this,"container",_t("#bubbles"));this.game=t,this.camera=this.game.camera}create(t,e,n){let{pointers:r,container:a}=this;if(!(t in r))switch(e){case Je.Button:{r[t]=new wo(t,_t(`#${n}`),e);break}default:{let d=_t(`<div id="${t}" class="pointer"></div>`);this.setSize(d),a.append(d),r[t]=new wo(t,d,e);break}}}resize(){for(let{type:t,x:e,y:n,element:r}of Object.values(this.pointers))switch(t){case Je.Relative:{let a=this.getZoom(),d=0,u=0;r.css({left:`${e*a-d}px`,top:`${n*a-u}px`});break}}}setSize(t){let e="/img/pointer.png";t.css({top:"30px",width:"64px",height:"64px",margin:"inherit",marginTop:"-18px",background:`url("${e}") no-repeat -4px`})}clean(){for(let t of Object.values(this.pointers))t.destroy();this.pointers={}}destroy(t){delete this.pointers[t.id],t.destroy()}set(t,e,n){let{camera:r,game:a}=this;if(!r)return;let{element:d}=t,{canvasWidth:u,canvasHeight:y}=a.renderer,m=a.map.tileSize*this.getZoom(),b=(e-r.x)*this.getZoom(),E=parseInt(d.css("width")),Y=E/2-m/2,I=(n-r.y)*this.getZoom()-m,A=b/u,O=I/y;A>=1.5?d.css({left:"",right:0,top:"50%",bottom:"",transform:"rotate(-90deg)"}):O>=1.5?d.css({left:"50%",right:"",top:"",bottom:0,transform:""}):A<=0?d.css({left:0,right:"",top:"50%",bottom:"",transform:"rotate(90deg)"}):O<=0?d.css({left:"",right:"50%",top:0,bottom:"",transform:"rotate(180deg)"}):d.css({left:`${b-Y}px`,right:"",top:`${I}px`,bottom:"",transform:""})}setToEntity(t){let e=this.get(t.instance);e&&this.set(e,t.x,t.y)}setToPosition(t,e,n){let r=this.get(t);r&&(r.setPosition(e,n),this.set(r,e,n))}setRelative(t,e,n){let r=this.get(t);if(!r)return;let a=this.getZoom(),d=0,u=0;r.setPosition(e,n),r.element.css({left:`${e*a-d}px`,top:`${n*a-u}px`})}update(){for(let t of Object.values(this.pointers))switch(t.type){case Je.Entity:{let e=this.game.entities.get(t.id);e?this.setToEntity(e):this.destroy(t);break}case Je.Location:{t.x!==-1&&t.y!==-1&&this.set(t,t.x,t.y);break}}}get(t){let{pointers:e}=this;return t in e?e[t]:null}getZoom(){return this.game.camera.zoomFactor}}const rc=[{id:"adhererarcherarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"angel",width:32,height:32,offsetX:-8,offsetY:-13},{id:"card",width:32,height:32,offsetX:-8,offsetY:-13},{id:"card2",width:32,height:32,offsetX:-8,offsetY:-13},{id:"snowman2",width:32,height:32,offsetX:-8,offsetY:-13},{id:"rabbitman",width:32,height:32,offsetX:-8,offsetY:-13},{id:"cowwarrior",width:42,height:42,offsetX:-13,offsetY:-18},{id:"rooster",width:42,height:42,offsetX:-13,offsetY:-18},{id:"cowarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"adherer",width:32,height:32,offsetX:-8,offsetY:-12},{id:"adhererrobe",width:32,height:32,offsetX:-8,offsetY:-13},{id:"adminarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"agent",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"ancientmanumentnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"angelnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"ant",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-28},{id:"archerarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"archerschooluniform",width:32,height:32,offsetX:-8,offsetY:-12},{id:"axe",width:48,height:48,offsetX:-16,offsetY:-20},{id:"pickaxe",width:48,height:48,offsetX:-16,offsetY:-20},{id:"fireaxe",width:48,height:48,offsetX:-16,offsetY:-20},{id:"poisonaxe",width:48,height:48,offsetX:-16,offsetY:-20},{id:"rustedaxe",width:48,height:48,offsetX:-16,offsetY:-20},{id:"babyspider",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-7,offsetY:-13},{id:"bamboospear",width:48,height:48,offsetX:-17,offsetY:-21},{id:"bastardsword",width:48,height:48,offsetX:-17,offsetY:-21},{id:"bat",idleSpeed:100,width:32,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:5,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:5,row:4},idle_up:{length:5,row:5},atk_down:{length:5,row:6},walk_down:{length:5,row:7},idle_down:{length:5,row:8}},offsetX:-8,offsetY:-24},{id:"icebat",idleSpeed:100,width:32,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:5,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:5,row:4},idle_up:{length:5,row:5},atk_down:{length:5,row:6},walk_down:{length:5,row:7},idle_down:{length:5,row:8}},offsetX:-8,offsetY:-24},{id:"beachnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"bearseonbiarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"beautifullife",width:32,height:32,offsetX:-8,offsetY:-12},{id:"beearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"bee",width:20,height:19,animations:{death:{length:1,row:4},atk_right:{length:4,row:1},walk_right:{length:4,row:1},idle_right:{length:2,row:1},atk_up:{length:4,row:3},idle_up:{length:2,row:3},walk_up:{length:4,row:3},atk_down:{length:4,row:2},walk_down:{length:4,row:2},idle_down:{length:2,row:2}},offsetX:-8,offsetY:-8},{id:"beetlearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"beetle",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-54},{id:"blackpirateskeleton",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-8,offsetY:-15},{id:"blackspiderarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"blackwizard",width:48,height:48,offsetX:-16,offsetY:-22},{id:"icewizard",width:48,height:48,offsetX:-16,offsetY:-22},{id:"ancientwizard",width:48,height:48,offsetX:-16,offsetY:-22},{id:"blazespider",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-22},{id:"bloodbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"bluebikinigirlnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"greencockroach",width:42,height:42,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:3,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:3,row:7},idle_down:{length:2,row:8}},offsetX:-14,offsetY:-21},{id:"bluedamboarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"piratearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"greenpiratearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"purplepiratearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"redpiratearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"bluepreta",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"bluescimitar",width:32,height:32,offsetX:-8,offsetY:-12},{id:"bluestoremannpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"bluesword",width:48,height:48,offsetX:-16,offsetY:-20},{id:"bluewingarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"bluewingarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"boss",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:3,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-36},{id:"boxingman",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"breaker",width:48,height:48,offsetX:-17,offsetY:-21},{id:"samuraiarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"bronzemedal",width:12,height:12},{id:"brownmouse",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-8},{id:"bucklerbenef",width:32,height:32,animations:{atk_right:{length:10,row:0},walk_right:{length:10,row:0},idle_right:{length:10,row:0},atk_up:{length:10,row:0},walk_up:{length:10,row:0},idle_up:{length:10,row:0},atk_down:{length:10,row:0},walk_down:{length:10,row:0},idle_down:{length:10,row:0}},offsetX:-9,offsetY:-32},{id:"burgerarmor",width:32,height:32,offsetX:-8,offsetY:-16},{id:"butcherknife",width:48,height:48,offsetX:-17,offsetY:-21},{id:"cactusaxe",width:48,height:48,offsetX:-17,offsetY:-21},{id:"goldaxe",width:48,height:48,offsetX:-17,offsetY:-21},{id:"carnelianaxe",width:48,height:48,offsetX:-17,offsetY:-21},{id:"cactus",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:3,row:1},idle_right:{length:1,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:1,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:1,row:8}},offsetX:-16,offsetY:-28},{id:"wolfsword",width:48,height:48,offsetX:-17,offsetY:-21},{id:"deathflail",width:48,height:48,offsetX:-17,offsetY:-21},{id:"candybar",width:48,height:48,offsetX:-17,offsetY:-21},{id:"candybow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"captainbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"catarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"cat",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:4,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:4,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:4,row:8}},offsetX:-16,offsetY:-25},{id:"cheoliarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"cheoliarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"chest",animations:{idle_down:{length:1,row:0}},offsetX:0,offsetY:0},{id:"seachest",animations:{idle_down:{length:1,row:0}},offsetX:0,offsetY:0},{id:"christmasarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"clam",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:3,row:1},idle_right:{length:4,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"pickle",width:32,height:32,offsetX:-8,offsetY:-12},{id:"picklemob",width:32,height:32,offsetX:-8,offsetY:-12},{id:"clotharmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"magicarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"metalscarabarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"superheroarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"tigerarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"ghost",width:32,height:32,offsetX:-8,offsetY:-12},{id:"cobra",width:28,height:28,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:6,row:8}},offsetX:-6,offsetY:-10},{id:"cockroachsuit",width:32,height:32,offsetX:-8,offsetY:-12},{id:"coder",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-7},{id:"cokearmor",width:32,height:32,offsetX:-8,offsetY:-16},{id:"combatuniform",width:32,height:32,offsetX:-8,offsetY:-12},{id:"comb",width:48,height:48,offsetX:-17,offsetY:-21},{id:"conferencecall",width:48,height:48,offsetX:-17,offsetY:-21},{id:"crab",width:32,height:32,idleSpeed:300,animations:{death:{length:8,row:0},atk_right:{length:7,row:1},walk_right:{length:6,row:2},idle_right:{length:4,row:3},atk_up:{length:8,row:4},idle_up:{length:4,row:5},walk_up:{length:6,row:6},atk_down:{length:8,row:7},walk_down:{length:6,row:8},idle_down:{length:7,row:9}},offsetX:-8,offsetY:-8},{id:"icecrab",width:32,height:32,idleSpeed:300,animations:{death:{length:8,row:0},atk_right:{length:7,row:1},walk_right:{length:6,row:2},idle_right:{length:4,row:3},atk_up:{length:8,row:4},idle_up:{length:4,row:5},walk_up:{length:6,row:6},atk_down:{length:8,row:7},walk_down:{length:6,row:8},idle_down:{length:7,row:9}},offsetX:-8,offsetY:-8},{id:"effect-critical",width:48,height:48,animations:{effect:{length:10,row:0}},offsetX:-17,offsetY:-21},{id:"crystalarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"crystalarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"crystalbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"crystalscorpion",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-24,offsetY:-32},{id:"cursedhahoemask",width:64,height:72,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-21,offsetY:-49},{id:"cursedjangseung",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-30},{id:"damboarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"darkogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-25},{id:"darkregionillusion",width:42,height:42,offsetX:-14,offsetY:-21},{id:"darkregion",width:42,height:42,offsetX:-14,offsetY:-21},{id:"darkscorpion",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-24,offsetY:-32},{id:"darkskeleton",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-16,offsetY:-22},{id:"daywalker",width:48,height:48,offsetX:-17,offsetY:-21},{id:"deathbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"death",width:24,height:24,animations:{death:{length:6,row:0}},offsetX:-4,offsetY:-4},{id:"deathknight",width:42,height:42,offsetX:-13,offsetY:-17},{id:"desertnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"desertscorpion",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-24,offsetY:-32},{id:"devilkazyaarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"devilkazya",width:32,height:32,offsetX:-8,offsetY:-12},{id:"devilkazyasword",width:48,height:48,offsetX:-17,offsetY:-21},{id:"dinosaurarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"doctor",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"dovakinarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"dovakinarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"dragonarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"earthworm",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:3,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-16,offsetY:-22},{id:"elfnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"eliminator",width:42,height:42,offsetX:-14,offsetY:-21},{id:"enelarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"enel",width:32,height:32,offsetX:-8,offsetY:-12},{id:"eneltrident",width:32,height:32,offsetX:-8,offsetY:-12},{id:"evilarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"eye",width:40,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:14,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:14,row:5},atk_down:{length:8,row:6},walk_down:{length:4,row:7},idle_down:{length:14,row:8}},offsetX:-12,offsetY:-18},{id:"fairynpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"fallenarcherarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"fallenarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"firebenef",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:5,row:0},idle_right:{length:5,row:0},atk_up:{length:5,row:0},walk_up:{length:5,row:0},idle_up:{length:5,row:0},atk_down:{length:5,row:0},walk_down:{length:5,row:0},idle_down:{length:5,row:0}},offsetX:-17,offsetY:-21},{id:"firefox",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:8,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"fireplay",width:48,height:48,offsetX:-17,offsetY:-21},{id:"fireshot",width:48,height:48,offsetX:-17,offsetY:-21},{id:"firespider",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-22},{id:"firesword",width:48,height:48,offsetX:-17,offsetY:-21},{id:"firstsonangelnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"fisherman",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"effect-flaredance",width:48,height:48,animations:{effect:{length:4,row:0}},offsetX:-17,offsetY:-21},{id:"effect-feathers",width:48,height:48,animations:{effect:{length:7,row:0}},offsetX:-17,offsetY:-21},{id:"flaredeathknight",width:42,height:42,offsetX:-13,offsetY:-17},{id:"fluffy",width:28,height:32,animations:{death:{length:1,row:8},atk_right:{length:4,row:7},walk_right:{length:6,row:3},idle_right:{length:1,row:3},atk_up:{length:4,row:6},idle_up:{length:1,row:2},walk_up:{length:6,row:2},atk_down:{length:4,row:4},walk_down:{length:6,row:0},idle_down:{length:1,row:0}},offsetX:-8,offsetY:-8},{id:"forestbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"forestdragon",width:64,height:72,animations:{atk_right:{length:7,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:7,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:7,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-30,offsetY:-30},{id:"forestguardiansword",width:48,height:48,offsetX:-17,offsetY:-21},{id:"forestnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"frankensteinarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"friedpotatoarmor",width:32,height:32,offsetX:-8,offsetY:-16},{id:"frogarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"frog",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:3,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-8,offsetY:-13},{id:"frostarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"frostqueen",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-16,offsetY:-22},{id:"gayarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"gayarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"gaybow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"gbwingarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"gbwingarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"ghostrider",width:32,height:32,offsetX:-8,offsetY:-12},{id:"goblin",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-9},{id:"goldenarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"goldenarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"platinumarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"goldenbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"goldensword",width:48,height:48,offsetX:-16,offsetY:-20},{id:"platinumsword",width:48,height:48,offsetX:-16,offsetY:-20},{id:"goldgolem",width:32,height:32,offsetX:-8,offsetY:-24},{id:"goldmedal",width:12,height:12},{id:"crown-artist",width:16,height:16},{id:"crown-tier1",width:16,height:16},{id:"crown-tier2",width:16,height:16},{id:"crown-tier3",width:16,height:16},{id:"crown-tier4",width:16,height:16},{id:"crown-tier5",width:16,height:16},{id:"crown-tier6",width:16,height:16},{id:"crown-tier7",width:17,height:16},{id:"pointer",width:32,height:32},{id:"golem",width:32,height:32,offsetX:-8,offsetY:-17},{id:"greenarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"greenarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"greenbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"greendamboarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"greenfish",width:32,height:32,offsetX:-5,offsetY:-13},{id:"greenlightbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"greenlightsaber",width:48,height:48,offsetX:-17,offsetY:-21},{id:"greenpirateskeleton",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-8,offsetY:-15},{id:"greenwingarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"greenwingarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"guardarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"guardarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"guardmace",width:32,height:32,offsetX:-8,offsetY:-12},{id:"guardsword",width:32,height:32,offsetX:-8,offsetY:-12},{id:"guard",width:25,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-5,offsetY:-8},{id:"guard2",width:32,height:32,animations:{idle_down:{length:2,row:0}},offsetX:-8,offsetY:-12},{id:"royalguard",width:25,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-5,offsetY:-8},{id:"royalguard2",width:32,height:32,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-20},{id:"royalguard3",width:32,height:32,animations:{idle_down:{length:2,row:0}},offsetX:-12,offsetY:-20},{id:"ratnpc",width:32,height:32,animations:{idle_down:{length:4,row:0}},offsetX:-8,offsetY:-10},{id:"halberd",width:48,height:48,offsetX:-17,offsetY:-21},{id:"halloweenjkarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"hammer",width:32,height:32,offsetX:-8,offsetY:-12},{id:"hand",width:14,height:14,animations:{idle_down:{length:1,row:0}}},{id:"cooking",width:16,height:16,animations:{idle_down:{length:1,row:0}}},{id:"smithing",width:16,height:16,animations:{idle_down:{length:1,row:0}}},{id:"crafting",width:16,height:16,animations:{idle_down:{length:1,row:0}}},{id:"foraging",width:16,height:16,animations:{idle_down:{length:1,row:0}}},{id:"fishing",width:16,height:16,animations:{idle_down:{length:1,row:0}}},{id:"effect-heal2",width:32,height:32,animations:{effect:{length:10,row:0}},offsetX:-8,offsetY:-10},{id:"hellspider",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-33},{id:"hermitcrab",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-8,offsetY:-10},{id:"hobgoblin",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-7,offsetY:-13},{id:"hongcheolarmor",width:32,height:32,offsetX:-8,offsetY:-15},{id:"hongcheol",width:32,height:32,offsetX:-8,offsetY:-15},{id:"huniarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"hunterbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"iamverycoldnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"oldlady",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"oldlady2",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"iceelfnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"guildnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"picklenpc",width:16,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-2,offsetY:-8},{id:"santaelfnpc",width:16,height:24,animations:{idle_down:{length:2,row:0}},offsetX:0,offsetY:-10},{id:"icegolem",width:32,height:32,offsetX:-5,offsetY:-12},{id:"iceknight",width:42,height:42,offsetX:-13,offsetY:-17},{id:"icerose",width:32,height:32,offsetX:-8,offsetY:-13},{id:"icevulture",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-25},{id:"infectedguard",width:32,height:32,offsetX:-7,offsetY:-13},{id:"ironbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"ironknightarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"ironogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-25},{id:"lightningguardian",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-49},{id:"jirisanmoonbear",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-26},{id:"justicebow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"justicehammer",width:48,height:48,offsetX:-17,offsetY:-21},{id:"kaonashi",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-22},{id:"king",width:32,height:32,animations:{idle_down:{length:2,row:0}},offsetX:-8,offsetY:-12},{id:"king2",width:32,height:32,animations:{idle_down:{length:2,row:0}},offsetX:-8,offsetY:-12},{id:"lavanpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"leatherarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"leatherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"legolasarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"windguardian",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-49},{id:"livingarmor",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-7,offsetY:-13},{id:"loot",width:14,height:14,animations:{idle_down:{length:1,row:0}}},{id:"machete",width:48,height:48,offsetX:-16,offsetY:-20},{id:"magicspear",width:52,height:48,offsetX:-19,offsetY:-21},{id:"mailarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mailarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mantis",width:42,height:42,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-14,offsetY:-21},{id:"marinebow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"memme",width:48,height:48,offsetX:-17,offsetY:-21},{id:"mermaidbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"mermaid",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"mermaidnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"mimic",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:1,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:1,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:1,row:8}},offsetX:-8,offsetY:-11},{id:"minidragon",width:32,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-8,offsetY:-22},{id:"miniemperor",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"miniiceknight1",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniiceknight2",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniiceknight3",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniiceknight4",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniiceknight5",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniknight1",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniknight2",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniknight3",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniknight4",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniknight5",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniknight6",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"miniseadragonarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"miniseadragon",width:32,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-8,offsetY:-22},{id:"mojojojonpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"moleking",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"momangelnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"morningstar",width:38,height:38,offsetX:-11,offsetY:-15},{id:"nightmareregion",width:42,height:42,offsetX:-14,offsetY:-21},{id:"ninjaarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"nyan",width:49,height:24,animations:{idle_down:{length:6,row:0}},offsetX:-22,offsetY:-6},{id:"octocat",width:32,height:32,animations:{idle_down:{length:4,row:0}},offsetX:-8,offsetY:-12},{id:"octopus",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"oddeyecat",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"ogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-24},{id:"ogrelord",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-25},{id:"hellhound",width:64,height:72,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-48},{id:"oldogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-25},{id:"orc",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-13},{id:"paewoldo",width:48,height:48,offsetX:-17,offsetY:-21},{id:"pain",width:32,height:32,offsetX:-8,offsetY:-12},{id:"paladinarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"penguin",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-25},{id:"pierrot",width:32,height:32,offsetX:-5,offsetY:-13},{id:"pinkcockroacharmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"pinkelf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"pinksword",width:48,height:48,offsetX:-17,offsetY:-21},{id:"piratearcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"blackpiratearcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"greenpiratearcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"purplepiratearcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"redpiratearcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"piratecaptain",width:64,height:64,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-36},{id:"pirategirlnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"pirateking",width:32,height:32,offsetX:-8,offsetY:-12},{id:"pirateskeleton",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-5,offsetY:-13},{id:"plasticbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"platearcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"platearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"plunger",width:48,height:48,offsetX:-17,offsetY:-21},{id:"poisonspider",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-22},{id:"portalarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"powerarmour",width:32,height:32,offsetX:-8,offsetY:-12},{id:"powersword",width:48,height:48,offsetX:-16,offsetY:-20},{id:"preta",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"priest",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"effect-provocation",width:32,height:64,animations:{effect:{length:10,row:0}},offsetX:-8,offsetY:-42},{id:"purplecloudkallege",width:48,height:48,offsetX:-17,offsetY:-21},{id:"purplepreta",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"queenant",width:64,height:72,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-54},{id:"queenspider",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-13},{id:"rabbitarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"radisharmor",width:32,height:32,offsetX:-8,offsetY:-17},{id:"rainbowapro",width:32,height:32,offsetX:-8,offsetY:-12},{id:"rainbowsword",width:48,height:48,offsetX:-17,offsetY:-21},{id:"ratarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"ratarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"rat",width:48,height:48,idleSpeed:250,animations:{death:{length:4,row:0},atk_right:{length:6,row:1},walk_right:{length:3,row:2},idle_right:{length:2,row:3},atk_up:{length:4,row:4},walk_up:{length:4,row:5},idle_up:{length:4,row:6},atk_down:{length:4,row:7},walk_down:{length:4,row:8},idle_down:{length:4,row:9}}},{id:"icerat",width:48,height:48,idleSpeed:200,animations:{death:{length:4,row:0},atk_right:{length:6,row:1},walk_right:{length:3,row:2},idle_right:{length:2,row:3},atk_up:{length:4,row:4},walk_up:{length:4,row:5},idle_up:{length:4,row:6},atk_down:{length:4,row:7},walk_down:{length:4,row:8},idle_down:{length:4,row:9}}},{id:"redarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"redarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"bluearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"redbikinigirlnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"redbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"redcockroach",width:42,height:42,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:3,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:3,row:7},idle_down:{length:2,row:8}},offsetX:-14,offsetY:-21},{id:"reddamboarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"redelf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"redenelbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"redfish",width:32,height:32,offsetX:-5,offsetY:-13},{id:"redguardarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"redguardarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"redguard",width:32,height:32,offsetX:-8,offsetY:-13},{id:"redlightbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"redlightsaber",width:48,height:48,offsetX:-17,offsetY:-21},{id:"redmetalbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"redmetalsword",width:48,height:48,offsetX:-17,offsetY:-21},{id:"redmouse",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-8},{id:"redpirateskeleton",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-16,offsetY:-23},{id:"redsicklebow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"redsickle",width:48,height:48,offsetX:-17,offsetY:-21},{id:"redstoremannpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"purplestoremannpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"greenstoremannpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"redsword",width:48,height:48,offsetX:-16,offsetY:-20},{id:"icesword",width:48,height:48,offsetX:-16,offsetY:-20},{id:"redwingarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"redwingarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"regionarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"regionhenchman",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:5,row:7},idle_down:{length:2,row:8}},offsetX:-24,offsetY:-39},{id:"rhaphidophoridae",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-22},{id:"rick",width:32,height:32,animations:{idle_down:{length:4,row:0}},offsetX:-8,offsetY:-12},{id:"robotarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"rosebow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"rose",width:32,height:32,offsetX:-8,offsetY:-13},{id:"rudolfarmor",width:32,height:32,offsetX:-8,offsetY:-16},{id:"rudolf",width:42,height:42,offsetX:-14,offsetY:-21},{id:"santaelf",width:32,height:32,offsetX:-8,offsetY:-12},{id:"santa",width:64,height:72,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-24,offsetY:-55},{id:"schooluniform",width:32,height:32,offsetX:-8,offsetY:-12},{id:"scientist",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"scimitar",width:32,height:32,offsetX:-8,offsetY:-12},{id:"seadragonarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"seadragon",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-39},{id:"seahorsebow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"searage",width:48,height:48,offsetX:-17,offsetY:-21},{id:"secondsonangelnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"shadow16",width:16,height:16},{id:"shadowregionarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"shadowregion",width:42,height:42,offsetX:-14,offsetY:-21},{id:"shepherdboy",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"shieldbenef",width:32,height:30,animations:{atk_right:{length:8,row:0},walk_right:{length:8,row:0},idle_right:{length:8,row:0},atk_up:{length:8,row:0},walk_up:{length:8,row:0},idle_up:{length:8,row:0},atk_down:{length:8,row:0},walk_down:{length:8,row:0},idle_down:{length:8,row:0}},offsetX:-6,offsetY:-10},{id:"sicklebow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"sickle",width:48,height:48,offsetX:-17,offsetY:-21},{id:"sidesword",width:48,height:48,offsetX:-16,offsetY:-25},{id:"silvermedal",width:12,height:12},{id:"skeleton2",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-16,offsetY:-20},{id:"skeleton",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-16,offsetY:-20},{id:"skeletonking",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:3,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-36},{id:"skydinosaur",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:5,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-49},{id:"skyelf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"skylightbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"skylightsaber",width:48,height:48,offsetX:-17,offsetY:-21},{id:"slime",width:32,height:32,offsetX:-6,offsetY:-12},{id:"smalldevil",width:42,height:42,animations:{atk_right:{length:4,row:0},walk_right:{length:2,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:2,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:2,row:7},idle_down:{length:2,row:8}},offsetX:-14,offsetY:-16},{id:"snek",width:28,height:28,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:6,row:8}},offsetX:-6,offsetY:-10},{id:"snowelf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"snowfoxarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"snowfoxarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"snowlady",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-25},{id:"snowmanarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"snowman",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:3,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-5,offsetY:-13},{id:"snowrabbit",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-13},{id:"snowshepherdboy",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"snowwolf",width:42,height:42,offsetX:-14,offsetY:-21},{id:"soldierant",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-27},{id:"soldier",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"sorcerer",width:26,height:26,animations:{idle_down:{length:6,row:0}},offsetX:-5,offsetY:-9},{id:"soybeanbug",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-30},{id:"sparks",offsetX:0,offsetY:0},{id:"spear",width:32,height:32,offsetX:-8,offsetY:-12},{id:"spectre",width:34,height:34,animations:{atk_right:{length:8,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:8,row:4},idle_up:{length:8,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-9,offsetY:-13},{id:"spider",width:35,height:35,animations:{death:{length:1,row:8},atk_right:{length:2,row:7},walk_right:{length:5,row:3},idle_right:{length:1,row:3},atk_up:{length:2,row:6},idle_up:{length:1,row:2},walk_up:{length:5,row:2},atk_down:{length:2,row:4},walk_down:{length:5,row:0},idle_down:{length:1,row:0}},offsetX:-8,offsetY:-8},{id:"sponge",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"squeakyhammer",width:32,height:32,offsetX:-8,offsetY:-12},{id:"squidarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"squid",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-30},{id:"effect-stun",width:48,height:48,animations:{effect:{length:6,row:0}},offsetX:-15,offsetY:-38},{id:"suicideghost",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-30},{id:"effect-supercat",width:32,height:64,animations:{effect:{length:10,row:0}},offsetX:-8,offsetY:-42},{id:"superiorangelnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"sword1",width:32,height:32,offsetX:-8,offsetY:-12},{id:"sword2",width:48,height:48,offsetX:-16,offsetY:-20},{id:"fishingpole",width:32,height:32,offsetX:-8,offsetY:-12},{id:"lightningscimitar",width:48,height:48,offsetX:-16,offsetY:-20},{id:"sword",width:14,height:14,animations:{idle_down:{length:1,row:0}}},{id:"taekwondo",width:32,height:32,offsetX:-8,offsetY:-12},{id:"talk",width:14,height:14,animations:{idle_down:{length:1,row:0}}},{id:"axe_cursor",width:14,height:14,animations:{idle_down:{length:1,row:0}}},{id:"pickaxe_cursor",width:14,height:14,animations:{idle_down:{length:1,row:0}}},{id:"target",animations:{move:{length:4,row:0},atk:{length:4,row:1}}},{id:"thiefarmor",width:32,height:32,offsetX:-8,offsetY:-13},{id:"tigerarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"trident",width:32,height:32,offsetX:-8,offsetY:-12},{id:"typhoon",width:48,height:48,offsetX:-17,offsetY:-21},{id:"vampire",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"vendingmachine",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"villagegirl",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"villagegirl2",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"villagegirl3",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"villager",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"miner",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"violetbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"vulture",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-25},{id:"watermelonbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"staff",width:48,height:48,offsetX:-17,offsetY:-21},{id:"lightningstaff",width:48,height:48,offsetX:-17,offsetY:-21},{id:"naturestaff",width:48,height:48,offsetX:-17,offsetY:-21},{id:"firestaff",width:48,height:48,offsetX:-17,offsetY:-21},{id:"icestaff",width:48,height:48,offsetX:-17,offsetY:-21},{id:"whip",width:48,height:48,offsetX:-17,offsetY:-21},{id:"whitearcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"whitearmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"whitebear",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-16,offsetY:-22},{id:"whitemouse",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-8},{id:"whitetiger",width:64,height:72,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:4,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-54},{id:"wizard",width:26,height:26,animations:{death:{length:3,row:0},atk_right:{length:4,row:1},atk_up:{length:4,row:2},atk_down:{length:4,row:3},walk_right:{length:4,row:4},walk_up:{length:4,row:5},walk_down:{length:4,row:6},idle_right:{length:6,row:7},idle_up:{length:6,row:8},idle_down:{length:6,row:9}},offsetX:-5,offsetY:-9},{id:"wizardrobe",width:32,height:32,offsetX:-8,offsetY:-12},{id:"bluewizardrobe",width:32,height:32,offsetX:-8,offsetY:-12},{id:"darkwizardrobe",width:32,height:32,offsetX:-8,offsetY:-12},{id:"darkwolf",width:42,height:42,offsetX:-14,offsetY:-21},{id:"greenwizardrobe",width:32,height:32,offsetX:-8,offsetY:-12},{id:"orangewizardrobe",width:32,height:32,offsetX:-8,offsetY:-12},{id:"wolfarcherarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"wolfarmor",width:32,height:32,offsetX:-8,offsetY:-12},{id:"wolf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:3,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-8,offsetY:-13},{id:"woodenbow",width:48,height:48,offsetX:-17,offsetY:-21},{id:"yellowbat",width:32,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:5,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:5,row:4},idle_up:{length:5,row:5},atk_down:{length:5,row:6},walk_down:{length:5,row:7},idle_down:{length:5,row:8}},offsetX:-8,offsetY:-24},{id:"yellowfish",width:32,height:32,offsetX:-5,offsetY:-13},{id:"yellowmouse",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-8},{id:"yellowpreta",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"zombiegf",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"zombie",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"redbikinigirlnpc",width:24,height:24,animations:{idle_down:{length:2,row:0}},offsetX:-4,offsetY:-8},{id:"projectile-fireball",idleSpeed:75,width:48,height:48,animations:{travel:{length:8,row:0}},offsetX:-24,offsetY:-24},{id:"projectile-fireball2",idleSpeed:75,width:48,height:48,animations:{travel:{length:8,row:0}},offsetX:-24,offsetY:-24},{id:"projectile-iceball",idleSpeed:75,width:48,height:48,animations:{travel:{length:8,row:0}},offsetX:-24,offsetY:-24},{id:"projectile-bluelightning",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectile-redlightning",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectile-greenbolt",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectile-purplebolt",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectile-yellowlightning",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectile-poisonball",width:40,height:40,animations:{travel:{length:10,row:0}},offsetX:-18,offsetY:-17},{id:"projectile-boulder",idleSpeed:75,width:32,height:32,animations:{travel:{length:8,row:0}}},{id:"projectile-arrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-firearrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-poisonarrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-icearrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-lightningarrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-nisocarrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-cinnabararrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-pythararrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-iboarrow",idleSpeed:75,width:16,height:16,animations:{travel:{length:4,row:0}},offsetX:0,offsetY:0},{id:"projectile-none",idleSpeed:75,width:64,height:64,animations:{travel:{length:1,row:0}},offsetX:-32,offsetY:-32},{id:"projectile-tornado",idleSpeed:75,width:48,height:64,animations:{travel:{length:8,row:0}},offsetX:-29,offsetY:-37},{id:"projectile-terror",idleSpeed:75,width:64,height:64,animations:{travel:{length:8,row:0}},offsetX:-32,offsetY:-32},{id:"projectile-gift",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetX:-16,offsetY:-24},{id:"projectile-gift2",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetX:-16,offsetY:-24},{id:"projectile-gift3",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetX:-16,offsetY:-24},{id:"projectile-gift4",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetX:-16,offsetY:-24},{id:"projectile-gift5",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetX:-16,offsetY:-24},{id:"projectile-gift6",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetX:-16,offsetY:-24},{id:"effect-fireball",width:48,height:48,animations:{effect:{length:8,row:0}},offsetX:-17,offsetY:-16},{id:"effect-poisonball",width:40,height:40,animations:{effect:{length:10,row:0}},offsetX:-13,offsetY:-14},{id:"effect-burn",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8,offsetY:-16},{id:"effect-freeze",width:32,height:32,animations:{effect:{length:6,row:0}},offsetX:-8,offsetY:-16},{id:"effect-lavaball",width:48,height:48,animations:{effect:{length:8,row:0}},offsetX:-16,offsetY:-24},{id:"effect-heal",width:48,height:48,animations:{effect:{length:8,row:0}}},{id:"effect-iceball",width:48,height:48,animations:{effect:{length:9,row:0}},offsetX:-18,offsetY:-15},{id:"effect-boulder",width:32,height:32,animations:{effect:{length:7,row:0}},offsetX:-9,offsetY:-12},{id:"spell",animations:{idle_down:{length:1,row:0}}},{id:"bow",animations:{idle_down:{length:1,row:0}}},{id:"effect-terror",width:64,height:64,animations:{effect:{length:8,row:0}},offsetX:-24,offsetY:-32},{id:"effect-terror2",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8,offsetY:-16},{id:"icegoblin",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-7,offsetY:-13},{id:"items/accuracypotion",offsetX:0,offsetY:0},{id:"items/adhererarcherarmor",offsetX:0,offsetY:0},{id:"items/adhererrobe",offsetX:0,offsetY:0},{id:"items/adminarmor",offsetX:0,offsetY:0},{id:"items/apple",offsetX:0,offsetY:0},{id:"items/archerarmor",offsetX:0,offsetY:0},{id:"items/archerschooluniform",offsetX:0,offsetY:0},{id:"items/arrow",offsetX:0,offsetY:0},{id:"items/avocado",offsetX:0,offsetY:0},{id:"items/axe",offsetX:0,offsetY:0},{id:"items/bamboospear",offsetX:0,offsetY:0},{id:"items/banana",offsetX:0,offsetY:0},{id:"items/barley",offsetX:0,offsetY:0},{id:"items/basket",offsetX:0,offsetY:0},{id:"items/bastardsword",offsetX:0,offsetY:0},{id:"items/bead",offsetX:0,offsetY:0},{id:"items/bearseonbiarmor",offsetX:0,offsetY:0},{id:"items/beautifullife",offsetX:0,offsetY:0},{id:"items/beearmor",offsetX:0,offsetY:0},{id:"items/beer",offsetX:0,offsetY:0},{id:"items/beermug",offsetX:0,offsetY:0},{id:"items/beetlearmor",offsetX:0,offsetY:0},{id:"items/bigflask",offsetX:0,offsetY:0},{id:"items/bigmanaflask",offsetX:0,offsetY:0},{id:"items/blackberry",offsetX:0,offsetY:0},{id:"items/blackpiratearcherarmor",offsetX:0,offsetY:0},{id:"items/blackpotion",offsetX:0,offsetY:0},{id:"items/blackspiderarmor",offsetX:0,offsetY:0},{id:"items/bloodbow",offsetX:0,offsetY:0},{id:"items/bloodwoodlogs",offsetX:0,offsetY:0},{id:"items/bluearmor",offsetX:0,offsetY:0},{id:"items/blueberry",offsetX:0,offsetY:0},{id:"items/bluebow",offsetX:0,offsetY:0},{id:"items/bluedamboarmor",offsetX:0,offsetY:0},{id:"items/bluelily",offsetX:0,offsetY:0},{id:"items/bluescimitar",offsetX:0,offsetY:0},{id:"items/bluesword",offsetX:0,offsetY:0},{id:"items/bluewingarcherarmor",offsetX:0,offsetY:0},{id:"items/bluewingarmor",offsetX:0,offsetY:0},{id:"items/bluewizardrobe",offsetX:0,offsetY:0},{id:"items/book",offsetX:0,offsetY:0},{id:"items/boostpotion",offsetX:0,offsetY:0},{id:"items/borth",offsetX:0,offsetY:0},{id:"items/bowcommon",offsetX:0,offsetY:0},{id:"items/bowlimb",offsetX:0,offsetY:0},{id:"items/bowrare",offsetX:0,offsetY:0},{id:"items/string",offsetX:0,offsetY:0},{id:"items/bowuncommon",offsetX:0,offsetY:0},{id:"items/branch",offsetX:0,offsetY:0},{id:"items/breaker",offsetX:0,offsetY:0},{id:"items/bronzebar",offsetX:0,offsetY:0},{id:"items/bronzeore",offsetX:0,offsetY:0},{id:"items/bucket",offsetX:0,offsetY:0},{id:"items/burger",offsetX:0,offsetY:0},{id:"items/burgerarmor",offsetX:0,offsetY:0},{id:"items/butcherknife",offsetX:0,offsetY:0},{id:"items/cactusaxe",offsetX:0,offsetY:0},{id:"items/cake",offsetX:0,offsetY:0},{id:"items/candybar",offsetX:0,offsetY:0},{id:"items/candybow",offsetX:0,offsetY:0},{id:"items/candykey",offsetX:0,offsetY:0},{id:"items/captainbow",offsetX:0,offsetY:0},{id:"items/carnelianaxe",offsetX:0,offsetY:0},{id:"items/catarmor",offsetX:0,offsetY:0},{id:"items/cd",offsetX:0,offsetY:0},{id:"items/cheese",offsetX:0,offsetY:0},{id:"items/cheoliarcherarmor",offsetX:0,offsetY:0},{id:"items/cheoliarmor",offsetX:0,offsetY:0},{id:"items/christmasarmor",offsetX:0,offsetY:0},{id:"items/cilantro",offsetX:0,offsetY:0},{id:"items/cinnabararrow",offsetX:0,offsetY:0},{id:"items/cinnabarore",offsetX:0,offsetY:0},{id:"items/clamobject",offsetX:0,offsetY:0},{id:"items/clamchowder",offsetX:0,offsetY:0},{id:"items/cloth",offsetX:0,offsetY:0},{id:"items/clotharmor",offsetX:0,offsetY:0},{id:"items/cloudberry",offsetX:0,offsetY:0},{id:"items/coal",offsetX:0,offsetY:0},{id:"items/cockroachsuit",offsetX:0,offsetY:0},{id:"items/cokearmor",offsetX:0,offsetY:0},{id:"items/comb",offsetX:0,offsetY:0},{id:"items/combatuniform",offsetX:0,offsetY:0},{id:"items/conferencecall",offsetX:0,offsetY:0},{id:"items/cookedbeef",offsetX:0,offsetY:0},{id:"items/cookedchicken",offsetX:0,offsetY:0},{id:"items/cookedpork",offsetX:0,offsetY:0},{id:"items/cookedsausage",offsetX:0,offsetY:0},{id:"items/cookedshrimp",offsetX:0,offsetY:0},{id:"items/copperbar",offsetX:0,offsetY:0},{id:"items/copperore",offsetX:0,offsetY:0},{id:"items/corn",offsetX:0,offsetY:0},{id:"items/crystalarcherarmor",offsetX:0,offsetY:0},{id:"items/crystalarmor",offsetX:0,offsetY:0},{id:"items/crystalbow",offsetX:0,offsetY:0},{id:"items/cure",offsetX:0,offsetY:0},{id:"items/damboarmor",offsetX:0,offsetY:0},{id:"items/dandelion",offsetX:0,offsetY:0},{id:"items/darkwizardrobe",offsetX:0,offsetY:0},{id:"items/daywalker",offsetX:0,offsetY:0},{id:"items/deathbow",offsetX:0,offsetY:0},{id:"items/deathflail",offsetX:0,offsetY:0},{id:"items/defencepotion",offsetX:0,offsetY:0},{id:"items/devilkazyaarmor",offsetX:0,offsetY:0},{id:"items/devilkazyasword",offsetX:0,offsetY:0},{id:"items/diamondring",offsetX:0,offsetY:0},{id:"items/dinosaurarmor",offsetX:0,offsetY:0},{id:"items/dolring",offsetX:0,offsetY:0},{id:"items/dovakinarcherarmor",offsetX:0,offsetY:0},{id:"items/dovakinarmor",offsetX:0,offsetY:0},{id:"items/dragonarmor",offsetX:0,offsetY:0},{id:"items/egg",offsetX:0,offsetY:0},{id:"items/element",offsetX:0,offsetY:0},{id:"items/emeraldpendant",offsetX:0,offsetY:0},{id:"items/emeraldring",offsetX:0,offsetY:0},{id:"items/enelarmor",offsetX:0,offsetY:0},{id:"items/eneltrident",offsetX:0,offsetY:0},{id:"items/essentialrage",offsetX:0,offsetY:0},{id:"items/evilarmor",offsetX:0,offsetY:0},{id:"items/fallenarcherarmor",offsetX:0,offsetY:0},{id:"items/fallenarmor",offsetX:0,offsetY:0},{id:"items/feather",offsetX:0,offsetY:0},{id:"items/firearrow",offsetX:0,offsetY:0},{id:"items/fireaxe",offsetX:0,offsetY:0},{id:"items/firebead",offsetX:0,offsetY:0},{id:"items/fireplay",offsetX:0,offsetY:0},{id:"items/firepotion",offsetX:0,offsetY:0},{id:"items/fireshot",offsetX:0,offsetY:0},{id:"items/firestaff",offsetX:0,offsetY:0},{id:"items/firesword",offsetX:0,offsetY:0},{id:"items/flask",offsetX:0,offsetY:0},{id:"items/forestbow",offsetX:0,offsetY:0},{id:"items/forestguardiansword",offsetX:0,offsetY:0},{id:"items/frankensteinarmor",offsetX:0,offsetY:0},{id:"items/friedpotatoarmor",offsetX:0,offsetY:0},{id:"items/frogarmor",offsetX:0,offsetY:0},{id:"items/frostarmor",offsetX:0,offsetY:0},{id:"items/frostring",offsetX:0,offsetY:0},{id:"items/gayarcherarmor",offsetX:0,offsetY:0},{id:"items/gayarmor",offsetX:0,offsetY:0},{id:"items/gaybow",offsetX:0,offsetY:0},{id:"items/gbwingarcherarmor",offsetX:0,offsetY:0},{id:"items/gbwingarmor",offsetX:0,offsetY:0},{id:"items/ghostrider",offsetX:0,offsetY:0},{id:"items/gold",offsetX:0,offsetY:0},{id:"items/goldaxe",offsetX:0,offsetY:0},{id:"items/goldbar",offsetX:0,offsetY:0},{id:"items/goldboots",offsetX:0,offsetY:0},{id:"items/goldenarcherarmor",offsetX:0,offsetY:0},{id:"items/goldenarmor",offsetX:0,offsetY:0},{id:"items/goldenbow",offsetX:0,offsetY:0},{id:"items/goldensword",offsetX:0,offsetY:0},{id:"items/goldnugget",offsetX:0,offsetY:0},{id:"items/goldore",offsetX:0,offsetY:0},{id:"items/goldring",offsetX:0,offsetY:0},{id:"items/gooseberry",offsetX:0,offsetY:0},{id:"items/greenarcherarmor",offsetX:0,offsetY:0},{id:"items/greenarmor",offsetX:0,offsetY:0},{id:"items/greenbow",offsetX:0,offsetY:0},{id:"items/greendamboarmor",offsetX:0,offsetY:0},{id:"items/greenlightbow",offsetX:0,offsetY:0},{id:"items/greenlightsaber",offsetX:0,offsetY:0},{id:"items/greenpendant",offsetX:0,offsetY:0},{id:"items/greenpiratearcherarmor",offsetX:0,offsetY:0},{id:"items/greenpiratearmor",offsetX:0,offsetY:0},{id:"items/greenwingarcherarmor",offsetX:0,offsetY:0},{id:"items/greenwingarmor",offsetX:0,offsetY:0},{id:"items/greenwizardrobe",offsetX:0,offsetY:0},{id:"items/guardarcherarmor",offsetX:0,offsetY:0},{id:"items/guardarmor",offsetX:0,offsetY:0},{id:"items/halberd",offsetX:0,offsetY:0},{id:"items/halloweenjkarmor",offsetX:0,offsetY:0},{id:"items/hammer",offsetX:0,offsetY:0},{id:"items/hongcheolarmor",offsetX:0,offsetY:0},{id:"items/hotsauce",offsetX:0,offsetY:0},{id:"items/huniarmor",offsetX:0,offsetY:0},{id:"items/hunterbow",offsetX:0,offsetY:0},{id:"items/iboarrow",offsetX:0,offsetY:0},{id:"items/iboore",offsetX:0,offsetY:0},{id:"items/icearrow",offsetX:0,offsetY:0},{id:"items/icebead",offsetX:0,offsetY:0},{id:"items/icelogs",offsetX:0,offsetY:0},{id:"items/icepalmlogs",offsetX:0,offsetY:0},{id:"items/icepinelogs",offsetX:0,offsetY:0},{id:"items/icerose",offsetX:0,offsetY:0},{id:"items/icestaff",offsetX:0,offsetY:0},{id:"items/icesword",offsetX:0,offsetY:0},{id:"items/ironbar",offsetX:0,offsetY:0},{id:"items/ironbow",offsetX:0,offsetY:0},{id:"items/ironknightarmor",offsetX:0,offsetY:0},{id:"items/ironore",offsetX:0,offsetY:0},{id:"items/jellyfish",offsetX:0,offsetY:0},{id:"items/jellyfishsmoothie",offsetX:0,offsetY:0},{id:"items/justicebow",offsetX:0,offsetY:0},{id:"items/justicehammer",offsetX:0,offsetY:0},{id:"items/kelp",offsetX:0,offsetY:0},{id:"items/kiwi",offsetX:0,offsetY:0},{id:"items/knife",offsetX:0,offsetY:0},{id:"items/lavaboots",offsetX:0,offsetY:0},{id:"items/leaf",offsetX:0,offsetY:0},{id:"items/leatherarcherarmor",offsetX:0,offsetY:0},{id:"items/leatherarmor",offsetX:0,offsetY:0},{id:"items/leatherboots",offsetX:0,offsetY:0},{id:"items/legolasarmor",offsetX:0,offsetY:0},{id:"items/lightningarrow",offsetX:0,offsetY:0},{id:"items/lightningbead",offsetX:0,offsetY:0},{id:"items/lightningscimitar",offsetX:0,offsetY:0},{id:"items/lightningstaff",offsetX:0,offsetY:0},{id:"items/logs",offsetX:0,offsetY:0},{id:"items/loveactring",offsetX:0,offsetY:0},{id:"items/machete",offsetX:0,offsetY:0},{id:"items/magicspear",offsetX:0,offsetY:0},{id:"items/mailarcherarmor",offsetX:0,offsetY:0},{id:"items/mailarmor",offsetX:0,offsetY:0},{id:"items/manaflask",offsetX:0,offsetY:0},{id:"items/mango",offsetX:0,offsetY:0},{id:"items/berylpendant",offsetX:0,offsetY:0},{id:"items/marinebow",offsetX:0,offsetY:0},{id:"items/melon-slice",offsetX:0,offsetY:0},{id:"items/memme",offsetX:0,offsetY:0},{id:"items/mermaidbow",offsetX:0,offsetY:0},{id:"items/milkbottle",offsetX:0,offsetY:0},{id:"items/mineral",offsetX:0,offsetY:0},{id:"items/miniseadragonarmor",offsetX:0,offsetY:0},{id:"items/moonrockore",offsetX:0,offsetY:0},{id:"items/morningstar",offsetX:0,offsetY:0},{id:"items/mulberry",offsetX:0,offsetY:0},{id:"items/mushroom1",offsetX:0,offsetY:0},{id:"items/mushroom2",offsetX:0,offsetY:0},{id:"items/mushroom3",offsetX:0,offsetY:0},{id:"items/mushroom4",offsetX:0,offsetY:0},{id:"items/mushroom5",offsetX:0,offsetY:0},{id:"items/mushroom6",offsetX:0,offsetY:0},{id:"items/naturebead",offsetX:0,offsetY:0},{id:"items/naturestaff",offsetX:0,offsetY:0},{id:"items/ninjaarmor",offsetX:0,offsetY:0},{id:"items/nisocarrow",offsetX:0,offsetY:0},{id:"items/nisocore",offsetX:0,offsetY:0},{id:"items/nisocring",offsetX:0,offsetY:0},{id:"items/null",offsetX:0,offsetY:0},{id:"items/oat",offsetX:0,offsetY:0},{id:"items/onion",offsetX:0,offsetY:0},{id:"items/orange",offsetX:0,offsetY:0},{id:"items/orangewizardrobe",offsetX:0,offsetY:0},{id:"items/paewoldo",offsetX:0,offsetY:0},{id:"items/paladinarmor",offsetX:0,offsetY:0},{id:"items/palmlogs",offsetX:0,offsetY:0},{id:"items/peach",offsetX:0,offsetY:0},{id:"items/pearlpendant",offsetX:0,offsetY:0},{id:"items/pearlring",offsetX:0,offsetY:0},{id:"items/pendant1",offsetX:0,offsetY:0},{id:"items/pickaxe",offsetX:0,offsetY:0},{id:"items/pickle",offsetX:0,offsetY:0},{id:"items/pineapple",offsetX:0,offsetY:0},{id:"items/pinelogs",offsetX:0,offsetY:0},{id:"items/pinkcockroacharmor",offsetX:0,offsetY:0},{id:"items/pinksword",offsetX:0,offsetY:0},{id:"items/piratearcherarmor",offsetX:0,offsetY:0},{id:"items/piratearmor",offsetX:0,offsetY:0},{id:"items/pirateking",offsetX:0,offsetY:0},{id:"items/plasticbow",offsetX:0,offsetY:0},{id:"items/platearcherarmor",offsetX:0,offsetY:0},{id:"items/platearmor",offsetX:0,offsetY:0},{id:"items/platinumarmor",offsetX:0,offsetY:0},{id:"items/platinumsword",offsetX:0,offsetY:0},{id:"items/plum",offsetX:0,offsetY:0},{id:"items/plunger",offsetX:0,offsetY:0},{id:"items/poisonarrow",offsetX:0,offsetY:0},{id:"items/poisonaxe",offsetX:0,offsetY:0},{id:"items/portalarmor",offsetX:0,offsetY:0},{id:"items/potato",offsetX:0,offsetY:0},{id:"items/powerarmour",offsetX:0,offsetY:0},{id:"items/powersword",offsetX:0,offsetY:0},{id:"items/purplecloudkallege",offsetX:0,offsetY:0},{id:"items/purplepiratearcherarmor",offsetX:0,offsetY:0},{id:"items/purplepiratearmor",offsetX:0,offsetY:0},{id:"items/pythararrow",offsetX:0,offsetY:0},{id:"items/pytharore",offsetX:0,offsetY:0},{id:"items/pytharring",offsetX:0,offsetY:0},{id:"items/quinoa",offsetX:0,offsetY:0},{id:"items/rabbitarmor",offsetX:0,offsetY:0},{id:"items/radisharmor",offsetX:0,offsetY:0},{id:"items/rainbowapro",offsetX:0,offsetY:0},{id:"items/rainbowsword",offsetX:0,offsetY:0},{id:"items/raspberry",offsetX:0,offsetY:0},{id:"items/ratarcherarmor",offsetX:0,offsetY:0},{id:"items/ratarmor",offsetX:0,offsetY:0},{id:"items/rawbeef",offsetX:0,offsetY:0},{id:"items/rawchicken",offsetX:0,offsetY:0},{id:"items/rawpork",offsetX:0,offsetY:0},{id:"items/rawsausage",offsetX:0,offsetY:0},{id:"items/rawshrimp",offsetX:0,offsetY:0},{id:"items/redarcherarmor",offsetX:0,offsetY:0},{id:"items/redarmor",offsetX:0,offsetY:0},{id:"items/redbow",offsetX:0,offsetY:0},{id:"items/reddamboarmor",offsetX:0,offsetY:0},{id:"items/redenelbow",offsetX:0,offsetY:0},{id:"items/redguardarcherarmor",offsetX:0,offsetY:0},{id:"items/redguardarmor",offsetX:0,offsetY:0},{id:"items/redlightbow",offsetX:0,offsetY:0},{id:"items/redlightsaber",offsetX:0,offsetY:0},{id:"items/redmetalbow",offsetX:0,offsetY:0},{id:"items/redmetalsword",offsetX:0,offsetY:0},{id:"items/redpiratearcherarmor",offsetX:0,offsetY:0},{id:"items/redpiratearmor",offsetX:0,offsetY:0},{id:"items/redsickle",offsetX:0,offsetY:0},{id:"items/redsicklebow",offsetX:0,offsetY:0},{id:"items/redsword",offsetX:0,offsetY:0},{id:"items/redwingarcherarmor",offsetX:0,offsetY:0},{id:"items/redwingarmor",offsetX:0,offsetY:0},{id:"items/regionarmor",offsetX:0,offsetY:0},{id:"items/rice",offsetX:0,offsetY:0},{id:"items/ring1",offsetX:0,offsetY:0},{id:"items/robotarmor",offsetX:0,offsetY:0},{id:"items/rock",offsetX:0,offsetY:0},{id:"items/rockfish",offsetX:0,offsetY:0},{id:"items/rose",offsetX:0,offsetY:0},{id:"items/rosebow",offsetX:0,offsetY:0},{id:"items/royalazalea",offsetX:0,offsetY:0},{id:"items/rubypendant",offsetX:0,offsetY:0},{id:"items/rubyring",offsetX:0,offsetY:0},{id:"items/rudolfarmor",offsetX:0,offsetY:0},{id:"items/rustedaxe",offsetX:0,offsetY:0},{id:"items/samuraiarmor",offsetX:0,offsetY:0},{id:"items/sapphirering",offsetX:0,offsetY:0},{id:"items/sausage",offsetX:0,offsetY:0},{id:"items/schooluniform",offsetX:0,offsetY:0},{id:"items/scimitar",offsetX:0,offsetY:0},{id:"items/seadragonarmor",offsetX:0,offsetY:0},{id:"items/seahorsebow",offsetX:0,offsetY:0},{id:"items/searage",offsetX:0,offsetY:0},{id:"items/seed",offsetX:0,offsetY:0},{id:"items/shadowregionarmor",offsetX:0,offsetY:0},{id:"items/shardt1",offsetX:0,offsetY:0},{id:"items/shardt2",offsetX:0,offsetY:0},{id:"items/shardt3",offsetX:0,offsetY:0},{id:"items/shardt4",offsetX:0,offsetY:0},{id:"items/shardt5",offsetX:0,offsetY:0},{id:"items/sickle",offsetX:0,offsetY:0},{id:"items/sicklebow",offsetX:0,offsetY:0},{id:"items/sidesword",offsetX:0,offsetY:0},{id:"items/silverring",offsetX:0,offsetY:0},{id:"items/skylightbow",offsetX:0,offsetY:0},{id:"items/skylightsaber",offsetX:0,offsetY:0},{id:"items/snowfoxarcherarmor",offsetX:0,offsetY:0},{id:"items/snowfoxarmor",offsetX:0,offsetY:0},{id:"items/snowmanarmor",offsetX:0,offsetY:0},{id:"items/snowpotion",offsetX:0,offsetY:0},{id:"items/spear",offsetX:0,offsetY:0},{id:"items/spiritring",offsetX:0,offsetY:0},{id:"items/sproutring",offsetX:0,offsetY:0},{id:"items/squeakyhammer",offsetX:0,offsetY:0},{id:"items/squidarmor",offsetX:0,offsetY:0},{id:"items/staff",offsetX:0,offsetY:0},{id:"items/steelboots",offsetX:0,offsetY:0},{id:"items/stew",offsetX:0,offsetY:0},{id:"items/stew2",offsetX:0,offsetY:0},{id:"items/stick",offsetX:0,offsetY:0},{id:"items/strawberry",offsetX:0,offsetY:0},{id:"items/strengthpotion",offsetX:0,offsetY:0},{id:"items/swiftboots",offsetX:0,offsetY:0},{id:"items/sword1",offsetX:0,offsetY:0},{id:"items/sword2",offsetX:0,offsetY:0},{id:"items/taekwondo",offsetX:0,offsetY:0},{id:"items/tamagotchiring",offsetX:0,offsetY:0},{id:"items/thiefarmor",offsetX:0,offsetY:0},{id:"items/tigerarmor",offsetX:0,offsetY:0},{id:"items/tinbar",offsetX:0,offsetY:0},{id:"items/tinore",offsetX:0,offsetY:0},{id:"items/tofu",offsetX:0,offsetY:0},{id:"items/token",offsetX:0,offsetY:0},{id:"items/tomato",offsetX:0,offsetY:0},{id:"items/topazring",offsetX:0,offsetY:0},{id:"items/trident",offsetX:0,offsetY:0},{id:"items/rawtuna",offsetX:0,offsetY:0},{id:"items/tunasushi",offsetX:0,offsetY:0},{id:"items/typhoon",offsetX:0,offsetY:0},{id:"items/undefined",offsetX:0,offsetY:0},{id:"items/violetbow",offsetX:0,offsetY:0},{id:"items/waterbucket",offsetX:0,offsetY:0},{id:"items/watermelon",offsetX:0,offsetY:0},{id:"items/watermelonbow",offsetX:0,offsetY:0},{id:"items/watermelonslice",offsetX:0,offsetY:0},{id:"items/whip",offsetX:0,offsetY:0},{id:"items/whitearcherarmor",offsetX:0,offsetY:0},{id:"items/whitearmor",offsetX:0,offsetY:0},{id:"items/willowlogs",offsetX:0,offsetY:0},{id:"items/wizardrobe",offsetX:0,offsetY:0},{id:"items/wolfarcherarmor",offsetX:0,offsetY:0},{id:"items/wolfarmor",offsetX:0,offsetY:0},{id:"items/wolfsword",offsetX:0,offsetY:0},{id:"items/woodenbow",offsetX:0,offsetY:0},{id:"items/amethyst",offsetX:0,offsetY:0},{id:"items/beryl",offsetX:0,offsetY:0},{id:"items/citrine",offsetX:0,offsetY:0},{id:"items/emerald",offsetX:0,offsetY:0},{id:"items/lapislazuli",offsetX:0,offsetY:0},{id:"items/opal",offsetX:0,offsetY:0},{id:"items/peridot",offsetX:0,offsetY:0},{id:"items/ruby",offsetX:0,offsetY:0},{id:"items/taaffeite",offsetX:0,offsetY:0},{id:"items/topaz",offsetX:0,offsetY:0},{id:"cinnamonbowlsmall",offsetX:0,offsetY:0},{id:"basil",offsetX:0,offsetY:0},{id:"basilbowlmedium",offsetX:0,offsetY:0},{id:"basilpowder",offsetX:0,offsetY:0},{id:"basilshaker",offsetX:0,offsetY:0},{id:"bayleaves",offsetX:0,offsetY:0},{id:"bayleavesbottle",offsetX:0,offsetY:0},{id:"bayleavesbowlmedium",offsetX:0,offsetY:0},{id:"blackpepperplant",offsetX:0,offsetY:0},{id:"bowlsmall",offsetX:0,offsetY:0},{id:"bowlmedium",offsetX:0,offsetY:0},{id:"cayennebowlsmall",offsetX:0,offsetY:0},{id:"cayennepepper",offsetX:0,offsetY:0},{id:"cayenneshaker",offsetX:0,offsetY:0},{id:"chilli",offsetX:0,offsetY:0},{id:"cinnamon",offsetX:0,offsetY:0},{id:"cinnamonbark",offsetX:0,offsetY:0},{id:"cinnamonshaker",offsetX:0,offsetY:0},{id:"cumin",offsetX:0,offsetY:0},{id:"cuminbowlsmall",offsetX:0,offsetY:0},{id:"cuminplant",offsetX:0,offsetY:0},{id:"cuminshaker",offsetX:0,offsetY:0},{id:"emptybottle",offsetX:0,offsetY:0},{id:"emptyshaker",offsetX:0,offsetY:0},{id:"ginderpowderbowlsmall",offsetX:0,offsetY:0},{id:"ginger",offsetX:0,offsetY:0},{id:"gingerbottle",offsetX:0,offsetY:0},{id:"gingerpowder",offsetX:0,offsetY:0},{id:"horseradish",offsetX:0,offsetY:0},{id:"horseradishbottle",offsetX:0,offsetY:0},{id:"horseradishbowlsmall",offsetX:0,offsetY:0},{id:"horseradishsmashedbowlsmall",offsetX:0,offsetY:0},{id:"lavender",offsetX:0,offsetY:0},{id:"lavenderbowlsmall",offsetX:0,offsetY:0},{id:"lavenderseeds",offsetX:0,offsetY:0},{id:"lavendershaker",offsetX:0,offsetY:0},{id:"mint",offsetX:0,offsetY:0},{id:"mintbowlsmall",offsetX:0,offsetY:0},{id:"mustardbottle",offsetX:0,offsetY:0},{id:"mustardbowlsmall",offsetX:0,offsetY:0},{id:"mustardplant",offsetX:0,offsetY:0},{id:"paprika",offsetX:0,offsetY:0},{id:"paprikabowlsmall",offsetX:0,offsetY:0},{id:"paprikapowder",offsetX:0,offsetY:0},{id:"paprikashaker",offsetX:0,offsetY:0},{id:"pepper",offsetX:0,offsetY:0},{id:"pepperbowlsmall",offsetX:0,offsetY:0},{id:"peppershaker",offsetX:0,offsetY:0},{id:"rosemary",offsetX:0,offsetY:0},{id:"rosemarybottle",offsetX:0,offsetY:0},{id:"rosemarybowlsmall",offsetX:0,offsetY:0},{id:"rosemarypowder",offsetX:0,offsetY:0},{id:"sage",offsetX:0,offsetY:0},{id:"sagebowlsmall",offsetX:0,offsetY:0},{id:"sagepowder",offsetX:0,offsetY:0},{id:"sageshaker",offsetX:0,offsetY:0},{id:"salt",offsetX:0,offsetY:0},{id:"saltbowlsmall",offsetX:0,offsetY:0},{id:"saltcrystal",offsetX:0,offsetY:0},{id:"saltshaker",offsetX:0,offsetY:0},{id:"vanila",offsetX:0,offsetY:0},{id:"vanillabottle",offsetX:0,offsetY:0},{id:"vanillabowlsmall",offsetX:0,offsetY:0},{id:"hilt1",offsetX:0,offsetY:0},{id:"hilt2",offsetX:0,offsetY:0}];class sc{constructor(){l(this,"sprites",{});l(this,"sparksAnimation",new je("idle_down",6,0,16,16));this.sparksAnimation.setSpeed(120),this.load()}load(){for(let t of rc){let e=new zs(t);this.sprites[t.id]=e}de.debug("Finished loading sprite data..."),this.preloadSprites()}preloadSprites(){this.get("death").load()}get(t){return this.sprites[t]}getDeath(){return this.get("death")}}class ac{constructor(){l(this,"direction")}reset(){this.direction=null}setUp(){this.direction=re.Up}setDown(){this.direction=re.Down}setRight(){this.direction=re.Right}setLeft(){this.direction=re.Left}getDirection(){return this.direction}}class oc extends Dl{constructor(e){super(e);l(this,"map");l(this,"lastStepX",-1);l(this,"lastStepY",-1);l(this,"game");l(this,"entities");this.map=e.game.map,this.game=e.game,this.entities=e.game.entities}handleRequestPath(e,n){var u;if(this.character.gridX===e&&this.character.gridY===n)return[];if(this.character.dead||this.character.frozen)return[];if(this.character.canAttackTarget()&&!this.character.trading)return[];let r=this.map.isObject(e,n);if(this.map.isColliding(e,n)&&!r)return[];this.game.socket.send(B.Movement,{opcode:Ct.Request,requestX:e,requestY:n,playerX:this.character.gridX,playerY:this.character.gridY,targetInstance:(u=this.character.target)==null?void 0:u.instance,following:this.character.following});let a=[],d="";return r&&(a.push({x:e,y:n}),d=this.map.getTileCursor(e,n),d==="fishing"&&a.push({x:e+1,y:n},{x:e-1,y:n},{x:e,y:n+1},{x:e,y:n-1})),this.game.findPath(this.character,e,n,a,d)}handleStartPathing(e){var n;[this.game.input.selectedX,this.game.input.selectedY]=e[e.length-1],this.character.moving=!0,this.game.input.selectedCellVisible=!0,this.game.socket.send(B.Movement,{opcode:Ct.Started,requestX:this.game.input.selectedX,requestY:this.game.input.selectedY,playerX:this.character.gridX,playerY:this.character.gridY,movementSpeed:this.character.movementSpeed,targetInstance:(n=this.character.target)==null?void 0:n.instance})}handleStopPathing(e,n){var r,a,d,u;this.entities.registerPosition(this.character),this.game.input.selectedCellVisible=!1,this.game.camera.clip(),this.game.socket.send(B.Movement,{opcode:Ct.Stop,playerX:this.character.gridX,playerY:this.character.gridY,targetInstance:((r=this.character.target)==null?void 0:r.instance)||((a=this.game.getEntityAt(e,n))==null?void 0:a.instance),orientation:this.character.orientation}),this.character.trading&&this.game.socket.send(B.Trade,{opcode:mt.Request,instance:(d=this.character.target)==null?void 0:d.instance}),this.game.socket.send(B.Target,[this.getTargetType(),((u=this.character.target)==null?void 0:u.instance)||""]),this.character.target&&(this.character.lookAt(this.character.target),this.character.target.isObject()&&this.character.removeTarget(),this.character.disableAction=!0),this.game.input.setPassiveTarget(),this.game.storage.setOrientation(this.character.orientation),this.game.renderer.resetAnimatedTiles(),this.character.moving=!1,this.character.trading=!1}handleStep(){this.character.hasNextStep()&&this.entities.registerPosition(this.character),this.game.camera.isCentered()||this.game.updateCameraBounds(),!(this.lastStepX===this.character.gridX&&this.lastStepY===this.character.gridY)&&(this.game.socket.send(B.Movement,{opcode:Ct.Step,playerX:this.character.gridX,playerY:this.character.gridY,timestamp:Date.now()}),this.lastStepX=this.character.gridX,this.lastStepY=this.character.gridY,this.character.canAttackTarget()&&!this.character.trading&&this.character.stop(!0))}handleSecondStep(){this.game.renderer.updateAnimatedTiles()}handleMove(){this.game.camera.isCentered()&&this.game.camera.centreOn(this.character)}getTargetType(){return this.character.target?this.character.target.isNPC()||this.character.target.isChest()?di.Talk:this.character.target.isObject()?di.Object:this.character.target.isMob()||this.character.target.isPlayer()&&this.game.pvp?di.Attack:di.None:di.None}}const lc=1056,hc=768,dc=16,fc=1682118060676,cc=[5,18,19,20,132,133,134,135,136,137,138,139,185,186,187,193,196,197,198,199,200,201,202,203,321,646,647,648,653,654,655,656,709,710,711,712,713,717,718,719,720,739,740,772,773,774,775,776,777,778,781,782,783,784,802,803,804,805,845,848,865,866,867,868,869,870,897,898,928,929,930,931,932,933,934,935,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,961,962,1036,1037,1100,1101,1109,1110,1111,1129,1130,1131,1132,1133,1134,1135,1136,1137,1138,1139,1140,1173,1174,1175,1217,1218,1219,1259,1260,1261,1262,1263,1264,1265,1266,1267,1268,1281,1282,1283,1434,1435,1437,1438,1439,1446,1447,1448,1510,1511,1512,1525,1526,1527,1537,1538,1589,1590,1591,1592,1653,1654,1655,1656,1665,1711,1712,1714,1715,1717,1718,1719,1720,1793,1901,1914,1915,1916,1921,1922,1923,1938,1939,1941,1942,1943,1985,1986,1987,2001,2002,2003,2004,2005,2006,2007,2021,2022,2023,2065,2066,2067,2068,2069,2070,2071,2085,2086,2087,2089,2133,2158,2160,2217,2221,2222,2223,2224,2225,2241,2242,2243,2244,2285,2286,2287,2288,2289,2290,2291,2305,2306,2307,2308,2349,2350,2351,2352,2353,2354,2355,2369,2370,2371,2372,2385,2386,2387,2389,2390,2391,2429,2430,2431,2432,2453,2454,2455,2493,2494,2495,2496,2497,2498,2499,2500,2511,2549,2550,2551,2557,2558,2559,2560,2561,2562,2564,2574,2575,2576,2613,2614,2615,2616,2638,2639,2640,2671,2673,2677,2678,2679,2680,2709,2710,2711,2712,2734,2735,2736,2737,2738,2741,2742,2743,2744,2773,2774,2775,2776,2793,2794,2796,2797,2798,2799,2800,2801,2802,2821,2822,2823,2837,2838,2839,2840,2857,2858,2860,2861,2862,2863,2864,2865,2866,2924,2925,2926,2927,2928,2929,2930,2931,2932,2933,2979,2988,2989,2990,2991,2992,2993,2994,2995,2996,2997,3042,3043,3044,3106,3107,3108,3113,3114,3115,3177,3178,3179,3289,3290,3291,3433,3434,3561,3562,3710,3711,3712,3774,3775,3776,3897,3898,3900,3901,3996,3998,3999,4028,4029,5199,5200,5262,5263,5264,5265,5271,5272,5275,5276,5325,5326,5327,5328,5329,5330,5335,5336,5388,5389,5390,5391,5392,5393,5394,5395,5569,5570,5571,5633,5634,5635,5697,5698,5699,5906,5907,5908,5970,5971,5972,6401,6402,6403,6465,6466,6467,6481,6482,6483,6529,6530,6531,6593,7110,7111,7112,7126,7127,7128,7129,7134,7135,7136,7137,7138,7139,7140,7141,7144,7173,7174,7175,7176,7190,7191,7192,7193,7198,7199,7200,7201,7202,7203,7204,7205,7237,7238,7239,7240,7241,7242,7243,7244,7369,7370,7371,7372,7433,7434,7435,7436,7497,7498,7499,7500,7621,7685,7693,7749,7757,9723,9788,9833,9834,9835,9836,9837,9838,9839,9840,9841,9842,9843,9844,9852,9897,9898,9899,9900,9901,9902,9903,9904,9905,9906,9908,9909,9916,9974,9980,10038,10044,10102,10108,10172,10230,10236,10294,10300,10358,10425,10427,10489,10490,10491,12329,12330,12331,12332,12333,12355,12356,12393,12394,12395,12396,12397,12417,12418,12419,12420,12421,12422,12457,12458,12459,12460,12461,12481,12482,12483,12484,12485,12486,12521,12522,12523,12524,12525,12545,12546,12547,12548,12549,12609,12610,12611,12612,12613,12943,12944,12998,13128,13129,13130,13131,13132,13133,13134,13135,13192,13193,13194,13195,13196,13197,13198,13199,13256,13257,13258,13259,13260,13320,13321,13322,13323,13398,13399,13461,13462,13463,13464,13465,13466,13467,13468,13525,13526,13527,13528,13529,13530,13531,13532,13534,13535,13536,13538,13539,13540,13541,13569,13570,13571,13572,13573,13574,13575,13589,13590,13591,13592,13593,13594,13595,13596,13597,13598,13599,13600,13601,13602,13603,13604,13605,13606,13633,13634,13635,13636,13637,13638,13639,13661,13662,13663,13664,13665,13666,13667,13668,13669,13670,13697,13698,13699,13700,13701,13702,13703,13725,13729,13730,13731,13732,13733,13921,13922,13923,13924,13925,13926,13985,13986,13987,13988,13989,14049,14050,14051,14052,14113,14116,14209,14210,14211,14273,14274,14275,14294,14295,14298,14299,14302,14358,14359,14361,14362,14363,14364,14365,14366,14367,14421,14422,14423,14424,14425,14426,14427,14428,14429,14430,14431,14432,14467,14468,14469,14470,14471,14472,14473,14485,14486,14487,14488,14489,14490,14491,14492,14493,14494,14495,14496,14531,14532,14533,14534,14535,14536,14537,14538,14549,14550,14551,14552,14553,14554,14555,14556,14557,14558,14559,14560,14657,14658,14666,14667,14669,14670,14819,14820,14821,14925,14926,14927,14928,14929,14930,14931,14932,14989,14990,14991,14992,14993,14994,14995,14996,15005,15006,15007,15008,15009,15069,15070,15071,15072,15073,15117,15120,15121,15124,15206,15207,15208,15309,15310,15311,15746,15747,15810,15811,15820,15821,15822,15873,15874,15875,15876,15877,15878,15879,15880,15882,15883,15884,15885,15886,15887,15937,15938,15939,15940,15941,15942,15943,15944,15946,15947,15948,15949,15950,15951,16010,16011,16012,16013,16014,16647,16648,16649,16664,16665,16689,16690,16691,16692,16693,16694,16695,16696,16697,16698,16699,16700,16702,16710,16711,16712,16713,16714,16728,16729,16767,16773,16774,16775,16776,16777,16778,16779,16792,16793,16830,16837,16838,16839,16840,16841,16842,16843,16895,17495,17511,17559,19462,19463,19526,19527,19528],uc=[{firstGid:0,lastGid:4095,path:"tilesheet-1.png"},{firstGid:4096,lastGid:8191,path:"tilesheet-2.png"},{firstGid:8192,lastGid:12287,path:"tilesheet-3.png"},{firstGid:12288,lastGid:16383,path:"tilesheet-4.png"},{firstGid:16644,lastGid:20739,path:"tilesheet-5.png"}],gc={1:[{duration:150,tileId:0},{duration:150,tileId:1},{duration:150,tileId:2}],37:[{duration:200,tileId:36},{duration:200,tileId:37},{duration:200,tileId:38},{duration:200,tileId:39}],95:[{duration:200,tileId:94},{duration:200,tileId:95},{duration:200,tileId:96},{duration:200,tileId:97},{duration:200,tileId:98},{duration:200,tileId:99}],101:[{duration:200,tileId:100},{duration:200,tileId:101},{duration:200,tileId:102},{duration:200,tileId:103}],159:[{duration:200,tileId:158},{duration:200,tileId:159},{duration:200,tileId:160},{duration:200,tileId:161},{duration:200,tileId:162},{duration:200,tileId:163}],223:[{duration:200,tileId:222},{duration:200,tileId:223},{duration:200,tileId:224},{duration:200,tileId:225}],287:[{duration:200,tileId:286},{duration:200,tileId:287},{duration:200,tileId:288},{duration:200,tileId:289}],351:[{duration:200,tileId:350},{duration:200,tileId:351},{duration:200,tileId:352},{duration:200,tileId:353}],570:[{duration:150,tileId:569},{duration:150,tileId:570},{duration:150,tileId:571},{duration:150,tileId:572},{duration:150,tileId:573},{duration:150,tileId:574}],597:[{duration:200,tileId:596},{duration:200,tileId:597},{duration:200,tileId:598},{duration:200,tileId:599},{duration:200,tileId:600},{duration:200,tileId:601},{duration:200,tileId:602},{duration:200,tileId:603},{duration:200,tileId:604},{duration:200,tileId:605},{duration:200,tileId:606},{duration:200,tileId:607},{duration:200,tileId:608},{duration:200,tileId:609},{duration:200,tileId:610},{duration:200,tileId:611},{duration:200,tileId:612}],634:[{duration:150,tileId:633},{duration:150,tileId:634},{duration:150,tileId:635},{duration:150,tileId:636},{duration:150,tileId:637},{duration:150,tileId:638}],661:[{duration:200,tileId:660},{duration:200,tileId:661},{duration:200,tileId:662},{duration:200,tileId:663},{duration:200,tileId:664},{duration:200,tileId:665},{duration:200,tileId:666},{duration:200,tileId:667},{duration:200,tileId:668},{duration:200,tileId:669},{duration:200,tileId:670},{duration:200,tileId:671},{duration:200,tileId:672},{duration:200,tileId:673},{duration:200,tileId:674}],762:[{duration:150,tileId:761},{duration:150,tileId:762},{duration:150,tileId:763},{duration:150,tileId:764},{duration:150,tileId:765},{duration:150,tileId:766}],769:[{duration:150,tileId:768},{duration:150,tileId:769},{duration:150,tileId:770}],826:[{duration:150,tileId:825},{duration:150,tileId:826},{duration:150,tileId:827},{duration:150,tileId:828},{duration:150,tileId:829},{duration:150,tileId:830}],917:[{duration:200,tileId:916},{duration:200,tileId:917},{duration:200,tileId:918}],954:[{duration:150,tileId:953},{duration:150,tileId:954},{duration:150,tileId:955},{duration:150,tileId:956},{duration:150,tileId:957},{duration:150,tileId:958}],981:[{duration:200,tileId:980},{duration:200,tileId:981},{duration:200,tileId:982}],1018:[{duration:150,tileId:1017},{duration:150,tileId:1018},{duration:150,tileId:1019},{duration:150,tileId:1020},{duration:150,tileId:1021},{duration:150,tileId:1022}],1178:[{duration:200,tileId:1177},{duration:200,tileId:1178},{duration:200,tileId:1179},{duration:200,tileId:1180},{duration:200,tileId:1181},{duration:200,tileId:1182}],1210:[{duration:150,tileId:1209},{duration:150,tileId:1210},{duration:150,tileId:1211},{duration:150,tileId:1212},{duration:150,tileId:1213},{duration:150,tileId:1214}],1274:[{duration:150,tileId:1273},{duration:150,tileId:1274},{duration:150,tileId:1275},{duration:150,tileId:1276},{duration:150,tileId:1277},{duration:150,tileId:1278}],1621:[{duration:200,tileId:1620},{duration:200,tileId:1621},{duration:200,tileId:1622}],1685:[{duration:200,tileId:1684},{duration:200,tileId:1685},{duration:200,tileId:1686}],1691:[{duration:200,tileId:1690},{duration:200,tileId:1691},{duration:200,tileId:1692}],1813:[{duration:100,tileId:1812},{duration:100,tileId:1813},{duration:100,tileId:1814},{duration:100,tileId:1815},{duration:100,tileId:1816},{duration:100,tileId:1817},{duration:100,tileId:1818},{duration:100,tileId:1819},{duration:100,tileId:1820},{duration:100,tileId:1821},{duration:100,tileId:1822},{duration:100,tileId:1823},{duration:100,tileId:1824},{duration:100,tileId:1825},{duration:100,tileId:1826},{duration:100,tileId:1827},{duration:100,tileId:1828},{duration:100,tileId:1829},{duration:100,tileId:1830}],1877:[{duration:100,tileId:1876},{duration:100,tileId:1877},{duration:100,tileId:1878},{duration:100,tileId:1879},{duration:100,tileId:1880},{duration:100,tileId:1881},{duration:100,tileId:1882},{duration:100,tileId:1883},{duration:100,tileId:1884},{duration:100,tileId:1885},{duration:100,tileId:1886},{duration:100,tileId:1887},{duration:100,tileId:1888},{duration:100,tileId:1889},{duration:100,tileId:1890},{duration:100,tileId:1891},{duration:100,tileId:1892},{duration:100,tileId:1893},{duration:100,tileId:1894}],1897:[{duration:200,tileId:1896},{duration:200,tileId:1897},{duration:200,tileId:1898}],1926:[{duration:400,tileId:1925},{duration:400,tileId:1926},{duration:400,tileId:1927}],1990:[{duration:400,tileId:1989},{duration:400,tileId:1990}],2054:[{duration:400,tileId:2053},{duration:400,tileId:2054}],2246:[{duration:200,tileId:2245},{duration:200,tileId:2246},{duration:200,tileId:2247},{duration:200,tileId:2248}],2310:[{duration:200,tileId:2309},{duration:200,tileId:2310},{duration:200,tileId:2311},{duration:200,tileId:2312}],2376:[{duration:300,tileId:2375},{duration:300,tileId:2376}],2394:[{duration:400,tileId:2393},{duration:400,tileId:2394},{duration:400,tileId:2395}],2458:[{duration:400,tileId:2457},{duration:400,tileId:2458}],2522:[{duration:400,tileId:2521},{duration:400,tileId:2522}],2665:[{duration:200,tileId:2664},{duration:200,tileId:2665},{duration:200,tileId:2666}],2714:[{duration:150,tileId:2713},{duration:150,tileId:2714},{duration:150,tileId:2715},{duration:150,tileId:2716}],2778:[{duration:200,tileId:2777},{duration:200,tileId:2778},{duration:200,tileId:2779},{duration:200,tileId:2780}],2844:[{duration:300,tileId:2843},{duration:300,tileId:2844}],3201:[{duration:200,tileId:3200},{duration:200,tileId:3201},{duration:200,tileId:3202},{duration:200,tileId:3203}],3265:[{duration:200,tileId:3264},{duration:200,tileId:3265},{duration:200,tileId:3266},{duration:200,tileId:3267}],3329:[{duration:200,tileId:3328},{duration:200,tileId:3329},{duration:200,tileId:3330},{duration:200,tileId:3331}],3393:[{duration:200,tileId:3392},{duration:200,tileId:3393},{duration:200,tileId:3394},{duration:200,tileId:3395}],3669:[{duration:150,tileId:3668},{duration:150,tileId:3669},{duration:150,tileId:3670},{duration:150,tileId:3671}],3733:[{duration:150,tileId:3732},{duration:150,tileId:3733},{duration:150,tileId:3734},{duration:150,tileId:3735}],3797:[{duration:150,tileId:3796},{duration:150,tileId:3797},{duration:150,tileId:3798},{duration:150,tileId:3799}],3861:[{duration:150,tileId:3860},{duration:150,tileId:3861},{duration:150,tileId:3862},{duration:150,tileId:3863}],3922:[{duration:200,tileId:3921},{duration:200,tileId:3922},{duration:200,tileId:3923}],3947:[{duration:200,tileId:3946},{duration:200,tileId:3947},{duration:200,tileId:3948},{duration:200,tileId:3949},{duration:200,tileId:3950},{duration:200,tileId:3951}],3954:[{duration:200,tileId:3953},{duration:200,tileId:3954},{duration:200,tileId:3955},{duration:200,tileId:3956},{duration:200,tileId:3957},{duration:200,tileId:3958}],3998:[{duration:250,tileId:3997},{duration:250,tileId:4e3},{duration:250,tileId:4003},{duration:250,tileId:4006}],4011:[{duration:200,tileId:4010},{duration:200,tileId:4011},{duration:200,tileId:4012},{duration:200,tileId:4013},{duration:200,tileId:4014},{duration:200,tileId:4015}],4018:[{duration:200,tileId:4017},{duration:200,tileId:4018},{duration:200,tileId:4019},{duration:200,tileId:4020},{duration:200,tileId:4021},{duration:200,tileId:4022}],4555:[{duration:400,tileId:4554},{duration:400,tileId:4555},{duration:400,tileId:4556},{duration:400,tileId:4557},{duration:400,tileId:4558}],4561:[{duration:200,tileId:4560},{duration:200,tileId:4561},{duration:200,tileId:4562},{duration:200,tileId:4563}],4619:[{duration:400,tileId:4618},{duration:400,tileId:4619},{duration:400,tileId:4620},{duration:400,tileId:4621},{duration:400,tileId:4622},{duration:400,tileId:4623}],4683:[{duration:400,tileId:4682},{duration:400,tileId:4683},{duration:400,tileId:4684},{duration:400,tileId:4685}],4747:[{duration:400,tileId:4746},{duration:400,tileId:4747},{duration:400,tileId:4748},{duration:400,tileId:4749}],4811:[{duration:400,tileId:4810},{duration:400,tileId:4811},{duration:400,tileId:4812},{duration:400,tileId:4813}],5057:[{duration:200,tileId:5056},{duration:200,tileId:5057},{duration:200,tileId:5058},{duration:200,tileId:5059},{duration:200,tileId:5060},{duration:200,tileId:5061},{duration:200,tileId:5062},{duration:200,tileId:5063},{duration:200,tileId:5064},{duration:200,tileId:5065},{duration:200,tileId:5066},{duration:200,tileId:5067},{duration:200,tileId:5068},{duration:200,tileId:5069},{duration:200,tileId:5070},{duration:200,tileId:5071},{duration:200,tileId:5072}],5121:[{duration:200,tileId:5120},{duration:200,tileId:5121},{duration:200,tileId:5122},{duration:200,tileId:5123},{duration:200,tileId:5124},{duration:200,tileId:5125},{duration:200,tileId:5126},{duration:200,tileId:5127},{duration:200,tileId:5128},{duration:200,tileId:5129},{duration:200,tileId:5130},{duration:200,tileId:5131},{duration:200,tileId:5132},{duration:200,tileId:5133},{duration:200,tileId:5134}],5377:[{duration:200,tileId:5376},{duration:200,tileId:5377},{duration:200,tileId:5378}],5441:[{duration:200,tileId:5440},{duration:200,tileId:5441},{duration:200,tileId:5442}],5638:[{duration:200,tileId:5637},{duration:200,tileId:5638},{duration:200,tileId:5639},{duration:200,tileId:5640},{duration:200,tileId:5641},{duration:200,tileId:5642}],6081:[{duration:200,tileId:6080},{duration:200,tileId:6081},{duration:200,tileId:6082}],6145:[{duration:200,tileId:6144},{duration:200,tileId:6145},{duration:200,tileId:6146}],6151:[{duration:200,tileId:6150},{duration:200,tileId:6151},{duration:200,tileId:6152}],6273:[{duration:200,tileId:6272},{duration:200,tileId:6273},{duration:200,tileId:6274},{duration:200,tileId:6275},{duration:200,tileId:6276},{duration:200,tileId:6277},{duration:200,tileId:6278},{duration:200,tileId:6279},{duration:200,tileId:6280},{duration:200,tileId:6281},{duration:200,tileId:6282},{duration:200,tileId:6283},{duration:200,tileId:6284},{duration:200,tileId:6285},{duration:200,tileId:6286},{duration:200,tileId:6287},{duration:200,tileId:6288},{duration:200,tileId:6289},{duration:200,tileId:6290}],6337:[{duration:200,tileId:6336},{duration:200,tileId:6337},{duration:200,tileId:6338},{duration:200,tileId:6339},{duration:200,tileId:6340},{duration:200,tileId:6341},{duration:200,tileId:6342},{duration:200,tileId:6343},{duration:200,tileId:6344},{duration:200,tileId:6345},{duration:200,tileId:6346},{duration:200,tileId:6347},{duration:200,tileId:6348},{duration:200,tileId:6349},{duration:200,tileId:6350},{duration:200,tileId:6351},{duration:200,tileId:6352},{duration:200,tileId:6353},{duration:200,tileId:6354}],7621:[{duration:200,tileId:7620},{duration:200,tileId:7621},{duration:200,tileId:7622},{duration:200,tileId:7623}],7685:[{duration:200,tileId:7684},{duration:200,tileId:7685},{duration:200,tileId:7686},{duration:200,tileId:7687}],7693:[{duration:200,tileId:7692},{duration:200,tileId:7693},{duration:200,tileId:7694},{duration:200,tileId:7695},{duration:200,tileId:7696},{duration:200,tileId:7697},{duration:200,tileId:7698},{duration:200,tileId:7699}],7749:[{duration:200,tileId:7748},{duration:200,tileId:7749},{duration:200,tileId:7750},{duration:200,tileId:7751}],7757:[{duration:200,tileId:7756},{duration:200,tileId:7757},{duration:200,tileId:7758},{duration:200,tileId:7759},{duration:200,tileId:7760},{duration:200,tileId:7761},{duration:200,tileId:7762},{duration:200,tileId:7763}],7813:[{duration:200,tileId:7812},{duration:200,tileId:7813},{duration:200,tileId:7814},{duration:200,tileId:7815}],8076:[{duration:200,tileId:6150},{duration:200,tileId:6151},{duration:200,tileId:6152}],13354:[{duration:150,tileId:13353},{duration:150,tileId:13417},{duration:150,tileId:13481},{duration:150,tileId:13545},{duration:150,tileId:13609},{duration:150,tileId:13673}],13355:[{duration:150,tileId:13354},{duration:150,tileId:13418},{duration:150,tileId:13482},{duration:150,tileId:13546},{duration:150,tileId:13610},{duration:150,tileId:13674}],16936:[{duration:250,tileId:16935},{duration:250,tileId:16936},{duration:250,tileId:16937},{duration:250,tileId:16938}],17487:[{duration:250,tileId:17486},{duration:250,tileId:17488},{duration:250,tileId:17490},{duration:250,tileId:17492}],17488:[{duration:250,tileId:17487},{duration:250,tileId:17489},{duration:250,tileId:17491},{duration:250,tileId:17493}],17495:[{duration:250,tileId:17494},{duration:250,tileId:17495},{duration:250,tileId:17496},{duration:250,tileId:17497}],17506:[{duration:150,tileId:17505},{duration:150,tileId:17506},{duration:150,tileId:17507},{duration:150,tileId:17508}],17551:[{duration:250,tileId:17550},{duration:250,tileId:17552},{duration:250,tileId:17554},{duration:250,tileId:17556}],17552:[{duration:250,tileId:17551},{duration:250,tileId:17553},{duration:250,tileId:17555},{duration:250,tileId:17557}],17559:[{duration:250,tileId:17558},{duration:250,tileId:17559},{duration:250,tileId:17560},{duration:250,tileId:17561}],17570:[{duration:150,tileId:17569},{duration:150,tileId:17570},{duration:150,tileId:17571},{duration:150,tileId:17572}],17615:[{duration:250,tileId:17614},{duration:250,tileId:17615},{duration:250,tileId:17616},{duration:250,tileId:17617},{duration:250,tileId:17618},{duration:250,tileId:17619}],17634:[{duration:150,tileId:17633},{duration:150,tileId:17634},{duration:150,tileId:17635},{duration:150,tileId:17636}],17679:[{duration:250,tileId:17678},{duration:250,tileId:17679},{duration:250,tileId:17680},{duration:250,tileId:17681}],17698:[{duration:150,tileId:17697},{duration:150,tileId:17698},{duration:150,tileId:17699},{duration:150,tileId:17700}],17743:[{duration:250,tileId:17742},{duration:250,tileId:17743},{duration:250,tileId:17744},{duration:250,tileId:17745},{duration:250,tileId:17746},{duration:250,tileId:17747}],17807:[{duration:250,tileId:17806},{duration:250,tileId:17807},{duration:250,tileId:17808},{duration:250,tileId:17809}],17871:[{duration:250,tileId:17870},{duration:250,tileId:17871},{duration:250,tileId:17872},{duration:250,tileId:17873},{duration:250,tileId:17874},{duration:250,tileId:17875}]},Ri={width:lc,height:hc,tileSize:dc,version:fc,high:cc,tilesets:uc,animations:gc};let pc=class{constructor(t){l(this,"width",Ri.width);l(this,"height",Ri.height);l(this,"tileSize",Ri.tileSize);l(this,"data",[]);l(this,"grid",[]);l(this,"high",Ri.high);l(this,"objects",[]);l(this,"lights",[]);l(this,"tilesets",[]);l(this,"rawTilesets",Ri.tilesets);l(this,"cursorTiles",{});l(this,"animatedTiles",Ri.animations);l(this,"mapLoaded",!1);l(this,"regionsLoaded",0);l(this,"tilesetsLoaded",!1);this.game=t,this.load()}ready(){var t;this.mapLoaded&&this.tilesetsLoaded?(t=this.readyCallback)==null||t.call(this):window.setTimeout(()=>this.ready(),100)}load(){de.debug("Parsing map with Web Workers..."),q.tileSize=this.tileSize,q.sideLength=this.width/kt.MAP_DIVISION_SIZE,q.thirdTile=this.tileSize/3,q.tileAndAQuarter=this.tileSize*1.25;let t=new Worker(new URL("/assets/mapworker-ab6f3cd5.js",self.location),{type:"classic"});t.postMessage([this.width,this.height]),t.addEventListener("message",e=>{e.data.data&&(this.data=e.data.data),e.data.grid&&(this.grid=e.data.grid),this.loadRegionData(),this.mapLoaded=!0}),this.loadTilesets(),this.ready()}loadRegions(t){for(let e in t)this.loadRegion(t[e],parseInt(e));this.saveMapData(),this.game.useWebGl&&this.game.renderer.bindTileLayers()}loadRegion(t,e){for(let n of t){let r=this.coordToIndex(n.x,n.y),a=this.objects.indexOf(r);this.data[r]=n.data,n.c&&!this.isColliding(n.x,n.y)&&(this.grid[n.y][n.x]=1),!n.c&&this.isColliding(n.x,n.y)&&(this.grid[n.y][n.x]=0),n.cur&&(this.cursorTiles[r]=n.cur),!n.cur&&r in this.cursorTiles&&(this.cursorTiles[r]=""),n.o&&a<0&&this.objects.push(r),!n.o&&a>-1&&this.objects.splice(a,1),this.game.useWebGl&&this.game.renderer.setTile(r,n.data)}this.game.storage.setRegionData(t,e)}loadTilesets(){for(let t in this.rawTilesets)this.loadTileset(this.rawTilesets[t],parseInt(t),e=>{this.tilesets.push(e),this.tilesets.length===this.rawTilesets.length&&(this.tilesets=this.tilesets.sort((n,r)=>n.firstGid-r.firstGid),this.tilesetsLoaded=!0)})}loadTileset(t,e,n){let r=new Image,a=`/img/tilesets/${t.path}`;r.crossOrigin="Anonymous",r.path=a,r.src=a,r.index=e,r.firstGid=t.firstGid,r.lastGid=t.lastGid,r.addEventListener("load",()=>{if(r.width%this.tileSize>0)throw new Error(`The tile size is malformed in the tile set: ${t.path}`);r.loaded=!0,n(r)}),r.addEventListener("error",()=>{throw new Error(`Could not find tile set: ${t.path}`)}),setTimeout(()=>{r.loaded||(this.loadTileset(t,e,n),de.debug(`Retrying to load tileset: ${t.path}`))},500)}loadRegionData(){this.game.storage.getRegionData(t=>{let e=Object.keys(t.regionData);if(e.length>0){try{this.loadRegions(t.regionData)}catch(n){this.game.storage.clear()}this.objects=t.objects,this.cursorTiles=t.cursorTiles,this.regionsLoaded=e.length,de.info(`Preloaded map data with ${e.length} regions.`)}this.game.renderer.load()})}saveMapData(){this.game.storage.setMapData(this.objects,this.cursorTiles)}coordToIndex(t,e){return e*this.width+t}indexToCoord(t){return{x:t%this.width,y:Math.floor(t/this.width)}}isColliding(t,e){return this.isOutOfBounds(t,e)||this.data[this.coordToIndex(t,e)]<1?!0:this.grid[e][t]===1}isObject(t,e){let n=this.coordToIndex(t,e);return this.objects.includes(n)}getTileCursor(t,e){let n=this.coordToIndex(t,e);return this.cursorTiles[n]}isHighTile(t){return this.high.includes(t)}isLightTile(t){return this.lights.includes(t)}isAnimatedTile(t){return t in this.animatedTiles}hasCachedDate(){return this.regionsLoaded>0}isOutOfBounds(t,e){return uo(t)&&uo(e)&&(t<0||t>=this.width||e<0||e>=this.height)}getTileAnimation(t){return this.animatedTiles[t]}getTilesetFromId(t){for(let e of this.tilesets)if(t>=e.firstGid&&t<=e.lastGid)return e}onReady(t){this.readyCallback=t}};/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const mc=4,_o=0,bo=1,wc=2;function $i(i){let t=i.length;for(;--t>=0;)i[t]=0}const _c=0,Ol=1,bc=2,yc=3,kc=258,sa=29,Nn=256,En=Nn+1+sa,Bi=30,aa=19,ql=2*En+1,ui=15,ds=16,vc=7,oa=256,Bl=16,zl=17,Fl=18,Fs=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ur=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Sc=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ul=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xc=512,Bt=new Array((En+2)*2);$i(Bt);const _n=new Array(Bi*2);$i(_n);const Tn=new Array(xc);$i(Tn);const Cn=new Array(kc-yc+1);$i(Cn);const la=new Array(sa);$i(la);const vr=new Array(Bi);$i(vr);function fs(i,t,e,n,r){this.static_tree=i,this.extra_bits=t,this.extra_base=e,this.elems=n,this.max_length=r,this.has_stree=i&&i.length}let Hl,$l,jl;function cs(i,t){this.dyn_tree=i,this.max_code=0,this.stat_desc=t}const Gl=i=>i<256?Tn[i]:Tn[256+(i>>>7)],In=(i,t)=>{i.pending_buf[i.pending++]=t&255,i.pending_buf[i.pending++]=t>>>8&255},et=(i,t,e)=>{i.bi_valid>ds-e?(i.bi_buf|=t<<i.bi_valid&65535,In(i,i.bi_buf),i.bi_buf=t>>ds-i.bi_valid,i.bi_valid+=e-ds):(i.bi_buf|=t<<i.bi_valid&65535,i.bi_valid+=e)},Tt=(i,t,e)=>{et(i,e[t*2],e[t*2+1])},Wl=(i,t)=>{let e=0;do e|=i&1,i>>>=1,e<<=1;while(--t>0);return e>>>1},Ec=i=>{i.bi_valid===16?(In(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=i.bi_buf&255,i.bi_buf>>=8,i.bi_valid-=8)},Tc=(i,t)=>{const e=t.dyn_tree,n=t.max_code,r=t.stat_desc.static_tree,a=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,u=t.stat_desc.extra_base,y=t.stat_desc.max_length;let m,b,E,Y,I,A,O=0;for(Y=0;Y<=ui;Y++)i.bl_count[Y]=0;for(e[i.heap[i.heap_max]*2+1]=0,m=i.heap_max+1;m<ql;m++)b=i.heap[m],Y=e[e[b*2+1]*2+1]+1,Y>y&&(Y=y,O++),e[b*2+1]=Y,!(b>n)&&(i.bl_count[Y]++,I=0,b>=u&&(I=d[b-u]),A=e[b*2],i.opt_len+=A*(Y+I),a&&(i.static_len+=A*(r[b*2+1]+I)));if(O!==0){do{for(Y=y-1;i.bl_count[Y]===0;)Y--;i.bl_count[Y]--,i.bl_count[Y+1]+=2,i.bl_count[y]--,O-=2}while(O>0);for(Y=y;Y!==0;Y--)for(b=i.bl_count[Y];b!==0;)E=i.heap[--m],!(E>n)&&(e[E*2+1]!==Y&&(i.opt_len+=(Y-e[E*2+1])*e[E*2],e[E*2+1]=Y),b--)}},Vl=(i,t,e)=>{const n=new Array(ui+1);let r=0,a,d;for(a=1;a<=ui;a++)r=r+e[a-1]<<1,n[a]=r;for(d=0;d<=t;d++){let u=i[d*2+1];u!==0&&(i[d*2]=Wl(n[u]++,u))}},Cc=()=>{let i,t,e,n,r;const a=new Array(ui+1);for(e=0,n=0;n<sa-1;n++)for(la[n]=e,i=0;i<1<<Fs[n];i++)Cn[e++]=n;for(Cn[e-1]=n,r=0,n=0;n<16;n++)for(vr[n]=r,i=0;i<1<<ur[n];i++)Tn[r++]=n;for(r>>=7;n<Bi;n++)for(vr[n]=r<<7,i=0;i<1<<ur[n]-7;i++)Tn[256+r++]=n;for(t=0;t<=ui;t++)a[t]=0;for(i=0;i<=143;)Bt[i*2+1]=8,i++,a[8]++;for(;i<=255;)Bt[i*2+1]=9,i++,a[9]++;for(;i<=279;)Bt[i*2+1]=7,i++,a[7]++;for(;i<=287;)Bt[i*2+1]=8,i++,a[8]++;for(Vl(Bt,En+1,a),i=0;i<Bi;i++)_n[i*2+1]=5,_n[i*2]=Wl(i,5);Hl=new fs(Bt,Fs,Nn+1,En,ui),$l=new fs(_n,ur,0,Bi,ui),jl=new fs(new Array(0),Sc,0,aa,vc)},Zl=i=>{let t;for(t=0;t<En;t++)i.dyn_ltree[t*2]=0;for(t=0;t<Bi;t++)i.dyn_dtree[t*2]=0;for(t=0;t<aa;t++)i.bl_tree[t*2]=0;i.dyn_ltree[oa*2]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},Kl=i=>{i.bi_valid>8?In(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},yo=(i,t,e,n)=>{const r=t*2,a=e*2;return i[r]<i[a]||i[r]===i[a]&&n[t]<=n[e]},us=(i,t,e)=>{const n=i.heap[e];let r=e<<1;for(;r<=i.heap_len&&(r<i.heap_len&&yo(t,i.heap[r+1],i.heap[r],i.depth)&&r++,!yo(t,n,i.heap[r],i.depth));)i.heap[e]=i.heap[r],e=r,r<<=1;i.heap[e]=n},ko=(i,t,e)=>{let n,r,a=0,d,u;if(i.sym_next!==0)do n=i.pending_buf[i.sym_buf+a++]&255,n+=(i.pending_buf[i.sym_buf+a++]&255)<<8,r=i.pending_buf[i.sym_buf+a++],n===0?Tt(i,r,t):(d=Cn[r],Tt(i,d+Nn+1,t),u=Fs[d],u!==0&&(r-=la[d],et(i,r,u)),n--,d=Gl(n),Tt(i,d,e),u=ur[d],u!==0&&(n-=vr[d],et(i,n,u)));while(a<i.sym_next);Tt(i,oa,t)},Us=(i,t)=>{const e=t.dyn_tree,n=t.stat_desc.static_tree,r=t.stat_desc.has_stree,a=t.stat_desc.elems;let d,u,y=-1,m;for(i.heap_len=0,i.heap_max=ql,d=0;d<a;d++)e[d*2]!==0?(i.heap[++i.heap_len]=y=d,i.depth[d]=0):e[d*2+1]=0;for(;i.heap_len<2;)m=i.heap[++i.heap_len]=y<2?++y:0,e[m*2]=1,i.depth[m]=0,i.opt_len--,r&&(i.static_len-=n[m*2+1]);for(t.max_code=y,d=i.heap_len>>1;d>=1;d--)us(i,e,d);m=a;do d=i.heap[1],i.heap[1]=i.heap[i.heap_len--],us(i,e,1),u=i.heap[1],i.heap[--i.heap_max]=d,i.heap[--i.heap_max]=u,e[m*2]=e[d*2]+e[u*2],i.depth[m]=(i.depth[d]>=i.depth[u]?i.depth[d]:i.depth[u])+1,e[d*2+1]=e[u*2+1]=m,i.heap[1]=m++,us(i,e,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],Tc(i,t),Vl(e,y,i.bl_count)},vo=(i,t,e)=>{let n,r=-1,a,d=t[0*2+1],u=0,y=7,m=4;for(d===0&&(y=138,m=3),t[(e+1)*2+1]=65535,n=0;n<=e;n++)a=d,d=t[(n+1)*2+1],!(++u<y&&a===d)&&(u<m?i.bl_tree[a*2]+=u:a!==0?(a!==r&&i.bl_tree[a*2]++,i.bl_tree[Bl*2]++):u<=10?i.bl_tree[zl*2]++:i.bl_tree[Fl*2]++,u=0,r=a,d===0?(y=138,m=3):a===d?(y=6,m=3):(y=7,m=4))},So=(i,t,e)=>{let n,r=-1,a,d=t[0*2+1],u=0,y=7,m=4;for(d===0&&(y=138,m=3),n=0;n<=e;n++)if(a=d,d=t[(n+1)*2+1],!(++u<y&&a===d)){if(u<m)do Tt(i,a,i.bl_tree);while(--u!==0);else a!==0?(a!==r&&(Tt(i,a,i.bl_tree),u--),Tt(i,Bl,i.bl_tree),et(i,u-3,2)):u<=10?(Tt(i,zl,i.bl_tree),et(i,u-3,3)):(Tt(i,Fl,i.bl_tree),et(i,u-11,7));u=0,r=a,d===0?(y=138,m=3):a===d?(y=6,m=3):(y=7,m=4)}},Ic=i=>{let t;for(vo(i,i.dyn_ltree,i.l_desc.max_code),vo(i,i.dyn_dtree,i.d_desc.max_code),Us(i,i.bl_desc),t=aa-1;t>=3&&i.bl_tree[Ul[t]*2+1]===0;t--);return i.opt_len+=3*(t+1)+5+5+4,t},Yc=(i,t,e,n)=>{let r;for(et(i,t-257,5),et(i,e-1,5),et(i,n-4,4),r=0;r<n;r++)et(i,i.bl_tree[Ul[r]*2+1],3);So(i,i.dyn_ltree,t-1),So(i,i.dyn_dtree,e-1)},Xc=i=>{let t=4093624447,e;for(e=0;e<=31;e++,t>>>=1)if(t&1&&i.dyn_ltree[e*2]!==0)return _o;if(i.dyn_ltree[9*2]!==0||i.dyn_ltree[10*2]!==0||i.dyn_ltree[13*2]!==0)return bo;for(e=32;e<Nn;e++)if(i.dyn_ltree[e*2]!==0)return bo;return _o};let xo=!1;const Lc=i=>{xo||(Cc(),xo=!0),i.l_desc=new cs(i.dyn_ltree,Hl),i.d_desc=new cs(i.dyn_dtree,$l),i.bl_desc=new cs(i.bl_tree,jl),i.bi_buf=0,i.bi_valid=0,Zl(i)},Ql=(i,t,e,n)=>{et(i,(_c<<1)+(n?1:0),3),Kl(i),In(i,e),In(i,~e),e&&i.pending_buf.set(i.window.subarray(t,t+e),i.pending),i.pending+=e},Ac=i=>{et(i,Ol<<1,3),Tt(i,oa,Bt),Ec(i)},Dc=(i,t,e,n)=>{let r,a,d=0;i.level>0?(i.strm.data_type===wc&&(i.strm.data_type=Xc(i)),Us(i,i.l_desc),Us(i,i.d_desc),d=Ic(i),r=i.opt_len+3+7>>>3,a=i.static_len+3+7>>>3,a<=r&&(r=a)):r=a=e+5,e+4<=r&&t!==-1?Ql(i,t,e,n):i.strategy===mc||a===r?(et(i,(Ol<<1)+(n?1:0),3),ko(i,Bt,_n)):(et(i,(bc<<1)+(n?1:0),3),Yc(i,i.l_desc.max_code+1,i.d_desc.max_code+1,d+1),ko(i,i.dyn_ltree,i.dyn_dtree)),Zl(i),n&&Kl(i)},Rc=(i,t,e)=>(i.pending_buf[i.sym_buf+i.sym_next++]=t,i.pending_buf[i.sym_buf+i.sym_next++]=t>>8,i.pending_buf[i.sym_buf+i.sym_next++]=e,t===0?i.dyn_ltree[e*2]++:(i.matches++,t--,i.dyn_ltree[(Cn[e]+Nn+1)*2]++,i.dyn_dtree[Gl(t)*2]++),i.sym_next===i.sym_end);var Nc=Lc,Mc=Ql,Pc=Dc,Oc=Rc,qc=Ac,Bc={_tr_init:Nc,_tr_stored_block:Mc,_tr_flush_block:Pc,_tr_tally:Oc,_tr_align:qc};const zc=(i,t,e,n)=>{let r=i&65535|0,a=i>>>16&65535|0,d=0;for(;e!==0;){d=e>2e3?2e3:e,e-=d;do r=r+t[n++]|0,a=a+r|0;while(--d);r%=65521,a%=65521}return r|a<<16|0};var Yn=zc;const Fc=()=>{let i,t=[];for(var e=0;e<256;e++){i=e;for(var n=0;n<8;n++)i=i&1?3988292384^i>>>1:i>>>1;t[e]=i}return t},Uc=new Uint32Array(Fc()),Hc=(i,t,e,n)=>{const r=Uc,a=n+e;i^=-1;for(let d=n;d<a;d++)i=i>>>8^r[(i^t[d])&255];return i^-1};var Pe=Hc,Fi={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Mn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:$c,_tr_stored_block:Hs,_tr_flush_block:jc,_tr_tally:Vt,_tr_align:Gc}=Bc,{Z_NO_FLUSH:Zt,Z_PARTIAL_FLUSH:Wc,Z_FULL_FLUSH:Vc,Z_FINISH:ct,Z_BLOCK:Eo,Z_OK:ze,Z_STREAM_END:To,Z_STREAM_ERROR:Yt,Z_DATA_ERROR:Zc,Z_BUF_ERROR:gs,Z_DEFAULT_COMPRESSION:Kc,Z_FILTERED:Qc,Z_HUFFMAN_ONLY:tr,Z_RLE:Jc,Z_FIXED:eu,Z_DEFAULT_STRATEGY:tu,Z_UNKNOWN:iu,Z_DEFLATED:Nr}=Mn,nu=9,ru=15,su=8,au=29,ou=256,$s=ou+1+au,lu=30,hu=19,du=2*$s+1,fu=15,pe=3,Gt=258,Xt=Gt+pe+1,cu=32,Ui=42,ha=57,js=69,Gs=73,Ws=91,Vs=103,gi=113,gn=666,Ge=1,ji=2,ki=3,Gi=4,uu=3,pi=(i,t)=>(i.msg=Fi[t],t),Co=i=>i*2-(i>4?9:0),$t=i=>{let t=i.length;for(;--t>=0;)i[t]=0},gu=i=>{let t,e,n,r=i.w_size;t=i.hash_size,n=t;do e=i.head[--n],i.head[n]=e>=r?e-r:0;while(--t);t=r,n=t;do e=i.prev[--n],i.prev[n]=e>=r?e-r:0;while(--t)};let pu=(i,t,e)=>(t<<i.hash_shift^e)&i.hash_mask,Kt=pu;const at=i=>{const t=i.state;let e=t.pending;e>i.avail_out&&(e=i.avail_out),e!==0&&(i.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),i.next_out),i.next_out+=e,t.pending_out+=e,i.total_out+=e,i.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},lt=(i,t)=>{jc(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,t),i.block_start=i.strstart,at(i.strm)},we=(i,t)=>{i.pending_buf[i.pending++]=t},hn=(i,t)=>{i.pending_buf[i.pending++]=t>>>8&255,i.pending_buf[i.pending++]=t&255},Zs=(i,t,e,n)=>{let r=i.avail_in;return r>n&&(r=n),r===0?0:(i.avail_in-=r,t.set(i.input.subarray(i.next_in,i.next_in+r),e),i.state.wrap===1?i.adler=Yn(i.adler,t,r,e):i.state.wrap===2&&(i.adler=Pe(i.adler,t,r,e)),i.next_in+=r,i.total_in+=r,r)},Jl=(i,t)=>{let e=i.max_chain_length,n=i.strstart,r,a,d=i.prev_length,u=i.nice_match;const y=i.strstart>i.w_size-Xt?i.strstart-(i.w_size-Xt):0,m=i.window,b=i.w_mask,E=i.prev,Y=i.strstart+Gt;let I=m[n+d-1],A=m[n+d];i.prev_length>=i.good_match&&(e>>=2),u>i.lookahead&&(u=i.lookahead);do if(r=t,!(m[r+d]!==A||m[r+d-1]!==I||m[r]!==m[n]||m[++r]!==m[n+1])){n+=2,r++;do;while(m[++n]===m[++r]&&m[++n]===m[++r]&&m[++n]===m[++r]&&m[++n]===m[++r]&&m[++n]===m[++r]&&m[++n]===m[++r]&&m[++n]===m[++r]&&m[++n]===m[++r]&&n<Y);if(a=Gt-(Y-n),n=Y-Gt,a>d){if(i.match_start=t,d=a,a>=u)break;I=m[n+d-1],A=m[n+d]}}while((t=E[t&b])>y&&--e!==0);return d<=i.lookahead?d:i.lookahead},Hi=i=>{const t=i.w_size;let e,n,r;do{if(n=i.window_size-i.lookahead-i.strstart,i.strstart>=t+(t-Xt)&&(i.window.set(i.window.subarray(t,t+t-n),0),i.match_start-=t,i.strstart-=t,i.block_start-=t,i.insert>i.strstart&&(i.insert=i.strstart),gu(i),n+=t),i.strm.avail_in===0)break;if(e=Zs(i.strm,i.window,i.strstart+i.lookahead,n),i.lookahead+=e,i.lookahead+i.insert>=pe)for(r=i.strstart-i.insert,i.ins_h=i.window[r],i.ins_h=Kt(i,i.ins_h,i.window[r+1]);i.insert&&(i.ins_h=Kt(i,i.ins_h,i.window[r+pe-1]),i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++,i.insert--,!(i.lookahead+i.insert<pe)););}while(i.lookahead<Xt&&i.strm.avail_in!==0)},eh=(i,t)=>{let e=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,n,r,a,d=0,u=i.strm.avail_in;do{if(n=65535,a=i.bi_valid+42>>3,i.strm.avail_out<a||(a=i.strm.avail_out-a,r=i.strstart-i.block_start,n>r+i.strm.avail_in&&(n=r+i.strm.avail_in),n>a&&(n=a),n<e&&(n===0&&t!==ct||t===Zt||n!==r+i.strm.avail_in)))break;d=t===ct&&n===r+i.strm.avail_in?1:0,Hs(i,0,0,d),i.pending_buf[i.pending-4]=n,i.pending_buf[i.pending-3]=n>>8,i.pending_buf[i.pending-2]=~n,i.pending_buf[i.pending-1]=~n>>8,at(i.strm),r&&(r>n&&(r=n),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+r),i.strm.next_out),i.strm.next_out+=r,i.strm.avail_out-=r,i.strm.total_out+=r,i.block_start+=r,n-=r),n&&(Zs(i.strm,i.strm.output,i.strm.next_out,n),i.strm.next_out+=n,i.strm.avail_out-=n,i.strm.total_out+=n)}while(d===0);return u-=i.strm.avail_in,u&&(u>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=u&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-u,i.strm.next_in),i.strstart),i.strstart+=u,i.insert+=u>i.w_size-i.insert?i.w_size-i.insert:u),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),d?Gi:t!==Zt&&t!==ct&&i.strm.avail_in===0&&i.strstart===i.block_start?ji:(a=i.window_size-i.strstart,i.strm.avail_in>a&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,a+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),a>i.strm.avail_in&&(a=i.strm.avail_in),a&&(Zs(i.strm,i.window,i.strstart,a),i.strstart+=a,i.insert+=a>i.w_size-i.insert?i.w_size-i.insert:a),i.high_water<i.strstart&&(i.high_water=i.strstart),a=i.bi_valid+42>>3,a=i.pending_buf_size-a>65535?65535:i.pending_buf_size-a,e=a>i.w_size?i.w_size:a,r=i.strstart-i.block_start,(r>=e||(r||t===ct)&&t!==Zt&&i.strm.avail_in===0&&r<=a)&&(n=r>a?a:r,d=t===ct&&i.strm.avail_in===0&&n===r?1:0,Hs(i,i.block_start,n,d),i.block_start+=n,at(i.strm)),d?ki:Ge)},ps=(i,t)=>{let e,n;for(;;){if(i.lookahead<Xt){if(Hi(i),i.lookahead<Xt&&t===Zt)return Ge;if(i.lookahead===0)break}if(e=0,i.lookahead>=pe&&(i.ins_h=Kt(i,i.ins_h,i.window[i.strstart+pe-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),e!==0&&i.strstart-e<=i.w_size-Xt&&(i.match_length=Jl(i,e)),i.match_length>=pe)if(n=Vt(i,i.strstart-i.match_start,i.match_length-pe),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=pe){i.match_length--;do i.strstart++,i.ins_h=Kt(i,i.ins_h,i.window[i.strstart+pe-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=Kt(i,i.ins_h,i.window[i.strstart+1]);else n=Vt(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(n&&(lt(i,!1),i.strm.avail_out===0))return Ge}return i.insert=i.strstart<pe-1?i.strstart:pe-1,t===ct?(lt(i,!0),i.strm.avail_out===0?ki:Gi):i.sym_next&&(lt(i,!1),i.strm.avail_out===0)?Ge:ji},Ni=(i,t)=>{let e,n,r;for(;;){if(i.lookahead<Xt){if(Hi(i),i.lookahead<Xt&&t===Zt)return Ge;if(i.lookahead===0)break}if(e=0,i.lookahead>=pe&&(i.ins_h=Kt(i,i.ins_h,i.window[i.strstart+pe-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=pe-1,e!==0&&i.prev_length<i.max_lazy_match&&i.strstart-e<=i.w_size-Xt&&(i.match_length=Jl(i,e),i.match_length<=5&&(i.strategy===Qc||i.match_length===pe&&i.strstart-i.match_start>4096)&&(i.match_length=pe-1)),i.prev_length>=pe&&i.match_length<=i.prev_length){r=i.strstart+i.lookahead-pe,n=Vt(i,i.strstart-1-i.prev_match,i.prev_length-pe),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=r&&(i.ins_h=Kt(i,i.ins_h,i.window[i.strstart+pe-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=pe-1,i.strstart++,n&&(lt(i,!1),i.strm.avail_out===0))return Ge}else if(i.match_available){if(n=Vt(i,0,i.window[i.strstart-1]),n&&lt(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return Ge}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(n=Vt(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<pe-1?i.strstart:pe-1,t===ct?(lt(i,!0),i.strm.avail_out===0?ki:Gi):i.sym_next&&(lt(i,!1),i.strm.avail_out===0)?Ge:ji},mu=(i,t)=>{let e,n,r,a;const d=i.window;for(;;){if(i.lookahead<=Gt){if(Hi(i),i.lookahead<=Gt&&t===Zt)return Ge;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=pe&&i.strstart>0&&(r=i.strstart-1,n=d[r],n===d[++r]&&n===d[++r]&&n===d[++r])){a=i.strstart+Gt;do;while(n===d[++r]&&n===d[++r]&&n===d[++r]&&n===d[++r]&&n===d[++r]&&n===d[++r]&&n===d[++r]&&n===d[++r]&&r<a);i.match_length=Gt-(a-r),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=pe?(e=Vt(i,1,i.match_length-pe),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(e=Vt(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),e&&(lt(i,!1),i.strm.avail_out===0))return Ge}return i.insert=0,t===ct?(lt(i,!0),i.strm.avail_out===0?ki:Gi):i.sym_next&&(lt(i,!1),i.strm.avail_out===0)?Ge:ji},wu=(i,t)=>{let e;for(;;){if(i.lookahead===0&&(Hi(i),i.lookahead===0)){if(t===Zt)return Ge;break}if(i.match_length=0,e=Vt(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,e&&(lt(i,!1),i.strm.avail_out===0))return Ge}return i.insert=0,t===ct?(lt(i,!0),i.strm.avail_out===0?ki:Gi):i.sym_next&&(lt(i,!1),i.strm.avail_out===0)?Ge:ji};function xt(i,t,e,n,r){this.good_length=i,this.max_lazy=t,this.nice_length=e,this.max_chain=n,this.func=r}const pn=[new xt(0,0,0,0,eh),new xt(4,4,8,4,ps),new xt(4,5,16,8,ps),new xt(4,6,32,32,ps),new xt(4,4,16,16,Ni),new xt(8,16,32,32,Ni),new xt(8,16,128,128,Ni),new xt(8,32,128,256,Ni),new xt(32,128,258,1024,Ni),new xt(32,258,258,4096,Ni)],_u=i=>{i.window_size=2*i.w_size,$t(i.head),i.max_lazy_match=pn[i.level].max_lazy,i.good_match=pn[i.level].good_length,i.nice_match=pn[i.level].nice_length,i.max_chain_length=pn[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=pe-1,i.match_available=0,i.ins_h=0};function bu(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Nr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(du*2),this.dyn_dtree=new Uint16Array((2*lu+1)*2),this.bl_tree=new Uint16Array((2*hu+1)*2),$t(this.dyn_ltree),$t(this.dyn_dtree),$t(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(fu+1),this.heap=new Uint16Array(2*$s+1),$t(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*$s+1),$t(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Pn=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.status!==Ui&&t.status!==ha&&t.status!==js&&t.status!==Gs&&t.status!==Ws&&t.status!==Vs&&t.status!==gi&&t.status!==gn?1:0},th=i=>{if(Pn(i))return pi(i,Yt);i.total_in=i.total_out=0,i.data_type=iu;const t=i.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?ha:t.wrap?Ui:gi,i.adler=t.wrap===2?0:1,t.last_flush=-2,$c(t),ze},ih=i=>{const t=th(i);return t===ze&&_u(i.state),t},yu=(i,t)=>Pn(i)||i.state.wrap!==2?Yt:(i.state.gzhead=t,ze),nh=(i,t,e,n,r,a)=>{if(!i)return Yt;let d=1;if(t===Kc&&(t=6),n<0?(d=0,n=-n):n>15&&(d=2,n-=16),r<1||r>nu||e!==Nr||n<8||n>15||t<0||t>9||a<0||a>eu||n===8&&d!==1)return pi(i,Yt);n===8&&(n=9);const u=new bu;return i.state=u,u.strm=i,u.status=Ui,u.wrap=d,u.gzhead=null,u.w_bits=n,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=r+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+pe-1)/pe),u.window=new Uint8Array(u.w_size*2),u.head=new Uint16Array(u.hash_size),u.prev=new Uint16Array(u.w_size),u.lit_bufsize=1<<r+6,u.pending_buf_size=u.lit_bufsize*4,u.pending_buf=new Uint8Array(u.pending_buf_size),u.sym_buf=u.lit_bufsize,u.sym_end=(u.lit_bufsize-1)*3,u.level=t,u.strategy=a,u.method=e,ih(i)},ku=(i,t)=>nh(i,t,Nr,ru,su,tu),vu=(i,t)=>{if(Pn(i)||t>Eo||t<0)return i?pi(i,Yt):Yt;const e=i.state;if(!i.output||i.avail_in!==0&&!i.input||e.status===gn&&t!==ct)return pi(i,i.avail_out===0?gs:Yt);const n=e.last_flush;if(e.last_flush=t,e.pending!==0){if(at(i),i.avail_out===0)return e.last_flush=-1,ze}else if(i.avail_in===0&&Co(t)<=Co(n)&&t!==ct)return pi(i,gs);if(e.status===gn&&i.avail_in!==0)return pi(i,gs);if(e.status===Ui&&e.wrap===0&&(e.status=gi),e.status===Ui){let r=Nr+(e.w_bits-8<<4)<<8,a=-1;if(e.strategy>=tr||e.level<2?a=0:e.level<6?a=1:e.level===6?a=2:a=3,r|=a<<6,e.strstart!==0&&(r|=cu),r+=31-r%31,hn(e,r),e.strstart!==0&&(hn(e,i.adler>>>16),hn(e,i.adler&65535)),i.adler=1,e.status=gi,at(i),e.pending!==0)return e.last_flush=-1,ze}if(e.status===ha){if(i.adler=0,we(e,31),we(e,139),we(e,8),e.gzhead)we(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),we(e,e.gzhead.time&255),we(e,e.gzhead.time>>8&255),we(e,e.gzhead.time>>16&255),we(e,e.gzhead.time>>24&255),we(e,e.level===9?2:e.strategy>=tr||e.level<2?4:0),we(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(we(e,e.gzhead.extra.length&255),we(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(i.adler=Pe(i.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=js;else if(we(e,0),we(e,0),we(e,0),we(e,0),we(e,0),we(e,e.level===9?2:e.strategy>=tr||e.level<2?4:0),we(e,uu),e.status=gi,at(i),e.pending!==0)return e.last_flush=-1,ze}if(e.status===js){if(e.gzhead.extra){let r=e.pending,a=(e.gzhead.extra.length&65535)-e.gzindex;for(;e.pending+a>e.pending_buf_size;){let u=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+u),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>r&&(i.adler=Pe(i.adler,e.pending_buf,e.pending-r,r)),e.gzindex+=u,at(i),e.pending!==0)return e.last_flush=-1,ze;r=0,a-=u}let d=new Uint8Array(e.gzhead.extra);e.pending_buf.set(d.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending+=a,e.gzhead.hcrc&&e.pending>r&&(i.adler=Pe(i.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=Gs}if(e.status===Gs){if(e.gzhead.name){let r=e.pending,a;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(i.adler=Pe(i.adler,e.pending_buf,e.pending-r,r)),at(i),e.pending!==0)return e.last_flush=-1,ze;r=0}e.gzindex<e.gzhead.name.length?a=e.gzhead.name.charCodeAt(e.gzindex++)&255:a=0,we(e,a)}while(a!==0);e.gzhead.hcrc&&e.pending>r&&(i.adler=Pe(i.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=Ws}if(e.status===Ws){if(e.gzhead.comment){let r=e.pending,a;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(i.adler=Pe(i.adler,e.pending_buf,e.pending-r,r)),at(i),e.pending!==0)return e.last_flush=-1,ze;r=0}e.gzindex<e.gzhead.comment.length?a=e.gzhead.comment.charCodeAt(e.gzindex++)&255:a=0,we(e,a)}while(a!==0);e.gzhead.hcrc&&e.pending>r&&(i.adler=Pe(i.adler,e.pending_buf,e.pending-r,r))}e.status=Vs}if(e.status===Vs){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(at(i),e.pending!==0))return e.last_flush=-1,ze;we(e,i.adler&255),we(e,i.adler>>8&255),i.adler=0}if(e.status=gi,at(i),e.pending!==0)return e.last_flush=-1,ze}if(i.avail_in!==0||e.lookahead!==0||t!==Zt&&e.status!==gn){let r=e.level===0?eh(e,t):e.strategy===tr?wu(e,t):e.strategy===Jc?mu(e,t):pn[e.level].func(e,t);if((r===ki||r===Gi)&&(e.status=gn),r===Ge||r===ki)return i.avail_out===0&&(e.last_flush=-1),ze;if(r===ji&&(t===Wc?Gc(e):t!==Eo&&(Hs(e,0,0,!1),t===Vc&&($t(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),at(i),i.avail_out===0))return e.last_flush=-1,ze}return t!==ct?ze:e.wrap<=0?To:(e.wrap===2?(we(e,i.adler&255),we(e,i.adler>>8&255),we(e,i.adler>>16&255),we(e,i.adler>>24&255),we(e,i.total_in&255),we(e,i.total_in>>8&255),we(e,i.total_in>>16&255),we(e,i.total_in>>24&255)):(hn(e,i.adler>>>16),hn(e,i.adler&65535)),at(i),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?ze:To)},Su=i=>{if(Pn(i))return Yt;const t=i.state.status;return i.state=null,t===gi?pi(i,Zc):ze},xu=(i,t)=>{let e=t.length;if(Pn(i))return Yt;const n=i.state,r=n.wrap;if(r===2||r===1&&n.status!==Ui||n.lookahead)return Yt;if(r===1&&(i.adler=Yn(i.adler,t,e,0)),n.wrap=0,e>=n.w_size){r===0&&($t(n.head),n.strstart=0,n.block_start=0,n.insert=0);let y=new Uint8Array(n.w_size);y.set(t.subarray(e-n.w_size,e),0),t=y,e=n.w_size}const a=i.avail_in,d=i.next_in,u=i.input;for(i.avail_in=e,i.next_in=0,i.input=t,Hi(n);n.lookahead>=pe;){let y=n.strstart,m=n.lookahead-(pe-1);do n.ins_h=Kt(n,n.ins_h,n.window[y+pe-1]),n.prev[y&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=y,y++;while(--m);n.strstart=y,n.lookahead=pe-1,Hi(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=pe-1,n.match_available=0,i.next_in=d,i.input=u,i.avail_in=a,n.wrap=r,ze};var Eu=ku,Tu=nh,Cu=ih,Iu=th,Yu=yu,Xu=vu,Lu=Su,Au=xu,Du="pako deflate (from Nodeca project)",bn={deflateInit:Eu,deflateInit2:Tu,deflateReset:Cu,deflateResetKeep:Iu,deflateSetHeader:Yu,deflate:Xu,deflateEnd:Lu,deflateSetDictionary:Au,deflateInfo:Du};const Ru=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var Nu=function(i){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const n in e)Ru(e,n)&&(i[n]=e[n])}}return i},Mu=i=>{let t=0;for(let n=0,r=i.length;n<r;n++)t+=i[n].length;const e=new Uint8Array(t);for(let n=0,r=0,a=i.length;n<a;n++){let d=i[n];e.set(d,r),r+=d.length}return e},Mr={assign:Nu,flattenChunks:Mu};let rh=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(i){rh=!1}const Xn=new Uint8Array(256);for(let i=0;i<256;i++)Xn[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;Xn[254]=Xn[254]=1;var Pu=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let t,e,n,r,a,d=i.length,u=0;for(r=0;r<d;r++)e=i.charCodeAt(r),(e&64512)===55296&&r+1<d&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(e=65536+(e-55296<<10)+(n-56320),r++)),u+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(u),a=0,r=0;a<u;r++)e=i.charCodeAt(r),(e&64512)===55296&&r+1<d&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(e=65536+(e-55296<<10)+(n-56320),r++)),e<128?t[a++]=e:e<2048?(t[a++]=192|e>>>6,t[a++]=128|e&63):e<65536?(t[a++]=224|e>>>12,t[a++]=128|e>>>6&63,t[a++]=128|e&63):(t[a++]=240|e>>>18,t[a++]=128|e>>>12&63,t[a++]=128|e>>>6&63,t[a++]=128|e&63);return t};const Ou=(i,t)=>{if(t<65534&&i.subarray&&rh)return String.fromCharCode.apply(null,i.length===t?i:i.subarray(0,t));let e="";for(let n=0;n<t;n++)e+=String.fromCharCode(i[n]);return e};var qu=(i,t)=>{const e=t||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,t));let n,r;const a=new Array(e*2);for(r=0,n=0;n<e;){let d=i[n++];if(d<128){a[r++]=d;continue}let u=Xn[d];if(u>4){a[r++]=65533,n+=u-1;continue}for(d&=u===2?31:u===3?15:7;u>1&&n<e;)d=d<<6|i[n++]&63,u--;if(u>1){a[r++]=65533;continue}d<65536?a[r++]=d:(d-=65536,a[r++]=55296|d>>10&1023,a[r++]=56320|d&1023)}return Ou(a,r)},Bu=(i,t)=>{t=t||i.length,t>i.length&&(t=i.length);let e=t-1;for(;e>=0&&(i[e]&192)===128;)e--;return e<0||e===0?t:e+Xn[i[e]]>t?e:t},Ln={string2buf:Pu,buf2string:qu,utf8border:Bu};function zu(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var sh=zu;const ah=Object.prototype.toString,{Z_NO_FLUSH:Fu,Z_SYNC_FLUSH:Uu,Z_FULL_FLUSH:Hu,Z_FINISH:$u,Z_OK:Sr,Z_STREAM_END:ju,Z_DEFAULT_COMPRESSION:Gu,Z_DEFAULT_STRATEGY:Wu,Z_DEFLATED:Vu}=Mn;function da(i){this.options=Mr.assign({level:Gu,method:Vu,chunkSize:16384,windowBits:15,memLevel:8,strategy:Wu},i||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new sh,this.strm.avail_out=0;let e=bn.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==Sr)throw new Error(Fi[e]);if(t.header&&bn.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Ln.string2buf(t.dictionary):ah.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,e=bn.deflateSetDictionary(this.strm,n),e!==Sr)throw new Error(Fi[e]);this._dict_set=!0}}da.prototype.push=function(i,t){const e=this.strm,n=this.options.chunkSize;let r,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?$u:Fu,typeof i=="string"?e.input=Ln.string2buf(i):ah.call(i)==="[object ArrayBuffer]"?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(n),e.next_out=0,e.avail_out=n),(a===Uu||a===Hu)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(r=bn.deflate(e,a),r===ju)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=bn.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Sr;if(e.avail_out===0){this.onData(e.output);continue}if(a>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0};da.prototype.onData=function(i){this.chunks.push(i)};da.prototype.onEnd=function(i){i===Sr&&(this.result=Mr.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};const ir=16209,Zu=16191;var Ku=function(t,e){let n,r,a,d,u,y,m,b,E,Y,I,A,O,J,F,ue,j,z,te,c,W,ge,oe,ne;const fe=t.state;n=t.next_in,oe=t.input,r=n+(t.avail_in-5),a=t.next_out,ne=t.output,d=a-(e-t.avail_out),u=a+(t.avail_out-257),y=fe.dmax,m=fe.wsize,b=fe.whave,E=fe.wnext,Y=fe.window,I=fe.hold,A=fe.bits,O=fe.lencode,J=fe.distcode,F=(1<<fe.lenbits)-1,ue=(1<<fe.distbits)-1;e:do{A<15&&(I+=oe[n++]<<A,A+=8,I+=oe[n++]<<A,A+=8),j=O[I&F];t:for(;;){if(z=j>>>24,I>>>=z,A-=z,z=j>>>16&255,z===0)ne[a++]=j&65535;else if(z&16){te=j&65535,z&=15,z&&(A<z&&(I+=oe[n++]<<A,A+=8),te+=I&(1<<z)-1,I>>>=z,A-=z),A<15&&(I+=oe[n++]<<A,A+=8,I+=oe[n++]<<A,A+=8),j=J[I&ue];i:for(;;){if(z=j>>>24,I>>>=z,A-=z,z=j>>>16&255,z&16){if(c=j&65535,z&=15,A<z&&(I+=oe[n++]<<A,A+=8,A<z&&(I+=oe[n++]<<A,A+=8)),c+=I&(1<<z)-1,c>y){t.msg="invalid distance too far back",fe.mode=ir;break e}if(I>>>=z,A-=z,z=a-d,c>z){if(z=c-z,z>b&&fe.sane){t.msg="invalid distance too far back",fe.mode=ir;break e}if(W=0,ge=Y,E===0){if(W+=m-z,z<te){te-=z;do ne[a++]=Y[W++];while(--z);W=a-c,ge=ne}}else if(E<z){if(W+=m+E-z,z-=E,z<te){te-=z;do ne[a++]=Y[W++];while(--z);if(W=0,E<te){z=E,te-=z;do ne[a++]=Y[W++];while(--z);W=a-c,ge=ne}}}else if(W+=E-z,z<te){te-=z;do ne[a++]=Y[W++];while(--z);W=a-c,ge=ne}for(;te>2;)ne[a++]=ge[W++],ne[a++]=ge[W++],ne[a++]=ge[W++],te-=3;te&&(ne[a++]=ge[W++],te>1&&(ne[a++]=ge[W++]))}else{W=a-c;do ne[a++]=ne[W++],ne[a++]=ne[W++],ne[a++]=ne[W++],te-=3;while(te>2);te&&(ne[a++]=ne[W++],te>1&&(ne[a++]=ne[W++]))}}else if(z&64){t.msg="invalid distance code",fe.mode=ir;break e}else{j=J[(j&65535)+(I&(1<<z)-1)];continue i}break}}else if(z&64)if(z&32){fe.mode=Zu;break e}else{t.msg="invalid literal/length code",fe.mode=ir;break e}else{j=O[(j&65535)+(I&(1<<z)-1)];continue t}break}}while(n<r&&a<u);te=A>>3,n-=te,A-=te<<3,I&=(1<<A)-1,t.next_in=n,t.next_out=a,t.avail_in=n<r?5+(r-n):5-(n-r),t.avail_out=a<u?257+(u-a):257-(a-u),fe.hold=I,fe.bits=A};const Mi=15,Io=852,Yo=592,Xo=0,ms=1,Lo=2,Qu=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ju=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),eg=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),tg=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ig=(i,t,e,n,r,a,d,u)=>{const y=u.bits;let m=0,b=0,E=0,Y=0,I=0,A=0,O=0,J=0,F=0,ue=0,j,z,te,c,W,ge=null,oe;const ne=new Uint16Array(Mi+1),fe=new Uint16Array(Mi+1);let Le=null,Vi,Ft,ei;for(m=0;m<=Mi;m++)ne[m]=0;for(b=0;b<n;b++)ne[t[e+b]]++;for(I=y,Y=Mi;Y>=1&&ne[Y]===0;Y--);if(I>Y&&(I=Y),Y===0)return r[a++]=1<<24|64<<16|0,r[a++]=1<<24|64<<16|0,u.bits=1,0;for(E=1;E<Y&&ne[E]===0;E++);for(I<E&&(I=E),J=1,m=1;m<=Mi;m++)if(J<<=1,J-=ne[m],J<0)return-1;if(J>0&&(i===Xo||Y!==1))return-1;for(fe[1]=0,m=1;m<Mi;m++)fe[m+1]=fe[m]+ne[m];for(b=0;b<n;b++)t[e+b]!==0&&(d[fe[t[e+b]]++]=b);if(i===Xo?(ge=Le=d,oe=20):i===ms?(ge=Qu,Le=Ju,oe=257):(ge=eg,Le=tg,oe=0),ue=0,b=0,m=E,W=a,A=I,O=0,te=-1,F=1<<I,c=F-1,i===ms&&F>Io||i===Lo&&F>Yo)return 1;for(;;){Vi=m-O,d[b]+1<oe?(Ft=0,ei=d[b]):d[b]>=oe?(Ft=Le[d[b]-oe],ei=ge[d[b]-oe]):(Ft=32+64,ei=0),j=1<<m-O,z=1<<A,E=z;do z-=j,r[W+(ue>>O)+z]=Vi<<24|Ft<<16|ei|0;while(z!==0);for(j=1<<m-1;ue&j;)j>>=1;if(j!==0?(ue&=j-1,ue+=j):ue=0,b++,--ne[m]===0){if(m===Y)break;m=t[e+d[b]]}if(m>I&&(ue&c)!==te){for(O===0&&(O=I),W+=E,A=m-O,J=1<<A;A+O<Y&&(J-=ne[A+O],!(J<=0));)A++,J<<=1;if(F+=1<<A,i===ms&&F>Io||i===Lo&&F>Yo)return 1;te=ue&c,r[te]=I<<24|A<<16|W-a|0}}return ue!==0&&(r[W+ue]=m-O<<24|64<<16|0),u.bits=I,0};var yn=ig;const ng=0,oh=1,lh=2,{Z_FINISH:Ao,Z_BLOCK:rg,Z_TREES:nr,Z_OK:vi,Z_STREAM_END:sg,Z_NEED_DICT:ag,Z_STREAM_ERROR:ut,Z_DATA_ERROR:hh,Z_MEM_ERROR:dh,Z_BUF_ERROR:og,Z_DEFLATED:Do}=Mn,Pr=16180,Ro=16181,No=16182,Mo=16183,Po=16184,Oo=16185,qo=16186,Bo=16187,zo=16188,Fo=16189,xr=16190,Nt=16191,ws=16192,Uo=16193,_s=16194,Ho=16195,$o=16196,jo=16197,Go=16198,rr=16199,sr=16200,Wo=16201,Vo=16202,Zo=16203,Ko=16204,Qo=16205,bs=16206,Jo=16207,el=16208,Te=16209,fh=16210,ch=16211,lg=852,hg=592,dg=15,fg=dg,tl=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function cg(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const xi=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.mode<Pr||t.mode>ch?1:0},uh=i=>{if(xi(i))return ut;const t=i.state;return i.total_in=i.total_out=t.total=0,i.msg="",t.wrap&&(i.adler=t.wrap&1),t.mode=Pr,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(lg),t.distcode=t.distdyn=new Int32Array(hg),t.sane=1,t.back=-1,vi},gh=i=>{if(xi(i))return ut;const t=i.state;return t.wsize=0,t.whave=0,t.wnext=0,uh(i)},ph=(i,t)=>{let e;if(xi(i))return ut;const n=i.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?ut:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=e,n.wbits=t,gh(i))},mh=(i,t)=>{if(!i)return ut;const e=new cg;i.state=e,e.strm=i,e.window=null,e.mode=Pr;const n=ph(i,t);return n!==vi&&(i.state=null),n},ug=i=>mh(i,fg);let il=!0,ys,ks;const gg=i=>{if(il){ys=new Int32Array(512),ks=new Int32Array(32);let t=0;for(;t<144;)i.lens[t++]=8;for(;t<256;)i.lens[t++]=9;for(;t<280;)i.lens[t++]=7;for(;t<288;)i.lens[t++]=8;for(yn(oh,i.lens,0,288,ys,0,i.work,{bits:9}),t=0;t<32;)i.lens[t++]=5;yn(lh,i.lens,0,32,ks,0,i.work,{bits:5}),il=!1}i.lencode=ys,i.lenbits=9,i.distcode=ks,i.distbits=5},wh=(i,t,e,n)=>{let r;const a=i.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(e-a.wsize,e),0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>n&&(r=n),a.window.set(t.subarray(e-n,e-n+r),a.wnext),n-=r,n?(a.window.set(t.subarray(e-n,e),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0},pg=(i,t)=>{let e,n,r,a,d,u,y,m,b,E,Y,I,A,O,J=0,F,ue,j,z,te,c,W,ge;const oe=new Uint8Array(4);let ne,fe;const Le=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(xi(i)||!i.output||!i.input&&i.avail_in!==0)return ut;e=i.state,e.mode===Nt&&(e.mode=ws),d=i.next_out,r=i.output,y=i.avail_out,a=i.next_in,n=i.input,u=i.avail_in,m=e.hold,b=e.bits,E=u,Y=y,ge=vi;e:for(;;)switch(e.mode){case Pr:if(e.wrap===0){e.mode=ws;break}for(;b<16;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(e.wrap&2&&m===35615){e.wbits===0&&(e.wbits=15),e.check=0,oe[0]=m&255,oe[1]=m>>>8&255,e.check=Pe(e.check,oe,2,0),m=0,b=0,e.mode=Ro;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((m&255)<<8)+(m>>8))%31){i.msg="incorrect header check",e.mode=Te;break}if((m&15)!==Do){i.msg="unknown compression method",e.mode=Te;break}if(m>>>=4,b-=4,W=(m&15)+8,e.wbits===0&&(e.wbits=W),W>15||W>e.wbits){i.msg="invalid window size",e.mode=Te;break}e.dmax=1<<e.wbits,e.flags=0,i.adler=e.check=1,e.mode=m&512?Fo:Nt,m=0,b=0;break;case Ro:for(;b<16;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(e.flags=m,(e.flags&255)!==Do){i.msg="unknown compression method",e.mode=Te;break}if(e.flags&57344){i.msg="unknown header flags set",e.mode=Te;break}e.head&&(e.head.text=m>>8&1),e.flags&512&&e.wrap&4&&(oe[0]=m&255,oe[1]=m>>>8&255,e.check=Pe(e.check,oe,2,0)),m=0,b=0,e.mode=No;case No:for(;b<32;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}e.head&&(e.head.time=m),e.flags&512&&e.wrap&4&&(oe[0]=m&255,oe[1]=m>>>8&255,oe[2]=m>>>16&255,oe[3]=m>>>24&255,e.check=Pe(e.check,oe,4,0)),m=0,b=0,e.mode=Mo;case Mo:for(;b<16;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}e.head&&(e.head.xflags=m&255,e.head.os=m>>8),e.flags&512&&e.wrap&4&&(oe[0]=m&255,oe[1]=m>>>8&255,e.check=Pe(e.check,oe,2,0)),m=0,b=0,e.mode=Po;case Po:if(e.flags&1024){for(;b<16;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}e.length=m,e.head&&(e.head.extra_len=m),e.flags&512&&e.wrap&4&&(oe[0]=m&255,oe[1]=m>>>8&255,e.check=Pe(e.check,oe,2,0)),m=0,b=0}else e.head&&(e.head.extra=null);e.mode=Oo;case Oo:if(e.flags&1024&&(I=e.length,I>u&&(I=u),I&&(e.head&&(W=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(n.subarray(a,a+I),W)),e.flags&512&&e.wrap&4&&(e.check=Pe(e.check,n,I,a)),u-=I,a+=I,e.length-=I),e.length))break e;e.length=0,e.mode=qo;case qo:if(e.flags&2048){if(u===0)break e;I=0;do W=n[a+I++],e.head&&W&&e.length<65536&&(e.head.name+=String.fromCharCode(W));while(W&&I<u);if(e.flags&512&&e.wrap&4&&(e.check=Pe(e.check,n,I,a)),u-=I,a+=I,W)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=Bo;case Bo:if(e.flags&4096){if(u===0)break e;I=0;do W=n[a+I++],e.head&&W&&e.length<65536&&(e.head.comment+=String.fromCharCode(W));while(W&&I<u);if(e.flags&512&&e.wrap&4&&(e.check=Pe(e.check,n,I,a)),u-=I,a+=I,W)break e}else e.head&&(e.head.comment=null);e.mode=zo;case zo:if(e.flags&512){for(;b<16;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(e.wrap&4&&m!==(e.check&65535)){i.msg="header crc mismatch",e.mode=Te;break}m=0,b=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),i.adler=e.check=0,e.mode=Nt;break;case Fo:for(;b<32;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}i.adler=e.check=tl(m),m=0,b=0,e.mode=xr;case xr:if(e.havedict===0)return i.next_out=d,i.avail_out=y,i.next_in=a,i.avail_in=u,e.hold=m,e.bits=b,ag;i.adler=e.check=1,e.mode=Nt;case Nt:if(t===rg||t===nr)break e;case ws:if(e.last){m>>>=b&7,b-=b&7,e.mode=bs;break}for(;b<3;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}switch(e.last=m&1,m>>>=1,b-=1,m&3){case 0:e.mode=Uo;break;case 1:if(gg(e),e.mode=rr,t===nr){m>>>=2,b-=2;break e}break;case 2:e.mode=$o;break;case 3:i.msg="invalid block type",e.mode=Te}m>>>=2,b-=2;break;case Uo:for(m>>>=b&7,b-=b&7;b<32;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if((m&65535)!==(m>>>16^65535)){i.msg="invalid stored block lengths",e.mode=Te;break}if(e.length=m&65535,m=0,b=0,e.mode=_s,t===nr)break e;case _s:e.mode=Ho;case Ho:if(I=e.length,I){if(I>u&&(I=u),I>y&&(I=y),I===0)break e;r.set(n.subarray(a,a+I),d),u-=I,a+=I,y-=I,d+=I,e.length-=I;break}e.mode=Nt;break;case $o:for(;b<14;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(e.nlen=(m&31)+257,m>>>=5,b-=5,e.ndist=(m&31)+1,m>>>=5,b-=5,e.ncode=(m&15)+4,m>>>=4,b-=4,e.nlen>286||e.ndist>30){i.msg="too many length or distance symbols",e.mode=Te;break}e.have=0,e.mode=jo;case jo:for(;e.have<e.ncode;){for(;b<3;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}e.lens[Le[e.have++]]=m&7,m>>>=3,b-=3}for(;e.have<19;)e.lens[Le[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,ne={bits:e.lenbits},ge=yn(ng,e.lens,0,19,e.lencode,0,e.work,ne),e.lenbits=ne.bits,ge){i.msg="invalid code lengths set",e.mode=Te;break}e.have=0,e.mode=Go;case Go:for(;e.have<e.nlen+e.ndist;){for(;J=e.lencode[m&(1<<e.lenbits)-1],F=J>>>24,ue=J>>>16&255,j=J&65535,!(F<=b);){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(j<16)m>>>=F,b-=F,e.lens[e.have++]=j;else{if(j===16){for(fe=F+2;b<fe;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(m>>>=F,b-=F,e.have===0){i.msg="invalid bit length repeat",e.mode=Te;break}W=e.lens[e.have-1],I=3+(m&3),m>>>=2,b-=2}else if(j===17){for(fe=F+3;b<fe;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}m>>>=F,b-=F,W=0,I=3+(m&7),m>>>=3,b-=3}else{for(fe=F+7;b<fe;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}m>>>=F,b-=F,W=0,I=11+(m&127),m>>>=7,b-=7}if(e.have+I>e.nlen+e.ndist){i.msg="invalid bit length repeat",e.mode=Te;break}for(;I--;)e.lens[e.have++]=W}}if(e.mode===Te)break;if(e.lens[256]===0){i.msg="invalid code -- missing end-of-block",e.mode=Te;break}if(e.lenbits=9,ne={bits:e.lenbits},ge=yn(oh,e.lens,0,e.nlen,e.lencode,0,e.work,ne),e.lenbits=ne.bits,ge){i.msg="invalid literal/lengths set",e.mode=Te;break}if(e.distbits=6,e.distcode=e.distdyn,ne={bits:e.distbits},ge=yn(lh,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,ne),e.distbits=ne.bits,ge){i.msg="invalid distances set",e.mode=Te;break}if(e.mode=rr,t===nr)break e;case rr:e.mode=sr;case sr:if(u>=6&&y>=258){i.next_out=d,i.avail_out=y,i.next_in=a,i.avail_in=u,e.hold=m,e.bits=b,Ku(i,Y),d=i.next_out,r=i.output,y=i.avail_out,a=i.next_in,n=i.input,u=i.avail_in,m=e.hold,b=e.bits,e.mode===Nt&&(e.back=-1);break}for(e.back=0;J=e.lencode[m&(1<<e.lenbits)-1],F=J>>>24,ue=J>>>16&255,j=J&65535,!(F<=b);){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(ue&&!(ue&240)){for(z=F,te=ue,c=j;J=e.lencode[c+((m&(1<<z+te)-1)>>z)],F=J>>>24,ue=J>>>16&255,j=J&65535,!(z+F<=b);){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}m>>>=z,b-=z,e.back+=z}if(m>>>=F,b-=F,e.back+=F,e.length=j,ue===0){e.mode=Qo;break}if(ue&32){e.back=-1,e.mode=Nt;break}if(ue&64){i.msg="invalid literal/length code",e.mode=Te;break}e.extra=ue&15,e.mode=Wo;case Wo:if(e.extra){for(fe=e.extra;b<fe;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}e.length+=m&(1<<e.extra)-1,m>>>=e.extra,b-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=Vo;case Vo:for(;J=e.distcode[m&(1<<e.distbits)-1],F=J>>>24,ue=J>>>16&255,j=J&65535,!(F<=b);){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(!(ue&240)){for(z=F,te=ue,c=j;J=e.distcode[c+((m&(1<<z+te)-1)>>z)],F=J>>>24,ue=J>>>16&255,j=J&65535,!(z+F<=b);){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}m>>>=z,b-=z,e.back+=z}if(m>>>=F,b-=F,e.back+=F,ue&64){i.msg="invalid distance code",e.mode=Te;break}e.offset=j,e.extra=ue&15,e.mode=Zo;case Zo:if(e.extra){for(fe=e.extra;b<fe;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}e.offset+=m&(1<<e.extra)-1,m>>>=e.extra,b-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){i.msg="invalid distance too far back",e.mode=Te;break}e.mode=Ko;case Ko:if(y===0)break e;if(I=Y-y,e.offset>I){if(I=e.offset-I,I>e.whave&&e.sane){i.msg="invalid distance too far back",e.mode=Te;break}I>e.wnext?(I-=e.wnext,A=e.wsize-I):A=e.wnext-I,I>e.length&&(I=e.length),O=e.window}else O=r,A=d-e.offset,I=e.length;I>y&&(I=y),y-=I,e.length-=I;do r[d++]=O[A++];while(--I);e.length===0&&(e.mode=sr);break;case Qo:if(y===0)break e;r[d++]=e.length,y--,e.mode=sr;break;case bs:if(e.wrap){for(;b<32;){if(u===0)break e;u--,m|=n[a++]<<b,b+=8}if(Y-=y,i.total_out+=Y,e.total+=Y,e.wrap&4&&Y&&(i.adler=e.check=e.flags?Pe(e.check,r,Y,d-Y):Yn(e.check,r,Y,d-Y)),Y=y,e.wrap&4&&(e.flags?m:tl(m))!==e.check){i.msg="incorrect data check",e.mode=Te;break}m=0,b=0}e.mode=Jo;case Jo:if(e.wrap&&e.flags){for(;b<32;){if(u===0)break e;u--,m+=n[a++]<<b,b+=8}if(e.wrap&4&&m!==(e.total&4294967295)){i.msg="incorrect length check",e.mode=Te;break}m=0,b=0}e.mode=el;case el:ge=sg;break e;case Te:ge=hh;break e;case fh:return dh;case ch:default:return ut}return i.next_out=d,i.avail_out=y,i.next_in=a,i.avail_in=u,e.hold=m,e.bits=b,(e.wsize||Y!==i.avail_out&&e.mode<Te&&(e.mode<bs||t!==Ao))&&wh(i,i.output,i.next_out,Y-i.avail_out),E-=i.avail_in,Y-=i.avail_out,i.total_in+=E,i.total_out+=Y,e.total+=Y,e.wrap&4&&Y&&(i.adler=e.check=e.flags?Pe(e.check,r,Y,i.next_out-Y):Yn(e.check,r,Y,i.next_out-Y)),i.data_type=e.bits+(e.last?64:0)+(e.mode===Nt?128:0)+(e.mode===rr||e.mode===_s?256:0),(E===0&&Y===0||t===Ao)&&ge===vi&&(ge=og),ge},mg=i=>{if(xi(i))return ut;let t=i.state;return t.window&&(t.window=null),i.state=null,vi},wg=(i,t)=>{if(xi(i))return ut;const e=i.state;return e.wrap&2?(e.head=t,t.done=!1,vi):ut},_g=(i,t)=>{const e=t.length;let n,r,a;return xi(i)||(n=i.state,n.wrap!==0&&n.mode!==xr)?ut:n.mode===xr&&(r=1,r=Yn(r,t,e,0),r!==n.check)?hh:(a=wh(i,t,e,e),a?(n.mode=fh,dh):(n.havedict=1,vi))};var bg=gh,yg=ph,kg=uh,vg=ug,Sg=mh,xg=pg,Eg=mg,Tg=wg,Cg=_g,Ig="pako inflate (from Nodeca project)",zt={inflateReset:bg,inflateReset2:yg,inflateResetKeep:kg,inflateInit:vg,inflateInit2:Sg,inflate:xg,inflateEnd:Eg,inflateGetHeader:Tg,inflateSetDictionary:Cg,inflateInfo:Ig};function Yg(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Xg=Yg;const _h=Object.prototype.toString,{Z_NO_FLUSH:Lg,Z_FINISH:Ag,Z_OK:An,Z_STREAM_END:vs,Z_NEED_DICT:Ss,Z_STREAM_ERROR:Dg,Z_DATA_ERROR:nl,Z_MEM_ERROR:Rg}=Mn;function On(i){this.options=Mr.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(i&&i.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new sh,this.strm.avail_out=0;let e=zt.inflateInit2(this.strm,t.windowBits);if(e!==An)throw new Error(Fi[e]);if(this.header=new Xg,zt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Ln.string2buf(t.dictionary):_h.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=zt.inflateSetDictionary(this.strm,t.dictionary),e!==An)))throw new Error(Fi[e])}On.prototype.push=function(i,t){const e=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let a,d,u;if(this.ended)return!1;for(t===~~t?d=t:d=t===!0?Ag:Lg,_h.call(i)==="[object ArrayBuffer]"?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(n),e.next_out=0,e.avail_out=n),a=zt.inflate(e,d),a===Ss&&r&&(a=zt.inflateSetDictionary(e,r),a===An?a=zt.inflate(e,d):a===nl&&(a=Ss));e.avail_in>0&&a===vs&&e.state.wrap>0&&i[e.next_in]!==0;)zt.inflateReset(e),a=zt.inflate(e,d);switch(a){case Dg:case nl:case Ss:case Rg:return this.onEnd(a),this.ended=!0,!1}if(u=e.avail_out,e.next_out&&(e.avail_out===0||a===vs))if(this.options.to==="string"){let y=Ln.utf8border(e.output,e.next_out),m=e.next_out-y,b=Ln.buf2string(e.output,y);e.next_out=m,e.avail_out=n-m,m&&e.output.set(e.output.subarray(y,y+m),0),this.onData(b)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(a===An&&u===0)){if(a===vs)return a=zt.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};On.prototype.onData=function(i){this.chunks.push(i)};On.prototype.onEnd=function(i){i===An&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Mr.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function fa(i,t){const e=new On(t);if(e.push(i),e.err)throw e.msg||Fi[e.err];return e.result}function Ng(i,t){return t=t||{},t.raw=!0,fa(i,t)}var Mg=On,Pg=fa,Og=Ng,qg=fa,Bg=Mn,zg={Inflate:Mg,inflate:Pg,inflateRaw:Og,ungzip:qg,constants:Bg};const{Inflate:Am,inflate:Fg,inflateRaw:Dm,ungzip:Rm}=zg;var Ug=Fg;class Hg{constructor(t){l(this,"app");l(this,"overlays");l(this,"info");l(this,"map");l(this,"camera");l(this,"renderer");l(this,"input");l(this,"socket");l(this,"pointer");l(this,"audio");l(this,"entities");l(this,"bubble");l(this,"menu");l(this,"sprites");l(this,"messages");l(this,"lastEntityListRequest",Date.now());this.game=t,this.app=t.app,this.overlays=t.overlays,this.info=t.info,this.map=t.map,this.camera=t.camera,this.renderer=t.renderer,this.input=t.input,this.socket=t.socket,this.pointer=t.pointer,this.audio=t.audio,this.entities=t.entities,this.bubble=t.bubble,this.menu=t.menu,this.sprites=t.sprites,this.messages=this.socket.messages,this.app.onFocus(()=>this.socket.send(B.Focus)),this.messages.onHandshake(this.handleHandshake.bind(this)),this.messages.onWelcome(this.handleWelcome.bind(this)),this.messages.onMap(this.handleMap.bind(this)),this.messages.onEquipment(this.handleEquipment.bind(this)),this.messages.onSpawn(this.entities.create.bind(this.entities)),this.messages.onEntityList(this.handleEntityList.bind(this)),this.messages.onSync(this.handleSync.bind(this)),this.messages.onMovement(this.handleMovement.bind(this)),this.messages.onTeleport(this.handleTeleport.bind(this)),this.messages.onDespawn(this.handleDespawn.bind(this)),this.messages.onCombat(this.handleCombat.bind(this)),this.messages.onAnimation(this.handleAnimation.bind(this)),this.messages.onPoints(this.handlePoints.bind(this)),this.messages.onNetwork(this.handleNetwork.bind(this)),this.messages.onChat(this.handleChat.bind(this)),this.messages.onCommand(this.handleCommand.bind(this)),this.messages.onContainer(this.handleContainer.bind(this)),this.messages.onAbility(this.handleAbility.bind(this)),this.messages.onQuest(this.handleQuest.bind(this)),this.messages.onAchievement(this.handleAchievement.bind(this)),this.messages.onNotification(this.handleNotification.bind(this)),this.messages.onBlink(this.handleBlink.bind(this)),this.messages.onHeal(this.handleHeal.bind(this)),this.messages.onExperience(this.handleExperience.bind(this)),this.messages.onDeath(this.handleDeath.bind(this)),this.messages.onMusic(this.handleMusic.bind(this)),this.messages.onNPC(this.handleNPC.bind(this)),this.messages.onRespawn(this.handleRespawn.bind(this)),this.messages.onTrade(this.handleTrade.bind(this)),this.messages.onEnchant(this.handleEnchant.bind(this)),this.messages.onGuild(this.handleGuild.bind(this)),this.messages.onPointer(this.handlePointer.bind(this)),this.messages.onPVP(this.handlePVP.bind(this)),this.messages.onPoison(this.handlePoison.bind(this)),this.messages.onStore(this.handleStore.bind(this)),this.messages.onOverlay(this.handleOverlay.bind(this)),this.messages.onCamera(this.handleCamera.bind(this)),this.messages.onBubble(this.handleBubble.bind(this)),this.messages.onSkill(this.handleSkill.bind(this)),this.messages.onUpdate(this.handleUpdate.bind(this)),this.messages.onMinigame(this.handleMinigame.bind(this)),this.messages.onEffect(this.handleEffect.bind(this)),this.messages.onFriends(this.handleFriends.bind(this)),this.messages.onRank(this.handleRank.bind(this)),this.messages.onCrafting(this.handleCrafting.bind(this))}handleHandshake(t){if(this.app.updateLoader("Connecting to server"),this.game.player.instance=t.instance,this.game.player.serverId=t.serverId,this.app.isGuest())return this.socket.send(B.Login,{opcode:dr.Guest});let e=this.app.getUsername(),n=this.app.getPassword(),r=this.app.getEmail();if(this.game.player.name=e.toLowerCase(),this.app.isRegistering())return this.socket.send(B.Login,{opcode:dr.Register,username:e,password:n,email:r});this.socket.send(B.Login,{opcode:dr.Login,username:e,password:n})}handleWelcome(t){this.game.player.load(t),this.game.start(),this.game.postLoad()}handleMap(t){let e=window.atob(t).split("").map(a=>a.charCodeAt(0)),n=Ug(new Uint8Array(e),{to:"string"}),r=JSON.parse(n);this.map.loadRegions(r),this.renderer.forceRendering=!0,this.renderer.updateAnimatedTiles(),this.map.hasCachedDate()||this.app.fadeMenu()}handleEquipment(t,e){switch(t){case fi.Batch:{for(let n of e.data.equipments)this.game.player.equip(n);break}case fi.Equip:{this.game.player.equip(e.data);break}case fi.Unequip:{this.game.player.unequip(e.type,e.count);break}case fi.Style:{this.game.player.setAttackStyle(e.attackStyle),this.game.player.attackRange=e.attackRange;break}}this.game.player.sync()}handleEntityList(t,e){switch(t){case Rs.Spawns:{let n=new Set(Object.values(this.entities.getAll()).map(d=>d.instance)),r=new Set(e.entities.filter(d=>n.has(d))),a=e.entities.filter(d=>!r.has(d));this.entities.decrepit=Object.values(this.entities.getAll()).filter(d=>!r.has(d.instance)&&d.instance!==this.game.player.instance),this.entities.clean(),this.socket.send(B.Who,a);break}case Rs.Positions:for(let n in e.positions){let r=e.positions[n],a=this.entities.get(n);if(!a||a.moving||a.hasPath())return;(a.gridX!==r.x||a.gridY!==r.y)&&this.game.teleport(a,r.x,r.y)}}}handleSync(t){let e=this.entities.get(t.instance);!e||e.teleporting||e.dead||!e.ready||(e.load(t,!0),e.setSprite(this.game.sprites.get(e.getSpriteName())))}handleMovement(t,e){let n=this.entities.get(e.instance),r;if(!n)return this.canRequestEntityList()?(this.lastEntityListRequest=Date.now(),this.socket.send(B.List)):void 0;switch(t){case Ct.Move:{e.forced&&n.stop(!0),n.go(e.x,e.y,!1,e.instance!==this.game.player.instance);break}case Ct.Follow:{if(r=this.entities.get(e.target),r){if(n.instance===this.game.player.instance&&!this.game.player.hasTarget()&&!e.forced)return;n.follow(r)}break}case Ct.Stop:{e.forced&&n.stop(!0);break}case Ct.Speed:{n.movementSpeed=e.movementSpeed;break}}}handleTeleport(t){let e=this.entities.get(t.instance);if(!(e!=null&&e.isMob())&&!(e!=null&&e.isPlayer()))return;this.input.selectedCellVisible=!1;let n=e.instance===this.game.player.instance;if(e.stop(!0),e.frozen=!0,n?(this.bubble.clean(),this.game.player.disableAction=!0):this.bubble.clear(e.instance),!t.withAnimation)return this.game.teleport(e,t.x,t.y);let r=e.sprite.key;e.teleporting=!0,e.setSprite(this.sprites.getDeath()),e.animateDeath(()=>{this.game.teleport(e,t.x,t.y),e.animation=null,e.setSprite(this.sprites.get(r)),e.idle(e.orientation,!0)},160)}handleDespawn(t){let e=this.entities.get(t.instance);if(e&&!(t.regions&&!t.regions.includes(e.region))){if(e.isItem())return this.entities.removeItem(e);if(e.isChest())return this.entities.removeChest(e);if(e.isNPC())return this.entities.removeNPC(e);e.despawn(),this.bubble.clear(e.instance),this.game.player.hasTarget(e)&&this.game.player.removeTarget(),this.audio.playKillSound(e),e.sprite.hasDeathAnimation||e.setSprite(this.sprites.getDeath()),e.animateDeath(()=>this.entities.removeEntity(e))}}handleCombat(t,e){let n=this.entities.get(e.instance),r=this.entities.get(e.target);if(!n||!r||t!==Tl.Hit)return;let a=r.instance===this.game.player.instance,d=n.instance===this.game.player.instance,u=e.hit.type===Ne.Poison,y=e.hit.type===Ne.Freezing,m=e.hit.type===Ne.Burning;u&&r.addEffect(_e.Poisonball),e.hit.type===Ne.Critical&&r.addEffect(_e.Critical),!e.hit.aoe&&!u&&!y&&!m&&(n.lookAt(r),n.performAction(n.orientation,st.Attack)),d&&e.hit.damage>0&&this.audio.playHitSound(r),a&&e.hit.damage>0&&this.audio.playSound("hurt"),this.info.create(e.hit.type,e.hit.damage,r.x,r.y,a),e.hit.damage>0&&r.toggleHurt(),n.triggerHealthBar(),r.triggerHealthBar()}handleAnimation(t){let e=this.entities.get(t.instance);e&&e.performAction(e.orientation,t.action)}handlePoints(t){var n,r;let e=this.entities.get(t.instance);!e||e.dead||(t.mana&&e.setMana(t.mana,t.maxMana),t.hitPoints&&(e.setHitPoints(t.hitPoints,t.maxHitPoints),(r=(n=this.input.hud).updateCallback)==null||r.call(n,t.instance,t.hitPoints)))}handleNetwork(){this.socket.send(B.Network,[Cl.Pong])}handleChat(t){if(t.source)return this.input.chatHandler.add(t.source,t.message,t.colour,!0);let e=this.entities.get(t.instance);if(!e)return;let{name:n,rank:r,x:a,y:d}=e;r!==$e.None&&(n=`[${tf[r]}] ${n}`),this.input.chatHandler.add(n,t.message,t.colour),t.withBubble&&(this.bubble.create(t.instance,t.message),this.bubble.setTo(t.instance,a,d),this.audio.playSound("npctalk",e))}handleCommand(t){if(t.command.includes("toggle")&&this.game.player.hasActiveEffect())return this.game.player.removeAllEffects();switch(t.command){case"debug":{this.renderer.debugging=!this.renderer.debugging;return}}}handleContainer(t,e){let n=e.type===qe.Inventory?this.menu.getInventory():this.menu.getBank();switch(t){case It.Batch:{n.batch(e.data.slots);break}case It.Add:{n.add(e.slot);break}case It.Remove:{n.remove(e.slot);break}}this.menu.synchronize()}handleAbility(t,e){switch(t){case ci.Batch:{this.game.player.loadAbilities(e.abilities);break}case ci.Add:case ci.Update:{e=e,this.game.player.setAbility(e.key,e.level,e.type,e.quickSlot);break}case ci.Toggle:{this.game.player.toggleAbility(e.key);break}}this.menu.synchronize("profile")}handleQuest(t,e){switch(t){case Sn.Batch:{this.game.player.loadQuests(e.quests);break}case Sn.Progress:{this.game.player.setQuest(e.key,e.stage,e.subStage);break}}this.menu.getQuests().handle(t,e.key)}handleAchievement(t,e){switch(t){case _r.Batch:{this.game.player.loadAchievements(e.achievements);break}case _r.Progress:{this.game.player.setAchievement(e.key,e.stage,e.name,e.description);break}}this.menu.getAchievements().handle(t,e.key)}handleNotification(t,e){switch(t){case Ns.Text:return this.input.chatHandler.add(e.source||"WORLD",e.message,e.colour,!0);case Ns.Popup:return this.menu.getNotification().show(e.title,e.message,e.colour)}}handleBlink(t){let e=this.entities.get(t);e==null||e.blink()}handleHeal(t){let e=this.entities.get(t.instance);if(e){switch(t.type){case"hitpoints":{this.info.create(Ne.Heal,t.amount,e.x,e.y),e.addEffect(_e.Healing);break}case"mana":{this.info.create(Ne.Mana,t.amount,e.x,e.y);break}}e.triggerHealthBar()}}handleExperience(t,e){let n=this.entities.get(e.instance);if(!n)return;let r=n.instance===this.game.player.instance;switch(t){case Ms.Sync:{n.level=e.level;break}case Ms.Skill:{r&&this.info.create(Ne.Profession,e.amount,n.x,n.y,!1,e.skill,!0);break}}}handleDeath(){this.game.player.stop(!0),this.game.player.removeAllEffects(),this.game.minigame.reset(),this.game.player.teleporting=!0,this.game.player.setSprite(this.sprites.getDeath()),this.game.player.setHitPoints(0),this.game.player.setMana(0),this.audio.stopMusic(),this.game.player.animateDeath(()=>{this.game.entities.unregisterPosition(this.game.player),this.game.player.despawn(),this.app.body.classList.add("death")})}handleMusic(t){this.audio.playMusic(t)}handleNPC(t,e){let n,r;switch(t){case fr.Talk:{if(n=this.entities.get(e.instance),!n)return;if(r=e.text?"npc":"npc-end",this.audio.playSound(r,n),this.game.player.disableAction=!0,!e.text)return this.bubble.clear(n.instance);this.bubble.create(n.instance,e.text),this.bubble.setTo(n.instance,n.x,n.y);break}case fr.Bank:return this.menu.getBank().show(e.slots);case fr.Enchant:{this.menu.getEnchant().show();break}}}handleRespawn(t){this.game.player.setGridPosition(t.x,t.y),this.camera.centreOn(this.game.player),this.game.player.animation=null,this.game.player.setSprite(this.game.sprites.get(this.game.player.getSpriteName())),this.game.player.idle(),this.entities.addEntity(this.game.player),this.game.player.dead=!1,this.game.player.teleporting=!1}handleTrade(t,e){switch(t){case mt.Open:{let n=this.entities.get(e.instance);return n?this.menu.getTrade().show(this.game.player,n):void 0}case mt.Close:return this.menu.getTrade().hide(!0);case mt.Add:return this.menu.getTrade().add(e.index,e.count,e.key,e.instance!==this.game.player.instance);case mt.Remove:return this.menu.getTrade().remove(e.index,e.instance!==this.game.player.instance);case mt.Accept:return this.menu.getTrade().accept(e.message)}}handleEnchant(t,e){switch(t){case br.Select:return this.menu.getEnchant().move(e.index,e.isShard)}}handleGuild(t,e){switch(t){case Be.Login:{this.game.player.setGuild(e);break}case Be.Leave:{this.game.player.setGuild();break}}this.menu.getGuilds().handle(t,e)}handlePointer(t,e){let n;switch(t){case Je.Entity:{if(n=this.entities.get(e.instance),!n)return;this.pointer.create(n.instance,t),this.pointer.setToEntity(n);break}case Je.Location:{this.pointer.create(e.instance,t),this.pointer.setToPosition(e.instance,e.x*this.map.tileSize,e.y*this.map.tileSize);break}case Je.Relative:{this.pointer.create(e.instance,t),this.pointer.setRelative(e.instance,e.x,e.y);break}case Je.Remove:{this.pointer.clean();break}case Je.Button:{this.pointer.create(e.instance,t,e.button);break}}}handlePVP(t){this.game.pvp=t.state}handlePoison(t){this.game.player.setPoison(t!==-1)}handleStore(t,e){switch(t){case wi.Open:return this.menu.getStore().show(e);case wi.Update:return this.menu.getStore().update(e);case wi.Select:return this.menu.getStore().move(e)}}handleOverlay(t,e){switch(t){case cr.Set:{this.overlays.update(e.image),this.renderer.updateDarkMask(e.colour);break}case cr.Remove:{this.renderer.removeAllLights(),this.overlays.update();break}case cr.Lamp:return this.renderer.addLight(e.light)}}handleCamera(t){}handleBubble(t,e){if(!e.text)return this.bubble.clear(e.instance);let n=this.entities.get(e.instance);if(t===Yl.Entity&&!n)return;let r=n?void 0:{x:e.x*this.map.tileSize,y:e.y*this.map.tileSize};this.bubble.create(e.instance,e.text,e.duration,r),this.bubble.setTo(e.instance,r?r.x:n.x,r?r.y:n.y)}handleSkill(t,e){switch(t){case Ps.Batch:{this.game.player.loadSkills(e.skills);break}case Ps.Update:{this.game.player.setSkill(e);break}}this.game.menu.synchronize("profile")}handleUpdate(t){this.entities.cleanDisplayInfo();for(let e of t){let n=this.entities.get(e.instance);n&&(e.colour&&(n.nameColour=e.colour),e.scale&&(n.customScale=e.scale))}}handleMinigame(t,e){let{minigame:n,player:r}=this.game;switch(n.type=t,n.started=!!e.started,e.countdown&&(n.countdown=e.countdown),e.action){case cn.Score:return!isNaN(e.redTeamKills)&&!isNaN(e.blueTeamKills)&&n.setScore(e.redTeamKills,e.blueTeamKills),n.setStatus("ingame");case cn.End:case cn.Lobby:return r.nameColour="",n.setStatus("lobby");case cn.Exit:return n.reset()}}handleEffect(t,e){let n=e.instance===this.game.player.instance?this.game.player:this.entities.get(e.instance);if(n)switch(t){case Os.Add:return n.addEffect(e.effect);case Os.Remove:return n.removeEffect(e.effect)}}handleFriends(t,e){switch(t){case wt.List:{this.game.player.loadFriends(e.list);break}case wt.Add:{this.game.player.addFriend(e.username,e.status,e.serverId);break}case wt.Status:{this.game.player.setFriendStatus(e.username,e.status,e.serverId);break}}this.menu.getFriends().handle(t,e.username,e.status,e.serverId)}handleCrafting(t,e){this.menu.getCrafting().handle(t,e)}handleRank(t){this.game.player.setRank(t)}canRequestEntityList(){return Date.now()-this.lastEntityListRequest>5e3}}class $g{constructor(t){l(this,"messages",[]);l(this,"handshakeCallback");l(this,"welcomeCallback");l(this,"mapCallback");l(this,"spawnCallback");l(this,"equipmentCallback");l(this,"entityListCallback");l(this,"syncCallback");l(this,"movementCallback");l(this,"teleportCallback");l(this,"despawnCallback");l(this,"combatCallback");l(this,"animationCallback");l(this,"pointsCallback");l(this,"networkCallback");l(this,"chatCallback");l(this,"commandCallback");l(this,"containerCallback");l(this,"abilityCallback");l(this,"questCallback");l(this,"achievementCallback");l(this,"notificationCallback");l(this,"blinkCallback");l(this,"healCallback");l(this,"experienceCallback");l(this,"deathCallback");l(this,"musicCallback");l(this,"npcCallback");l(this,"respawnCallback");l(this,"tradeCallback");l(this,"enchantCallback");l(this,"guildCallback");l(this,"pointerCallback");l(this,"pvpCallback");l(this,"poisonCallback");l(this,"storeCallback");l(this,"overlayCallback");l(this,"cameraCallback");l(this,"bubbleCallback");l(this,"skillCallback");l(this,"updateCallback");l(this,"minigameCallback");l(this,"effectCallback");l(this,"friendsCallback");l(this,"rankCallback");l(this,"craftingCallback");this.app=t,this.messages[B.Handshake]=()=>this.handshakeCallback,this.messages[B.Welcome]=()=>this.welcomeCallback,this.messages[B.Spawn]=()=>this.spawnCallback,this.messages[B.Equipment]=()=>this.equipmentCallback,this.messages[B.List]=()=>this.entityListCallback,this.messages[B.Sync]=()=>this.syncCallback,this.messages[B.Movement]=()=>this.movementCallback,this.messages[B.Teleport]=()=>this.teleportCallback,this.messages[B.Despawn]=()=>this.despawnCallback,this.messages[B.Combat]=()=>this.combatCallback,this.messages[B.Animation]=()=>this.animationCallback,this.messages[B.Points]=()=>this.pointsCallback,this.messages[B.Network]=()=>this.networkCallback,this.messages[B.Chat]=()=>this.chatCallback,this.messages[B.Command]=()=>this.commandCallback,this.messages[B.Container]=()=>this.containerCallback,this.messages[B.Ability]=()=>this.abilityCallback,this.messages[B.Quest]=()=>this.questCallback,this.messages[B.Achievement]=()=>this.achievementCallback,this.messages[B.Notification]=()=>this.notificationCallback,this.messages[B.Blink]=()=>this.blinkCallback,this.messages[B.Heal]=()=>this.healCallback,this.messages[B.Experience]=()=>this.experienceCallback,this.messages[B.Death]=()=>this.deathCallback,this.messages[B.Music]=()=>this.musicCallback,this.messages[B.NPC]=()=>this.npcCallback,this.messages[B.Respawn]=()=>this.respawnCallback,this.messages[B.Trade]=()=>this.tradeCallback,this.messages[B.Enchant]=()=>this.enchantCallback,this.messages[B.Guild]=()=>this.guildCallback,this.messages[B.Pointer]=()=>this.pointerCallback,this.messages[B.PVP]=()=>this.pvpCallback,this.messages[B.Poison]=()=>this.poisonCallback,this.messages[B.Store]=()=>this.storeCallback,this.messages[B.Map]=()=>this.mapCallback,this.messages[B.Overlay]=()=>this.overlayCallback,this.messages[B.Camera]=()=>this.cameraCallback,this.messages[B.Bubble]=()=>this.bubbleCallback,this.messages[B.Skill]=()=>this.skillCallback,this.messages[B.Update]=()=>this.updateCallback,this.messages[B.Minigame]=()=>this.minigameCallback,this.messages[B.Effect]=()=>this.effectCallback,this.messages[B.Friends]=()=>this.friendsCallback,this.messages[B.Rank]=()=>this.rankCallback,this.messages[B.Crafting]=()=>this.craftingCallback}handleData(t){let e=t.shift(),n=this.messages[e]();n&&typeof n=="function"&&n.call(this,...t)}handleBulkData(t){for(let e of t)this.handleData(e)}handleUTF8(t){switch(this.app.toggleLogin(!1),t){case"worldfull":{this.app.sendError("The servers are currently full!");break}case"error":{this.app.sendError("The server has responded with an error!");break}case"development":{this.app.sendError("The game is currently in development mode.");break}case"disallowed":{this.app.sendError("The server is currently not accepting connections!");break}case"maintenance":{this.app.sendError("Kaetram is currently under maintenance.");break}case"userexists":{this.app.sendError("The username you have entered already exists.");break}case"emailexists":{this.app.sendError("The email you have entered is not available.");break}case"invalidinput":{this.app.sendError("The input you have entered is invalid. Please do not use special characters.");break}case"loggedin":{this.app.sendError("The player is already logged in!");break}case"invalidlogin":{this.app.sendError("You have entered the wrong username or password.");break}case"toofast":{this.app.sendError("You are trying to log in too fast from the same connection.");break}case"timeout":{this.app.sendError("You have been disconnected for being inactive for too long.");break}case"updated":{this.app.sendError("The game has been updated. Please clear your browser cache.");break}case"cheating":{this.app.sendError("An error in client-server syncing has occurred.");break}case"lost":{this.app.sendError("The connection to the server has been lost.");break}case"toomany":{this.app.sendError("Too many devices from your IP address are connected.");break}case"ratelimit":{this.app.sendError("You are sending packets too fast.");break}default:{this.app.sendError("An unknown error has occurred, please submit a bug report.");break}}}onHandshake(t){this.handshakeCallback=t}onWelcome(t){this.welcomeCallback=t}onSpawn(t){this.spawnCallback=t}onEquipment(t){this.equipmentCallback=t}onEntityList(t){this.entityListCallback=t}onSync(t){this.syncCallback=t}onMovement(t){this.movementCallback=t}onTeleport(t){this.teleportCallback=t}onDespawn(t){this.despawnCallback=t}onCombat(t){this.combatCallback=t}onAnimation(t){this.animationCallback=t}onPoints(t){this.pointsCallback=t}onNetwork(t){this.networkCallback=t}onChat(t){this.chatCallback=t}onCommand(t){this.commandCallback=t}onContainer(t){this.containerCallback=t}onAbility(t){this.abilityCallback=t}onQuest(t){this.questCallback=t}onAchievement(t){this.achievementCallback=t}onNotification(t){this.notificationCallback=t}onBlink(t){this.blinkCallback=t}onHeal(t){this.healCallback=t}onExperience(t){this.experienceCallback=t}onDeath(t){this.deathCallback=t}onMusic(t){this.musicCallback=t}onNPC(t){this.npcCallback=t}onRespawn(t){this.respawnCallback=t}onTrade(t){this.tradeCallback=t}onEnchant(t){this.enchantCallback=t}onGuild(t){this.guildCallback=t}onPointer(t){this.pointerCallback=t}onPVP(t){this.pvpCallback=t}onPoison(t){this.poisonCallback=t}onStore(t){this.storeCallback=t}onMap(t){this.mapCallback=t}onOverlay(t){this.overlayCallback=t}onCamera(t){this.cameraCallback=t}onBubble(t){this.bubbleCallback=t}onSkill(t){this.skillCallback=t}onUpdate(t){this.updateCallback=t}onMinigame(t){this.minigameCallback=t}onEffect(t){this.effectCallback=t}onFriends(t){this.friendsCallback=t}onRank(t){this.rankCallback=t}onCrafting(t){this.craftingCallback=t}}class jg{constructor(t){l(this,"messages");l(this,"config");l(this,"connection");l(this,"listening",!1);this.game=t,this.config=t.app.config,this.messages=new $g(t.app)}async getServer(){if(this.config.hub)try{return await(await fetch(`${this.config.hub}/server`)).json()}catch(t){return}}async connect(t){let{host:e,port:n}=t||await this.getServer()||this.config,r=this.config.ssl?`wss://${e}`:`ws://${e}:${n}`;this.connection=new WebSocket(r),this.connection.addEventListener("open",this.handleConnection.bind(this)),this.connection.addEventListener("message",a=>this.receive(a.data)),this.connection.addEventListener("error",()=>this.handleConnectionError(e,n)),this.connection.addEventListener("close",()=>this.game.handleDisconnection()),this.game.audio.createContext()}receive(t){if(this.listening)if(t.startsWith("[")){let e=JSON.parse(t);e.length>1?this.messages.handleBulkData(e):this.messages.handleData(e.shift())}else this.messages.handleUTF8(t)}send(t,e){var n;((n=this.connection)==null?void 0:n.readyState)===WebSocket.OPEN&&this.connection.send(JSON.stringify([t,e]))}handleConnection(){this.listening=!0,de.info("Connection established..."),this.game.app.updateLoader("Preparing handshake"),this.send(B.Handshake,{gVer:this.config.version})}handleConnectionError(t,e){de.info(`Failed to connect to: ${t}`),this.listening=!1,this.game.app.toggleLogin(!1),this.game.app.sendError("Could not connect to the game server.")}}const rl=6,sl=3,al=52,ol=28;let xs=2.6;class Gg{constructor(t,e,n){l(this,"border",_t("#border"));l(this,"x",0);l(this,"y",0);l(this,"gridX",0);l(this,"gridY",0);l(this,"gridWidth",0);l(this,"gridHeight",0);l(this,"borderX",0);l(this,"borderY",0);l(this,"zoomFactor",3);l(this,"centered",!0);l(this,"lockX",!1);l(this,"lockY",!1);this.width=t,this.height=e,this.tileSize=n,this.update()}update(){let t=this.border.width(),e=this.border.height();this.gridWidth=Math.ceil(t/this.tileSize/this.zoomFactor),this.gridHeight=Math.ceil(e/this.tileSize/this.zoomFactor),this.clamp(),this.borderX=(this.width-this.gridWidth)*this.tileSize,this.borderY=(this.height-this.gridHeight)*this.tileSize}clamp(){this.gridWidth>al&&(this.gridWidth=al),this.gridHeight>ol&&(this.gridHeight=ol)}setGridPosition(t,e){this.gridX=t,this.gridY=e,this.x=t*this.tileSize,this.y=e*this.tileSize}setZoom(t=sl){this.zoomFactor=t,isNaN(this.zoomFactor)&&(this.zoomFactor=sl),this.zoomFactor>rl&&(this.zoomFactor=rl),this.zoomFactor<xs&&(this.zoomFactor=xs)}clip(){this.setGridPosition(Math.round(this.x/this.tileSize),Math.round(this.y/this.tileSize))}center(){this.centered=!0}decenter(){this.centered=!1,this.clip()}centreOn(t){let e=Math.floor(this.gridWidth/2),n=Math.floor(this.gridHeight/2),r=t.x-e*this.tileSize,a=t.y-n*this.tileSize;r>=0&&r<=this.borderX&&!this.lockX?(this.x=r,this.gridX=Math.round(t.x/this.tileSize)-e):this.offsetX(r),a>=0&&a<=this.borderY&&!this.lockY?(this.y=a,this.gridY=Math.round(t.y/this.tileSize)-n):this.offsetY(a)}offsetX(t){t<=this.tileSize?(this.x=0,this.gridX=0):t>=this.borderX&&(this.x=this.borderX,this.gridX=Math.round(this.borderX/this.tileSize))}offsetY(t){t<=this.tileSize?(this.y=0,this.gridY=0):t>=this.borderY&&(this.y=this.borderY,this.gridY=Math.round(this.borderY/this.tileSize))}zone(t){switch(t){case re.Up:{this.setGridPosition(this.gridX,this.gridY-this.gridHeight+3);break}case re.Down:{this.setGridPosition(this.gridX,this.gridY+this.gridHeight-3);break}case re.Right:{this.setGridPosition(this.gridX+this.gridWidth-3,this.gridY);break}case re.Left:{this.setGridPosition(this.gridX-this.gridWidth+3,this.gridY);break}}this.zoneClip()}zoneClip(){this.gridX<0&&this.setGridPosition(0,this.gridY),this.gridX>this.width&&this.setGridPosition(this.width,this.gridY),this.gridY<0&&this.setGridPosition(this.gridX,0),this.gridY>this.height&&this.setGridPosition(this.gridX,this.height)}zoom(t=0){let e=parseFloat((this.zoomFactor+t).toFixed(1));this.setZoom(e)}updateMinimumZoom(t=!1){xs=t?2:2.6,this.zoom()}isCentered(){return this.centered}isVisible(t,e,n,r){return t>this.gridX-n&&t<this.gridX+this.gridWidth&&e>this.gridY-n&&e<this.gridY+this.gridHeight+r}forEachVisiblePosition(t,e=1){for(let n=this.gridY-e,r=n+this.gridHeight+e*2;n<r;n++)for(let a=this.gridX-e,d=a+this.gridWidth+e*2;a<d;a++)t(a,n)}}class Wg{constructor(t=-1,e="exit",n=180){l(this,"redTeamScore",0);l(this,"blueTeamScore",0);l(this,"started",!1);this.type=t,this.status=e,this.countdown=n}reset(){this.type=-1,this.status="exit",this.started=!1}setStatus(t){this.status=t}setScore(t,e){this.redTeamScore=t,this.blueTeamScore=e}exists(){return this.type>-1}}class Vg{constructor(){l(this,"currentOverlay","");l(this,"overlays",{fog:this.load("fog")})}load(t){let e=new Image,n=`/img/overlays/${t}.png`;return e.crossOrigin="Anonymous",e.src=n,e.addEventListener("load",()=>de.debug(`Loaded ${t}`)),e}hasOverlay(){return this.currentOverlay!==""}get(){return this.overlays[this.currentOverlay]}update(t=""){this.currentOverlay=t}}class ll{constructor(t,e,n,r={}){l(this,"id","");l(this,"program");l(this,"attributes",{});l(this,"uniforms",{});this.id=t.canvas.id,this.program=this.compile(t,e,n,r);let a=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES);for(let d=0;d<a;d++){let u=t.getActiveAttrib(this.program,d);u&&(this.attributes[u.name]=t.getAttribLocation(this.program,u.name))}a=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS);for(let d=0;d<a;d++){let u=t.getActiveUniform(this.program,d);if(!u)continue;let y=u.name.replace("[0]",""),m=t.getUniformLocation(this.program,y);m&&(this.uniforms[y]=m)}}compile(t,e,n,r={}){let a=this.compileShader(t,t.VERTEX_SHADER,e),d=this.compileShader(t,t.FRAGMENT_SHADER,n),u=t.createProgram();if(!u){de.error("Could not create WebGL program.");return}t.attachShader(u,a),t.attachShader(u,d);for(let y in r)t.bindAttribLocation(u,r[y],y);if(t.linkProgram(u),!t.getProgramParameter(u,t.LINK_STATUS)){de.error(`Could not link the WebGL program: ${t.getProgramInfoLog(u)}`),t.deleteProgram(u),t.deleteShader(a),t.deleteShader(d);return}return t.deleteShader(a),t.deleteShader(d),u}compileShader(t,e,n){let r=t.createShader(e);if(!r){de.error(`Failed to create shader of type ${e}`);return}if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){de.error(`Failed to compile shader: ${t.getShaderInfoLog(r)}`);return}return r}}class Zg{constructor(t,e){l(this,"textures",[]);this.map=t,this.context=e;for(let n of this.map.tilesets)this.createTexture(n)}createTexture(t){let e=this.context.createTexture();if(!e||!t)return de.error(`Failed to create texture for tileset: ${t.src}`);this.context.bindTexture(this.context.TEXTURE_2D,e),this.context.texImage2D(this.context.TEXTURE_2D,0,this.context.RGBA,this.context.RGBA,this.context.UNSIGNED_BYTE,t),this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_MAG_FILTER,this.context.NEAREST),this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_MIN_FILTER,this.context.NEAREST),this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_WRAP_S,this.context.CLAMP_TO_EDGE),this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_WRAP_T,this.context.CLAMP_TO_EDGE),this.textures.push(e),de.debug(`Created texture for tileset: ${t.src}`)}forEachTexture(t){for(let e=0;e<this.textures.length;e++)t(this.textures[e],e)}}class Kg{constructor(t){l(this,"backgroundData");l(this,"foregroundData");l(this,"backgroundTexture");l(this,"foregroundTexture");this.map=t,this.backgroundData=new Uint8Array(this.map.width*this.map.height*4),this.foregroundData=new Uint8Array(this.map.width*this.map.height*4),this.backgroundData.fill(255),this.foregroundData.fill(255)}bindTexture(t,e,n=!1){!this.backgroundTexture&&!n&&(this.backgroundTexture=t.createTexture()),!this.foregroundTexture&&n&&(this.foregroundTexture=t.createTexture()),t.bindTexture(t.TEXTURE_2D,n?this.foregroundTexture:this.backgroundTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.useProgram(e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.map.width,this.map.height,0,t.RGBA,t.UNSIGNED_BYTE,n?this.foregroundData:this.backgroundData)}clear(t){t*=4,this.backgroundData[t]=this.backgroundData[t+1]=this.backgroundData[t+2]=this.backgroundData[t+3]=255,this.foregroundData[t]=this.foregroundData[t+1]=this.foregroundData[t+2]=this.foregroundData[t+3]=255}addTile(t,e,n=!1){let r=n?e.tileId:e,a=this.map.isHighTile(r)?this.foregroundData:this.backgroundData,d=t*4;if(!r){a[d]=a[d+1]=a[d+2]=a[d+3]=255;return}let u=this.map.getTilesetFromId(r);if(!u)return;let y=r-u.firstGid-1,m=u.width/this.map.tileSize;a[d]=y%m,a[d+1]=Math.floor(y/m),a[d+2]=u.index,a[d+3]=n?this.getFlippedFlag(e):0}getFlippedFlag(t){return(t.h?-8:0)|(t.v?4:0)|(t.d?2:0)}}class Qg{constructor(t,e,n,r=!1){l(this,"animationIndex",0);l(this,"lastTime",0);this.id=t,this.index=e,this.animationInfo=n,this.isFlipped=r}animate(t){t-this.lastTime>this.animationInfo[this.animationIndex].duration&&(this.id=this.animationInfo[this.animationIndex].tileId,this.lastTime=t,this.animationIndex>=Object.keys(this.animationInfo).length-1?this.animationIndex=0:this.animationIndex++)}}class Oe{constructor(t=0,e=0){this.x=t,this.y=e}copy(){return new Oe(this.x,this.y)}dot(t){return t.x*this.x+t.y*this.y}sub(t){return new Oe(this.x-t.x,this.y-t.y)}add(t){return new Oe(this.x+t.x,this.y+t.y)}mul(t){return new Oe(this.x*t,this.y*t)}inv(){return this.mul(-1)}dist2(t){return(this.x-t.x)**2+(this.y-t.y)**2}normalize(){var t=Math.sqrt(this.length2());return new Oe(this.x/t||0,this.y/t||0)}length2(){return this.x**2+this.y**2}toString(){return`${this.x},${this.y}`}inBound(t,e){return t.x<this.x&&this.x<e.x&&t.y<this.y&&this.y<e.y}}function Dn(i,t,e){var n=`illuminated-${i}`,r=document.querySelector(`#${n}`);r||((r=document.createElement("canvas")).id=n,r.width=t,r.height=e,r.style.display="none",document.body.append(r));var a=r.getContext("2d");return a.clearRect(0,0,r.width,r.height),r.width=t,r.height=e,{canvas:r,ctx:a,w:t,h:e}}var Jg=(()=>{var i=document.createElement("canvas");i.width=1,i.height=1;var t=i.getContext("2d");return(e,n=1)=>{t.clearRect(0,0,1,1),t.fillStyle=e,t.fillRect(0,0,1,1);var[r,a,d]=t.getImageData(0,0,1,1).data;return`rgba(${[r,a,d,n]})`}})();(()=>{var i=document.createElement("canvas");i.width=1,i.height=1;var t=i.getContext("2d");function e(n){var r=n.toString(16);return r.length===1&&(r=`0${r}`),r}return n=>{t.clearRect(0,0,1,1),t.fillStyle=n,t.fillRect(0,0,1,1);var[r,a,d,u]=t.getImageData(0,0,1,1).data;return{color:`#${e(r)}${e(a)}${e(d)}`,alpha:Math.round(1e3*u/255)/1e3}}})();var Mt,bh=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)},Pi=(i,t,e)=>(bh(i,t,"read from private field"),e?e.call(i):t.get(i));class ep{constructor(t={}){((r,a,d)=>{if(a.has(r))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(r):a.set(r,d)})(this,Mt,void 0);var{lights:e,color:n}=t;this.lights=e!=null?e:[],this.color=n!=null?n:"rgba(0,0,0,0.9)"}compute(t,e){var n,r,a;Pi(this,Mt)&&Pi(this,Mt).w===t&&Pi(this,Mt).h===e||(n=this,r=Mt,a=Dn("dm",t,e),bh(n,r,"write to private field"),r.set(n,a));var{ctx:d}=Pi(this,Mt);for(var u of(d.save(),d.clearRect(0,0,t,e),d.fillStyle=this.color,d.fillRect(0,0,t,e),d.globalCompositeOperation="destination-out",this.lights))u.mask(d);d.restore()}render(t){t.drawImage(Pi(this,Mt).canvas,0,0)}getCanvas(){return Pi(this,Mt).canvas}}Mt=new WeakMap;var tp=Math.PI*(3-Math.sqrt(5)),gr,mn,yh=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)},Es=(i,t,e)=>(yh(i,t,"read from private field"),e?e.call(i):t.get(i)),hl=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},dl=(i,t,e,n)=>(yh(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e);class kh{constructor(t={}){hl(this,gr,void 0),hl(this,mn,void 0);var{position:e,distance:n,diffuse:r}=t;this.position=e!=null?e:new Oe,this.distance=n!=null?n:100,this.diffuse=r!=null?r:.8}render(t){}mask(t){var e=this.getVisibleMaskCache(),{x:n,y:r}=this.position;t.drawImage(e.canvas,Math.round(n-e.w/2),Math.round(r-e.h/2))}bounds(){var{position:t,distance:e}=this,{x:n,y:r}=t;return{topLeft:new Oe(n-e,r-e),bottomRight:new Oe(n+e,r+e)}}center(){var{distance:t}=this;return new Oe(t,t)}forEachSample(t){t(this.position)}getVisibleMaskCache(){var t=Math.floor(1.4*this.distance),e=`${t}`;if(Es(this,gr)!==e){dl(this,gr,e),dl(this,mn,Dn(`vm${this.id}`,2*t,2*t));var{ctx:n,w:r,h:a}=Es(this,mn),d=n.createRadialGradient(t,t,0,t,t,t);d.addColorStop(0,"rgba(0,0,0,1)"),d.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=d,n.fillRect(0,0,r,a)}return Es(this,mn)}getHashCache(){return[this.distance,this.diffuse].toString()}}gr=new WeakMap,mn=new WeakMap;var Ks,pr,mr,vh=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)},Ts=(i,t,e)=>(vh(i,t,"read from private field"),e?e.call(i):t.get(i)),Cs=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},Is=(i,t,e,n)=>(vh(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e);class ip extends kh{constructor(t={}){super(t),Cs(this,Ks,0),Cs(this,pr,void 0),Cs(this,mr,void 0);var e,n,r,a,{id:d,color:u,radius:y,samples:m,angle:b,roughness:E}=t;this.id=d!=null?d:0,this.color=u!=null?u:"rgba(250,220,150,0.8)",this.radius=y!=null?y:0,this.samples=m!=null?m:1,this.angle=b!=null?b:0,this.roughness=E!=null?E:0,this.id===0&&(this.id=++(e=this,n=Ks,{set _(Y){Is(e,n,Y,r)},get _(){return Ts(e,n,a)}})._)}getHashCache(){return[this.color,this.distance,this.diffuse,this.angle,this.roughness,this.samples,this.radius].toString()}center(){var{angle:t,roughness:e,distance:n}=this;return new Oe((1-Math.cos(t)*e)*n,(1+Math.sin(t)*e)*n)}bounds(){var{angle:t,roughness:e,distance:n,position:r}=this,{x:a,y:d}=new Oe(Math.cos(t),-Math.sin(t)).mul(e*n);return{topLeft:new Oe(r.x+a-n,r.y+d-n),bottomRight:new Oe(r.x+a+n,r.y+d+n)}}mask(t){var{angle:e,roughness:n,distance:r,position:a}=this,{canvas:d,w:u,h:y}=this.getVisibleMaskCache(),{x:m,y:b}=new Oe(Math.cos(e),-Math.sin(e)).mul(n*r);t.drawImage(d,Math.round(a.x+m-u/2),Math.round(a.y+b-y/2))}getGradientCache(t){var e=this.getHashCache();if(Ts(this,pr)===e)return Ts(this,mr);Is(this,pr,e);var{distance:n,id:r,radius:a,color:d}=this,u=Math.round(n),y=2*u,m=Dn(`gc${r}`,y,y),{ctx:b,w:E,h:Y}=m,I=b.createRadialGradient(t.x,t.y,0,u,u,u);return I.addColorStop(Math.min(1,a/n),d),I.addColorStop(1,Jg(d,0)),b.fillStyle=I,b.fillRect(0,0,E,Y),Is(this,mr,m),m}render(t){var{x:e,y:n}=this.position,r=this.center(),{canvas:a}=this.getGradientCache(r);t.drawImage(a,Math.round(e-r.x),Math.round(n-r.y))}forEachSample(t){for(var{samples:e,radius:n,position:r}=this,a=0,d=e;a<d;++a){var u=a*tp,y=Math.sqrt(a/e)*n,m=new Oe(Math.cos(u)*y,Math.sin(u)*y);t(r.add(m))}}}Ks=new WeakMap,pr=new WeakMap,mr=new WeakMap;var Pt,wr,Sh=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)},hi=(i,t,e)=>(Sh(i,t,"read from private field"),e?e.call(i):t.get(i)),fl=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},cl=(i,t,e,n)=>(Sh(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e);class np{constructor(t={}){fl(this,Pt,void 0),fl(this,wr,void 0);var{light:e,objects:n}=t;this.light=e!=null?e:new kh,this.objects=n!=null?n:[]}createCache(t,e){cl(this,Pt,Dn("lc",t,e)),cl(this,wr,Dn("lcc",t,e))}compute(t,e){hi(this,Pt)&&hi(this,Pt).w===t&&hi(this,Pt).h===e||this.createCache(t,e);var{ctx:n}=hi(this,Pt);n.save(),n.clearRect(0,0,n.canvas.width,n.canvas.height),this.light.render(n),n.globalCompositeOperation="destination-out",this.cast(n),n.restore()}cast(t){var{ctx:e,w:n,h:r,canvas:a}=hi(this,wr),{light:d}=this,u=d.samples;e.clearRect(0,0,n,r),e.fillStyle=`rgba(0,0,0,${Math.round(100/u)/100})`;var y=d.bounds(),{topLeft:m,bottomRight:b}=y,{objects:E}=this;for(var Y of(d.forEachSample(A=>{for(var O=0,J=E.length;O<J;++O)if(E[O].contains(A))return void e.fillRect(m.x,m.y,b.x-m.x,b.y-m.y);for(var F of E)F.cast(e,A,y)}),E)){var{diffuse:I}=Y;I*=d.diffuse,e.fillStyle=`rgba(0,0,0,${1-I})`,e.beginPath(),Y.path(e),e.fill()}t.drawImage(a,0,0)}render(t){t.drawImage(hi(this,Pt).canvas,0,0)}getCanvas(){return hi(this,Pt).canvas}}Pt=new WeakMap,wr=new WeakMap;class xh{constructor(t){l(this,"background",document.querySelector("#background"));l(this,"foreground",document.querySelector("#foreground"));l(this,"overlay",document.querySelector("#overlay"));l(this,"textCanvas",document.querySelector("#text-canvas"));l(this,"entities",document.querySelector("#entities"));l(this,"cursor",document.querySelector("#cursor"));l(this,"canvases",[this.background,this.foreground,this.overlay,this.textCanvas,this.entities,this.cursor]);l(this,"entitiesContext",this.entities.getContext("2d"));l(this,"overlayContext",this.overlay.getContext("2d"));l(this,"textContext",this.textCanvas.getContext("2d"));l(this,"cursorContext",this.cursor.getContext("2d"));l(this,"allContexts",[this.entitiesContext,this.overlayContext,this.textContext,this.cursorContext]);l(this,"contexts",[this.entitiesContext,this.textContext,this.overlayContext]);l(this,"zoomIn",document.querySelector("#zoom-in"));l(this,"zoomOut",document.querySelector("#zoom-out"));l(this,"map");l(this,"camera");l(this,"tileSize",q.tileSize);l(this,"actualTileSize",q.tileSize);l(this,"screenWidth",0);l(this,"screenHeight",0);l(this,"canvasWidth",0);l(this,"canvasHeight",0);l(this,"animateTiles",!0);l(this,"animatedTiles",{});l(this,"lightings",[]);l(this,"darkMask",new ep({lights:[],color:"rgba(0, 0, 0, 0.84)"}));l(this,"debugging",!1);l(this,"stopRendering",!1);l(this,"forceRendering",!1);l(this,"drawNames",!0);l(this,"drawLevels",!0);l(this,"fontSize",10);l(this,"mobile",yi());l(this,"tablet",Jd());l(this,"time",Date.now());l(this,"fps",0);l(this,"frameCount",0);l(this,"shadowSprite");l(this,"sparksSprite");l(this,"silverMedal");l(this,"goldMedal");l(this,"crownArtist");l(this,"crownTier1");l(this,"crownTier2");l(this,"crownTier3");l(this,"crownTier4");l(this,"crownTier5");l(this,"crownTier6");l(this,"crownTier7");this.game=t,this.map=t.map,this.camera=t.camera,this.tileSize=t.map.tileSize,this.actualTileSize=this.tileSize*this.camera.zoomFactor,this.loadSizes(),this.loadStaticSprites(),this.zoomIn.addEventListener("click",()=>this.game.zoom(.2)),this.zoomOut.addEventListener("click",()=>this.game.zoom(-.2))}load(){}loadSizes(){this.actualTileSize=this.tileSize*this.camera.zoomFactor,this.screenWidth=this.camera.gridWidth*this.tileSize,this.screenHeight=this.camera.gridHeight*this.tileSize,this.canvasWidth=this.screenWidth*this.camera.zoomFactor,this.canvasHeight=this.screenHeight*this.camera.zoomFactor,this.darkMask.compute(this.canvasWidth,this.canvasHeight),this.forEachCanvas(t=>{t.width=this.canvasWidth,t.height=this.canvasHeight})}loadStaticSprites(){this.shadowSprite=this.game.sprites.get("shadow16"),this.shadowSprite.loaded||this.shadowSprite.load(),this.sparksSprite=this.game.sprites.get("sparks"),this.sparksSprite.loaded||this.sparksSprite.load(),this.silverMedal=this.game.sprites.get("silvermedal"),this.silverMedal.loaded||this.silverMedal.load(),this.goldMedal=this.game.sprites.get("goldmedal"),this.goldMedal.loaded||this.goldMedal.load(),this.crownArtist=this.game.sprites.get("crown-artist"),this.crownArtist.loaded||this.crownArtist.load(),this.crownTier1=this.game.sprites.get("crown-tier1"),this.crownTier1.loaded||this.crownTier1.load(),this.crownTier2=this.game.sprites.get("crown-tier2"),this.crownTier2.loaded||this.crownTier2.load(),this.crownTier3=this.game.sprites.get("crown-tier3"),this.crownTier3.loaded||this.crownTier3.load(),this.crownTier4=this.game.sprites.get("crown-tier4"),this.crownTier4.loaded||this.crownTier4.load(),this.crownTier5=this.game.sprites.get("crown-tier5"),this.crownTier5.loaded||this.crownTier5.load(),this.crownTier6=this.game.sprites.get("crown-tier6"),this.crownTier6.loaded||this.crownTier6.load(),this.crownTier7=this.game.sprites.get("crown-tier7"),this.crownTier7.loaded||this.crownTier7.load()}resize(){this.mobile=yi(),this.camera.update(),this.camera.updateMinimumZoom(this.mobile),this.loadSizes(),this.updateAnimatedTiles(),this.camera.centreOn(this.game.player),this.forceRendering=!0,this.clearScreen(this.cursorContext)}render(){this.clear(),this.save(),this.removeSmoothing(),this.drawDebugging(),this.drawOverlays(),this.drawHoveringCell(),this.drawSelectedCell(),this.drawEntities(),this.drawInfos(),this.drawCursor(),this.drawMinigameGUI(),this.restore()}drawDebugging(){this.debugging&&(this.drawFPS(),this.drawPathing(),!this.mobile&&(this.drawPosition(),this.drawCollisions()))}drawOverlays(){if(!this.game.overlays.hasOverlay())return;let t=this.game.overlays.get();t&&this.overlayContext.drawImage(t,0,0,this.canvasWidth,this.canvasHeight),this.overlayContext.globalCompositeOperation="lighter",this.forEachLighting(e=>{this.inRadius(e)&&this.drawLighting(e)}),this.overlayContext.globalCompositeOperation="source-over",this.darkMask.render(this.overlayContext)}drawHoveringCell(){if(this.mobile)return;let{input:t}=this.game,e=t.getCoords();if(this.isSelectedCell(e.gridX,e.gridY))return;let n=this.map.isColliding(e.gridX,e.gridY);this.drawCellHighlight(e.gridX,e.gridY,n?"rgba(230, 0, 0, 0.7)":t.targetColour)}drawSelectedCell(){if(!this.game.input.selectedCellVisible||this.game.input.keyMovement)return;let t=this.game.input.getTargetData();t&&(this.entitiesContext.save(),this.setCameraView(this.entitiesContext),this.entitiesContext.drawImage(t.sprite.image,t.x,t.y,t.width,t.height,t.dx,t.dy,t.dw,t.dh),this.entitiesContext.restore())}drawEntities(){this.game.player.dead||(this.setCameraView(this.entitiesContext),this.forEachVisibleEntity(t=>{var e;!((e=t.sprite)!=null&&e.loaded)||!t.animation||!t.isVisible()||this.drawEntity(t)}))}drawInfos(){this.game.info.isEmpty()||this.game.info.forEachInfo(t=>{this.textContext.save(),this.setCameraView(this.textContext),this.textContext.globalAlpha=t.opacity,this.drawText(`${t.getText()}`,Math.floor(t.x+8),Math.floor(t.y),!0,t.fill,t.stroke,26),this.textContext.restore()})}drawCursor(){if(this.tablet||this.mobile||this.game.input.isMouseRendered())return;let{cursor:t,mouse:e}=this.game.input;!t||!e||(this.clearScreen(this.cursorContext),this.cursorContext.save(),t.loaded?this.cursorContext.drawImage(t.image,0,0,this.tileSize,this.tileSize,e.x,e.y,this.actualTileSize,this.actualTileSize):t.load(),this.cursorContext.restore(),this.game.input.saveMouse())}drawFPS(){this.calculateFPS(),this.drawText(`FPS: ${this.fps}`,10,61,!1,"white")}calculateFPS(){let t=Date.now();t-this.time>=1e3&&(this.fps=this.frameCount,this.frameCount=0,this.time=t),this.frameCount++}drawPosition(){let{player:t,input:e}=this.game;this.drawText(`x: ${t.gridX} y: ${t.gridY} tileIndex: ${this.map.coordToIndex(t.gridX,t.gridY)} movementSpeed: ${t.movementSpeed}`,10,81,!1,"white"),this.drawText(`zoomFactor: ${this.camera.zoomFactor}`,10,141,!1,"white"),e.hovering&&e.entity&&(this.drawText(`x: ${e.entity.gridX} y: ${e.entity.gridY} instance: ${e.entity.instance}`,10,101,!1,"white"),e.entity.attackRange&&this.drawText(`att range: ${e.entity.attackRange}`,10,121,!1,"white"))}drawCollisions(){this.camera.forEachVisiblePosition((t,e)=>{this.map.isOutOfBounds(t,e)||this.map.grid[e][t]!==0&&this.drawCellHighlight(t,e,"rgba(50, 50, 255, 0.5)")})}drawPathing(){if(this.game.player.hasPath())for(let t of this.game.player.path)this.drawCellHighlight(t[0],t[1],"rgba(50, 255, 50, 0.5)")}drawEntity(t){var u;let e=(u=t.animation)==null?void 0:u.frame,n=t.x*this.camera.zoomFactor,r=t.y*this.camera.zoomFactor,a=n+this.actualTileSize,d=r+t.sprite.height;this.entitiesContext.save(),t.angled&&!t.isProjectile()&&(t.angle*=Math.PI/180),t.fading&&(this.entitiesContext.globalAlpha=t.fadingAlpha),t.spriteFlipX?(this.entitiesContext.translate(a,r),this.entitiesContext.scale(-1,1)):t.spriteFlipY?(this.entitiesContext.translate(n,d),this.entitiesContext.scale(1,-1)):this.entitiesContext.translate(n,r),this.entitiesContext.scale(this.camera.zoomFactor,this.camera.zoomFactor),t.customScale&&this.entitiesContext.scale(t.customScale,t.customScale),t.angled&&this.entitiesContext.rotate(t.getAngle()),t.hasShadow()&&(this.entitiesContext.globalCompositeOperation="source-over",this.entitiesContext.drawImage(this.shadowSprite.image,0,0,this.shadowSprite.width,this.shadowSprite.height,0,t.shadowOffsetY,this.shadowSprite.width,this.shadowSprite.height)),this.entitiesContext.drawImage(t.sprite.image,e.x,e.y,t.sprite.width,t.sprite.height,t.sprite.offsetX,t.sprite.offsetY,t.sprite.width,t.sprite.height),this.drawEntityFore(t),this.entitiesContext.restore(),this.drawHealth(t),this.game.overlays.hasOverlay()||this.drawName(t)}drawEntityFore(t){if(t.isItem())return this.drawSparks();t instanceof Qt&&(t.isPlayer()&&this.drawWeapon(t),t.hasActiveEffect()&&this.drawEffects(t))}drawWeapon(t){if(!t.hasWeapon()||t.dead||t.teleporting)return;let e=this.game.sprites.get(t.getWeaponSpriteName());if(!e)return;e.loaded||e.load();let n=t.animation,r=e.animations[n.name];if(!r)return;let{frame:a,row:d}=n,u=a.index<r.length?a.index:a.index%r.length,y=e.width*u,m=e.height*d,b=e.width,E=e.height;this.entitiesContext.drawImage(e.image,y,m,b,E,e.offsetX,e.offsetY,b,E)}drawEffects(t){for(let e of t.statusEffects){if(e===_e.Freezing&&t.hasEffect(_e.SnowPotion)||e===_e.Burning&&t.hasEffect(_e.FirePotion))continue;let n=t.getEffect(e);if(!n)continue;let r=this.game.sprites.get(n.key);r.loaded||r.load();let{animation:a}=n,{index:d}=a.frame,u=r.width*d,y=r.height*a.row;this.entitiesContext.drawImage(r.image,u,y,r.width,r.height,r.offsetX,r.offsetY,r.width,r.height),a.update(this.game.time)}}drawSparks(){let{sparksAnimation:t}=this.game.entities.sprites,e=t.frame;this.entitiesContext.drawImage(this.sparksSprite.image,this.sparksSprite.width*e.index,this.sparksSprite.height*t.row,this.sparksSprite.width,this.sparksSprite.height,0,0,this.sparksSprite.width,this.sparksSprite.height)}drawMedal(t,e,n){let r=this.getMedal(t);r&&this.textContext.drawImage(r.image,0,0,r.width,r.height,(e-5)*this.camera.zoomFactor,(n-17)*this.camera.zoomFactor,r.width*2,r.height*2)}drawHealth(t){if(!t.hitPoints||t.hitPoints<0||!t.healthBarVisible)return;let e=this.tileSize,n=t.x*this.camera.zoomFactor-e/2+8,r=(t.y-t.sprite.height/4)*this.camera.zoomFactor,a=Math.round(t.hitPoints/t.maxHitPoints*e*this.camera.zoomFactor),d=2*this.camera.zoomFactor;this.textContext.save(),this.setCameraView(this.textContext),this.textContext.strokeStyle="rbga(0, 0, 0, 1)",this.textContext.lineWidth=1,this.textContext.strokeRect(n,r,e*this.camera.zoomFactor,d),this.textContext.fillStyle="rgba(253, 0, 0, 1)",this.textContext.fillRect(n,r,a,d),this.textContext.restore()}drawName(t){if(t.hidden||t.healthBarVisible||!t.level||!t.drawNames()||!this.drawNames&&!this.drawLevels)return;let e=t.wanted?"red":"white";if(t.rank!==$e.None&&(e=ef[t.rank]),t.instance===this.game.player.instance&&(e="rgba(252,218,92, 1)"),t.nameColour&&(e=t.nameColour),this.textContext.save(),this.setCameraView(this.textContext),this.textContext.font="11px AdvoCut",t.hasCounter)this.game.time-t.countdownTime>1e3&&(t.countdownTime=this.game.time,t.counter--),t.counter<=0&&(t.hasCounter=!1),this.drawText(t.counter.toString(),t.x+8,t.y-10,!0,e);else{let n=t.x+8,r=t.y-Math.floor(t.sprite.height/5);if(this.drawNames&&t instanceof Qt){let a=this.drawLevels&&!t.isNPC()?r-7:r-4;this.drawText(t.name,n,a,!0,e,"rbga(0, 0, 0, 1)"),t.hasMedal()&&this.drawMedal(t.getMedalKey(),n,a)}this.drawLevels&&(t.isMob()||t.isPlayer())&&this.drawText(`Level ${t.level}`,n,r,!0,e,"rbga(0, 0, 0, 1)"),t.isItem()&&t.count>1&&this.drawText(t.count.toString(),n,r,!0,e)}this.textContext.restore()}drawMinigameGUI(){if(this.game.minigame.exists())switch(this.game.minigame.status){case"lobby":{this.drawText(this.game.minigame.started?`There is a game in progress: ${this.game.minigame.countdown} seconds`:`Game starts in ${this.game.minigame.countdown} seconds`,this.textCanvas.width/6,30,!0,"white");return}case"ingame":{this.drawText(`Red: ${this.game.minigame.redTeamScore}`,this.textCanvas.width/6-20,30,!0,"red"),this.drawText(`Blue: ${this.game.minigame.blueTeamScore}`,this.textCanvas.width/6+20,30,!0,"blue"),this.drawText(`Time left: ${this.game.minigame.countdown} seconds`,this.textCanvas.width/6,50,!0,"white");return}}}drawLighting(t){if(t.relative){let e=(t.light.origX-this.camera.x/this.tileSize)*this.actualTileSize,n=(t.light.origY-this.camera.y/this.tileSize)*this.actualTileSize;t.light.position=new Oe(e,n),t.compute(this.canvasWidth,this.canvasHeight),this.darkMask.compute(this.canvasWidth,this.canvasHeight)}else t.computed||(t.compute(this.canvasWidth,this.canvasHeight),t.computed=!0);t.render(this.overlayContext)}drawCellHighlight(t,e,n){this.drawCellRect(t*this.actualTileSize,e*this.actualTileSize,n)}drawCellRect(t,e,n){this.entitiesContext.save(),this.setCameraView(this.entitiesContext),this.entitiesContext.lineWidth=2*this.camera.zoomFactor,this.entitiesContext.translate(t+4,e+2),this.entitiesContext.strokeStyle=n,this.entitiesContext.strokeRect(0,0,this.actualTileSize-8,this.actualTileSize-8),this.entitiesContext.restore()}drawText(t,e,n,r,a,d,u=this.fontSize){let y=3,m=this.textContext;m.save(),r&&(m.textAlign="center"),u+=this.camera.zoomFactor*2,m.strokeStyle=d||"rgba(55, 55, 55, 1)",m.lineWidth=y,m.font=`${u}px AdvoCut`,m.strokeText(t,e*this.camera.zoomFactor,n*this.camera.zoomFactor),m.fillStyle=a||"white",m.fillText(t,e*this.camera.zoomFactor,n*this.camera.zoomFactor),m.restore()}updateDarkMask(t="rgba(0, 0, 0, 0.5)"){this.darkMask.color=t,this.darkMask.compute(this.canvasWidth,this.canvasHeight)}addLight(t){let e=new ip(this.getLightData(t.x,t.y,t.distance,t.diffuse,t.colour)),n=new np({light:e});e.origX=e.position.x,e.origY=e.position.y,e.diff=Math.round(e.distance/this.tileSize),!this.hasLighting(n)&&(n.relative=!0,this.lightings.push(n),this.darkMask.lights.push(e),this.drawLighting(n),this.darkMask.compute(this.canvasWidth,this.canvasHeight))}removeAllLights(){this.lightings=[],this.darkMask.lights=[],this.darkMask.compute(this.canvasWidth,this.canvasHeight)}removeNonRelativeLights(){for(let t in this.lightings)if(!this.lightings[t].light.relative){let e=parseInt(t);this.lightings.splice(e,1),this.darkMask.lights.splice(e,1)}this.darkMask.compute(this.canvasWidth,this.canvasHeight)}hasLighting(t){for(let{light:e}of this.lightings)if(t.light.origX===e.origX&&t.light.origY===e.origY&&t.light.distance===e.distance)return!0;return!1}removeSmoothing(){this.forAllContexts(t=>{t.imageSmoothingQuality="low",t.imageSmoothingEnabled=!1})}clear(){this.forEachContext(this.clearScreen)}clearScreen(t){t.clearRect(0,0,t.canvas.width,t.canvas.height)}save(){this.forEachContext(t=>t.save())}restore(){this.forEachContext(t=>t.restore())}setBrightness(t){t<0||t>100||this.forEachCanvas(e=>{e.style.background=`rgba(0,0,0,${.25-t/200})`})}setCameraView(t){!this.camera||this.stopRendering||t.translate(-this.camera.x*this.camera.zoomFactor,-this.camera.y*this.camera.zoomFactor)}getX(t,e){return t===0?0:t%e===0?e-1:t%e-1}inRadius(t){let e={x:t.light.origX,y:t.light.origY,diff:t.light.diff};return e.x>this.camera.gridX-e.diff&&e.x<this.camera.gridX+this.camera.gridWidth+e.diff&&e.y>this.camera.gridY-e.diff&&e.y<this.camera.gridY+this.camera.gridHeight+e.diff}isFlipped(t){return t?t.v||t.h||t.d:!1}isLowPowerMode(){return!this.camera.isCentered()&&!this.animateTiles}isSelectedCell(t,e){return this.game.input.selectedX===t&&this.game.input.selectedY===e}getMedal(t){switch(t){case"goldmedal":return this.goldMedal;case"silvermedal":return this.silverMedal;case"crown-artist":return this.crownArtist;case"crown-tier1":return this.crownTier1;case"crown-tier2":return this.crownTier2;case"crown-tier3":return this.crownTier3;case"crown-tier4":return this.crownTier4;case"crown-tier5":return this.crownTier5;case"crown-tier6":return this.crownTier6;case"crown-tier7":return this.crownTier7}}getLightData(t,e,n,r,a){return{position:new Oe(t,e),distance:n,diffuse:r,color:a,radius:0,samples:2,roughness:0,angle:0}}resetAnimatedTiles(){for(let t in this.animatedTiles)this.animatedTiles[t].animationIndex=0}updateAnimatedTiles(){this.animateTiles&&this.forEachVisibleTile((t,e)=>{let n=this.isFlipped(t);n&&(t=t.tileId),this.map.isAnimatedTile(t)&&(e in this.animatedTiles||(this.animatedTiles[e]=new Qg(t,e,this.map.getTileAnimation(t),n)))},2)}setTile(t,e){}bindTileLayers(){}forEachAnimatedTile(t){for(let e in this.animatedTiles)t(this.animatedTiles[e])}forEachVisibleIndex(t,e){this.camera.forEachVisiblePosition((n,r)=>{this.map.isOutOfBounds(n,r)||t(this.map.coordToIndex(n,r))},e)}forEachVisibleTile(t,e){var n;(n=this.map)!=null&&n.mapLoaded&&this.forEachVisibleIndex(r=>{let a=this.map.data[r];if(Array.isArray(a))for(let d of a)t(d,r);else this.map.data[r]&&t(this.map.data[r],r)},e)}forEachVisibleEntity(t){let{grids:e}=this.game.entities;this.camera.forEachVisiblePosition((n,r)=>{if(!this.map.isOutOfBounds(n,r)&&e.renderingGrid[r][n])for(let a of Object.values(e.renderingGrid[r][n]))t(a)})}forEachLighting(t){for(let e in this.lightings)t(this.lightings[e])}forEachCanvas(t){for(let e in this.canvases)t(this.canvases[e])}forAllContexts(t){for(let e in this.allContexts)t(this.allContexts[e])}forEachContext(t){for(let e in this.contexts)t(this.contexts[e])}}var ul=`precision highp float;

attribute vec2 aPosition;
attribute vec2 aTexture;

uniform float uInverseTileScale;

uniform vec2 uOffset;
uniform vec2 uViewportSize;
uniform vec2 uInverseLayerTileCount;
uniform vec2 uInverseLayerTileSize;

varying vec2 vPixelCoord;
varying vec2 vTextureCoord;

void main()
{
    
    
    vec2 offset = uOffset + (uInverseTileScale / 2.0);
    offset -= mod(offset, uInverseTileScale);

    vPixelCoord = (aTexture * uViewportSize) + offset;
    vTextureCoord = vPixelCoord * uInverseLayerTileCount * uInverseLayerTileSize;

    gl_Position = vec4(aPosition, 0.0, 1.0);
}`,rp=`precision mediump float;

const int uTilesetCount = TILESET_COUNT;

varying vec2 vPixelCoord;
varying vec2 vTextureCoord;

uniform sampler2D uLayer;

uniform sampler2D uTilesets0;
uniform sampler2D uTilesets1;
uniform sampler2D uTilesets2;
uniform sampler2D uTilesets3;
uniform sampler2D uTilesets4;
uniform sampler2D uTilesets5;
uniform sampler2D uTilesets[uTilesetCount];

uniform vec2 uTilesetTileSize[uTilesetCount];
uniform vec2 uTilesetTileOffset[uTilesetCount];
uniform vec2 uInverseTilesetTextureSize[uTilesetCount];
uniform float uAlpha;
uniform int uRepeatTiles;

const float Flag_FlippedAntiDiagonal = 2.0;
const float Flag_FlippedVertical = 4.0;
const float Flag_FlippedHorizontal = 8.0;
const vec4 c_one4 = vec4(1.0, 1.0, 1.0, 1.0);

float hasFlag(float value, float flag)
{
    float byteVal = 1.0;

    
    if (value == 0.0)
        return 0.0;

    
    for (int i = 0; i < 4; ++i)
    {
        if (mod(value, 2.0) > 0.0 && mod(flag, 2.0) > 0.0)
            return 1.0;

        value = floor(value / 2.0);
        flag = floor(flag / 2.0);

        if (!(value > 0.0 && flag > 0.0))
            return 0.0;
    }

    return 0.0;
}

vec2 getTilesetTileSize(int index)
{
    for (int i = 0; i < uTilesetCount; ++i)
        if (i == index)
            return uTilesetTileSize[i];

    return vec2(0.0, 0.0);
}

vec2 getTilesetTileOffset(int index)
{
    for (int i = 0; i < uTilesetCount; ++i)
        if (i == index)
            return uTilesetTileOffset[i];

    return vec2(0.0, 0.0);
}

vec4 getColor(int index, vec2 coord) {
    for (int i = 0; i < uTilesetCount; ++i)
        if (i == index)
            return texture2D(uTilesets[i], coord * uInverseTilesetTextureSize[i]);

    return vec4(0.0, 0.0, 0.0, 0.0);
}

void main()
{
    if (uRepeatTiles == 0 && (vTextureCoord.x < 0.0 || vTextureCoord.x > 1.0 || vTextureCoord.y < 0.0 || vTextureCoord.y > 1.0))
        discard;

    vec4 tile = texture2D(uLayer, vTextureCoord);

    if (tile == c_one4)
        discard;

    float flipFlags = floor(tile.w * 255.0);

    
    
    
    

    int imgIndex = int(floor(tile.z * 255.0));
    vec2 tileSize = getTilesetTileSize(imgIndex);
    vec2 tileOffset = getTilesetTileOffset(imgIndex);

    vec2 flipVec = vec2(hasFlag(flipFlags, Flag_FlippedHorizontal), hasFlag(flipFlags, Flag_FlippedVertical));

    vec2 tileCoord = floor(tile.xy * 255.0);

    
    tileCoord.x = (tileCoord.x * tileSize.x) + (tileCoord.x * tileOffset.x) + tileOffset.y;
    tileCoord.y = (tileCoord.y * tileSize.y) + (tileCoord.y * tileOffset.x) + tileOffset.y;

    vec2 offsetInTile = mod(vPixelCoord, tileSize);
    vec2 offsetInTileFlipped = abs((tileSize * flipVec) - offsetInTile);

    
    if (hasFlag(flipFlags, Flag_FlippedAntiDiagonal) == 1.0)
    {
        float x = offsetInTileFlipped.x;
        offsetInTileFlipped.x = offsetInTileFlipped.y;
        offsetInTileFlipped.y = x;
    }

    vec4 color = getColor(imgIndex, tileCoord + offsetInTileFlipped);

    gl_FragColor = vec4(color.rgb, color.a * uAlpha);
}`;class sp extends xh{constructor(e){super(e);l(this,"backContext",this.background.getContext("webgl"));l(this,"foreContext",this.foreground.getContext("webgl"));l(this,"drawingContexts",[this.backContext,this.foreContext]);l(this,"backShader");l(this,"foreShader");l(this,"tilesets",{});l(this,"layers",[]);l(this,"tilesetIndices",new Int32Array);l(this,"tilesetTileSizeBuffer",new Float32Array);l(this,"tilesetOffsetBuffer",new Float32Array);l(this,"inverseTilesetTextureSizeBuffer",new Float32Array);l(this,"inverseTileCount",new Float32Array(2));l(this,"backQuadBuffer",this.backContext.createBuffer());l(this,"foreQuadBuffer",this.foreContext.createBuffer());l(this,"quadVertices",new Float32Array([-1,-1,0,1,1,-1,1,1,1,1,1,0,-1,-1,0,1,1,1,1,0,-1,1,0,0]));l(this,"attributeIndices",{aPosition:0,aTexture:1});l(this,"blendMode",{func:[WebGLRenderingContext.SRC_ALPHA,WebGLRenderingContext.ONE_MINUS_SRC_ALPHA],equation:WebGLRenderingContext.FUNC_ADD})}load(){let e=this.map.tilesets.length;this.backShader=new ll(this.backContext,ul,this.getFragmentShader(e)),this.foreShader=new ll(this.foreContext,ul,this.getFragmentShader(e)),this.tilesetIndices=new Int32Array(e),this.tilesetTileSizeBuffer=new Float32Array(e*2),this.tilesetOffsetBuffer=new Float32Array(e*2),this.inverseTilesetTextureSizeBuffer=new Float32Array(e*2);for(let n=0;n<e;n++)this.tilesetIndices[n]=n+1,this.tilesetTileSizeBuffer[n*2]=this.map.tileSize,this.tilesetTileSizeBuffer[n*2+1]=this.map.tileSize,this.tilesetOffsetBuffer[n*2]=0,this.tilesetOffsetBuffer[n*2+1]=0,this.inverseTilesetTextureSizeBuffer[n*2]=1/this.map.tilesets[n].width,this.inverseTilesetTextureSizeBuffer[n*2+1]=1/this.map.tilesets[n].height;this.inverseTileCount[0]=1/this.map.width,this.inverseTileCount[1]=1/this.map.height,this.forEachDrawingContext(n=>{this.tilesets[n.canvas.id]=new Zg(this.map,n),this.bindBuffer(n),this.bindTexture(n),this.bindTileShaders(n)})}setTile(e,n){if(this.clearTile(e),!Array.isArray(n))return this.addTile(e,n);for(let r in n)this.addTile(e,n[r],parseInt(r))}bindBuffer(e){e.bindBuffer(e.ARRAY_BUFFER,this.getQuadBuffer(e)),e.bufferData(e.ARRAY_BUFFER,this.quadVertices,e.STATIC_DRAW)}bindTexture(e){for(let n of this.layers)n.bindTexture(e,this.getShader(e).program,!this.isBackgroundContext(e))}bindTileShaders(e){let n=this.getShader(e);e.useProgram(n.program);let r=new Float32Array([1/this.map.tileSize,1/this.map.tileSize]);e.uniform1i(n.uniforms.uLayer,0),e.uniform2fv(n.uniforms.uInverseLayerTileSize,r);for(let a=0;a<this.tilesetIndices.length;a++)e.uniform1i(e.getUniformLocation(n.program,`uTilesets[${a}]`),this.tilesetIndices[a]);e.uniform2fv(n.uniforms.uTilesetTileSize,this.tilesetTileSizeBuffer),e.uniform2fv(n.uniforms.uTilesetTileOffset,this.tilesetOffsetBuffer),e.uniform2fv(n.uniforms.uInverseTilesetTextureSize,this.inverseTilesetTextureSizeBuffer)}bindTileLayers(){this.forEachDrawingContext(e=>this.bindTexture(e))}resize(){super.resize(),this.forEachDrawingContext(e=>{let n=new Float32Array([this.screenWidth,this.screenHeight]),r=this.getShader(e);e.viewport(0,0,e.canvas.width,e.canvas.height),e.uniform2fv(r.uniforms.uViewportSize,n),e.uniform1f(r.uniforms.uInverseTileScale,1/this.camera.zoomFactor)})}render(){this.draw(),super.render()}draw(e=this.camera.x,n=this.camera.y){this.forEachDrawingContext(r=>{r.enable(r.BLEND),r.blendEquation(this.blendMode.equation),r.blendFunc(this.blendMode.func[0],this.blendMode.func[1]),r.bindBuffer(r.ARRAY_BUFFER,this.getQuadBuffer(r)),r.enableVertexAttribArray(this.attributeIndices.aPosition),r.enableVertexAttribArray(this.attributeIndices.aTexture),r.vertexAttribPointer(this.attributeIndices.aPosition,2,r.FLOAT,!1,16,0),r.vertexAttribPointer(this.attributeIndices.aTexture,2,r.FLOAT,!1,16,8),this.tilesets[r.canvas.id].forEachTexture((d,u)=>{r.activeTexture(r.TEXTURE1+u),r.bindTexture(r.TEXTURE_2D,d)}),r.activeTexture(r.TEXTURE0);let a=this.getShader(r);r.useProgram(a.program),r.uniform1f(a.uniforms.uAlpha,1),r.uniform1i(a.uniforms.uRepeatTiles,1),r.uniform2fv(a.uniforms.uInverseLayerTileCount,this.inverseTileCount),r.uniform2f(a.uniforms.uOffset,e,n);for(let d of this.layers)r.bindTexture(r.TEXTURE_2D,this.isBackgroundContext(r)?d.backgroundTexture:d.foregroundTexture),r.drawArrays(r.TRIANGLES,0,6)})}addTile(e,n,r=0){this.layers[r]||(this.layers[r]=new Kg(this.map)),this.layers[r].addTile(e,n,this.isFlipped(n))}clearTile(e){for(let n of this.layers)n.clear(e)}isBackgroundContext(e){return e.canvas.id==="background"}getShader(e){return this.isBackgroundContext(e)?this.backShader:this.foreShader}getQuadBuffer(e){return this.isBackgroundContext(e)?this.backQuadBuffer:this.foreQuadBuffer}getFragmentShader(e){return rp.replace("TILESET_COUNT",e.toString())}forEachDrawingContext(e){for(let n in this.drawingContexts)e(this.drawingContexts[n])}}class ap extends xh{constructor(e){super(e);l(this,"renderedFrame",[-1,-1]);l(this,"tiles",{});l(this,"cells",{});l(this,"backContext",this.background.getContext("2d"));l(this,"foreContext",this.foreground.getContext("2d"));l(this,"drawingContexts",[this.backContext,this.foreContext]);this.allContexts.push(this.backContext,this.foreContext)}resize(){super.resize(),this.cells={}}render(){this.stopRendering||(super.render(),this.draw())}draw(){this.hasRenderedFrame()||(this.clearDrawing(),this.saveDrawing(),this.backContext.fillStyle="rgba(9, 10, 20, 1)",this.backContext.fillRect(0,0,this.background.width,this.background.height),this.updateDrawingView(),this.forEachVisibleTile((e,n)=>{let r=this.getFlipped(e);r.length>0&&(e=e.tileId);let a=this.map.isHighTile(e),d=a?this.foreContext:this.backContext;if(this.game.overlays.hasOverlay()&&(d=this.map.isLightTile(e)?this.overlayContext:d),n in this.animatedTiles&&this.animateTiles){if(this.animatedTiles[n].animate(this.game.time),r.length===0&&this.animatedTiles[n].isFlipped)return;this.drawTile(d,this.animatedTiles[n].id,this.animatedTiles[n].index,r)}(!this.map.isAnimatedTile(e)||!this.animateTiles)&&this.drawTile(d,e-1,n,r)}),this.saveFrame(),this.restoreDrawing())}drawTile(e,n,r,a=[]){if(n<0)return;let d=this.map.getTilesetFromId(n);if(d){if(!(n in this.tiles)){let u=d.width/this.tileSize,y=n-d.firstGid;this.tiles[n]={relativeTileId:y,setWidth:u,x:this.getX(y+1,u)*this.tileSize,y:Math.floor(y/u)*this.tileSize,width:this.tileSize,height:this.tileSize}}(!(r in this.cells)||a.length>0)&&(this.cells[r]={dx:this.getX(r+1,this.map.width)*this.actualTileSize,dy:Math.floor(r/this.map.width)*this.actualTileSize,width:this.actualTileSize,height:this.actualTileSize}),this.drawImage(e,d,this.tiles[n],this.cells[r],a)}}drawImage(e,n,r,a,d=[]){let u=0,y=0,m=d.length>0;if(m){({dx:u,dy:y}=a),e.save();let b=u;for(let E=0;E<d.length;E++)switch(d[E]){case 0:{u=-u-a.width,e.scale(-1,1);break}case 1:{y=-y-a.height,e.scale(1,-1);break}case 2:{e.rotate(Math.PI/2),e.translate(0,-a.height),u=y,y=-b,d[E+1]===0?d.push(0):d.push(1);break}}}e.drawImage(n,r.x,r.y,r.width,r.height,u||a.dx,y||a.dy,a.width,a.height),m&&e.restore()}hasRenderedFrame(){return this.forceRendering||!this.isLowPowerMode()?!1:this.stopRendering?!0:this.renderedFrame[0]===this.camera.x&&this.renderedFrame[1]===this.camera.y}clearDrawing(){this.forEachDrawingContext(this.clearScreen)}saveDrawing(){this.forEachDrawingContext(e=>e.save())}saveFrame(){this.isLowPowerMode()&&(this.renderedFrame[0]=this.camera.x,this.renderedFrame[1]=this.camera.y,this.forceRendering=!1)}restoreDrawing(){this.forEachDrawingContext(e=>e.restore())}updateDrawingView(){this.forEachDrawingContext(e=>this.setCameraView(e))}getFlipped(e){let n=[];return this.isFlipped(e)&&(e.v&&n.push(1),e.d&&n.push(2),e.h&&n.push(0)),n}forEachDrawingContext(e){for(let n in this.drawingContexts)e(this.drawingContexts[n])}}class op{constructor(t){l(this,"tileSize");l(this,"sprites");this.game=t,this.tileSize=t.map.tileSize,this.sprites=t.sprites}update(){this.game.player.dead||(this.updateEntities(),this.updateKeyboard(),this.updateAnimations(),this.updateInfos(),this.updateBubbles(),this.updateSounds())}updateEntities(){this.game.entities.forEachEntity(t=>{var d,u;if(!((d=t.sprite)!=null&&d.loaded))return;if(this.updateFading(t),(u=t.animation)==null||u.update(this.game.time),t instanceof Nl){let y=t.speed*t.getTimeDiff(),m=t.target.x-t.x,b=t.target.y-t.y,E=Math.sqrt(m*m+b*b),Y=y/E;t.updateAngle(),Y>1&&(Y=1),t.x+=m*Y,t.y+=b*Y,E<5&&t.impact(),t.lastUpdate=this.game.time;return}if(!(t instanceof Qt))return;if(t.movement.inProgress)return t.movement.step(this.game.time);if(!t.hasPath())return;let e=t.orientation===re.Left||t.orientation===re.Right,n=t.orientation===re.Up||t.orientation===re.Down,r,a;e&&(r=t.orientation===re.Left),n&&(a=t.orientation===re.Up),t.movement.start(this.game.time,e?t.x+(r?-1:1):t.y+(a?-1:1),e?t.x+(r?-this.tileSize:this.tileSize):t.y+(a?-this.tileSize:this.tileSize),t.movementSpeed,y=>{e&&(t.x=y),n&&(t.y=y),t.moved()},()=>{e&&(t.x=t.movement.endValue),n&&(t.y=t.movement.endValue),t.moved(),t.nextStep()})})}updateFading(t){if(!t.fading)return;let{time:e}=this.game,n=e-t.fadingTime;n>t.fadingDuration?(t.fading=!1,t.fadingAlpha=1):t.fadingAlpha=n/t.fadingDuration}updateKeyboard(){let{player:t,input:e}=this.game,n={x:-1,y:-1,gridX:t.gridX,gridY:t.gridY};t.moving||t.teleporting||t.frozen||!t.hasKeyboardMovement()||(t.moveUp?n.gridY--:t.moveDown?n.gridY++:t.moveRight?n.gridX++:t.moveLeft&&n.gridX--,e.keyMove(n))}updateAnimations(){let t=this.game.input.targetAnimation;if(t&&this.game.input.selectedCellVisible&&t.update(this.game.time),!this.sprites)return;let e=this.sprites.sparksAnimation;e==null||e.update(this.game.time)}updateInfos(){this.game.info.update(this.game.time)}updateBubbles(){var t,e;(t=this.game.bubble)==null||t.update(this.game.time),(e=this.game.pointer)==null||e.update()}updateSounds(){this.game.audio.updatePlayerListener()}}/**
 * A* (A-Star) algorithm for a path finder
 * @author  Andrea Giammarchi
 * @license Mit Style License
 */function lp(i,t,e,n){let r=i[0].length,a=i.length,d=r*a,u=Math.max,y={},m=[],b=[{x:t[0],y:t[1],f:0,g:0,v:t[0]+t[1]*r}],E=1,Y,I,A,O,J={x:e[0],y:e[1],v:e[0]+e[1]*r};switch(n){case"Diagonal":case"Euclidean":I=hp;case"DiagonalFree":{Y=up;break}case"EuclideanFree":{u=Math.sqrt,Y=gp;break}default:{Y=pp,I=fp;break}}I||(I=dp);do{if(E>100)return[];let F=d,ue=0;for(let j=0;j<E;++j){let z=b[j].f;z<F&&(F=z,ue=j)}if([A]=b.splice(ue,1),A.v===J.v){let j=E=0;do m[j++]=[A.x,A.y];while(A=A.p);m.reverse()}else{--E,O=cp(I,A.x,A.y,i,a,r);for(let j=0,z=O.length;j<z;++j){let te=O[j];te.p=A,te.f=te.g=0,te.v=te.x+te.y*r,te.v in y||(te.f=(te.g=A.g+Y(te,A,Math.abs,u))+Y(te,J,Math.abs,u),b[E++]=te,y[te.v]=1)}}}while(E);return m}let hp=(i,t,e,n,r,a,d,u,y,m,b,E,Y)=>(i&&(e&&!y[r][d]&&(E[Y++]={x:d,y:r}),n&&!y[r][u]&&(E[Y++]={x:u,y:r})),t&&(e&&!y[a][d]&&(E[Y++]={x:d,y:a}),n&&!y[a][u]&&(E[Y++]={x:u,y:a})),E),dp=(i,t,e,n,r,a,d,u,y,m,b,E,Y)=>(i=r>-1,t=a<m,e=d<b,n=u>-1,e&&(i&&!y[r][d]&&(E[Y++]={x:d,y:r}),t&&!y[a][d]&&(E[Y++]={x:d,y:a})),n&&(i&&!y[r][u]&&(E[Y++]={x:u,y:r}),t&&!y[a][u]&&(E[Y++]={x:u,y:a})),E),fp=(i,t,e,n,r,a,d,u,y,m,b,E)=>E;function cp(i,t,e,n,r,a){let d=e-1,u=e+1,y=t+1,m=t-1,b=d>-1&&!n[d][t],E=u<r&&!n[u][t],Y=y<a&&!n[e][y],I=m>-1&&!n[e][m],A=[],O=0;return b&&(A[O++]={x:t,y:d}),Y&&(A[O++]={x:y,y:e}),E&&(A[O++]={x:t,y:u}),I&&(A[O++]={x:m,y:e}),i(b,E,Y,I,d,u,y,m,n,r,a,A,O)}let up=(i,t,e,n)=>n(e(i.x-t.x),e(i.y-t.y)),gp=(i,t,e,n)=>{let r=i.x-t.x,a=i.y-t.y;return n(r*r+a*a)},pp=(i,t,e)=>e(i.x-t.x)+e(i.y-t.y);class mp{constructor(){l(this,"mode","DEFAULT")}find(t,e,n,r,a,d=[]){this.handleIgnore(t,d,!0);let u=lp(t,[e,n],[r,a],this.mode);return this.handleIgnore(t,d),u}handleIgnore(t,e,n=!1){for(let r of e)r.x<0||r.y<0||r.fake||(t[r.y][r.x]===0&&(r.fake=!0),t[r.y][r.x]=n?0:1)}}class wp{constructor(t){l(this,"player");l(this,"storage");l(this,"map");l(this,"camera");l(this,"zoning",new ac);l(this,"overlays",new Vg);l(this,"pathfinder",new mp);l(this,"info",new Xf);l(this,"sprites");l(this,"minigame",new Wg);l(this,"renderer");l(this,"input");l(this,"socket");l(this,"pointer");l(this,"updater");l(this,"audio");l(this,"entities");l(this,"bubble");l(this,"menu");l(this,"connection");l(this,"time",Date.now());l(this,"lastTime",Date.now());l(this,"started",!1);l(this,"ready",!1);l(this,"pvp",!1);l(this,"useWebGl",!1);this.app=t,this.storage=t.storage,this.player=new Rl("",this),this.map=new pc(this),this.camera=new Gg(this.map.width,this.map.height,this.map.tileSize),this.sprites=new sc,this.renderer=this.useWebGl?new sp(this):new ap(this),this.menu=new ic(this),this.input=new Df(this),this.socket=new jg(this),this.pointer=new nc(this),this.updater=new op(this),this.audio=new lf(this),this.entities=new If(this),this.bubble=new uf(this),this.connection=new Hg(this),t.sendStatus("Loading game"),this.map.onReady(()=>t.ready()),t.onLogin(this.socket.connect.bind(this.socket)),t.onResize(this.resize.bind(this)),t.onRespawn(this.respawn.bind(this)),this.player.onSync(this.handlePlayerSync.bind(this))}start(){this.started||(this.started=!0,this.tick())}tick(){this.time=Date.now(),this.renderer.render(),this.updater.update(),this.started&&requestAnimationFrame(()=>this.tick())}handleDisconnection(){this.app.isMenuHidden()&&location.reload()}handlePlayerSync(){this.menu.synchronize(),this.player.setSprite(this.sprites.get(this.player.getSpriteName()))}postLoad(){this.entities.addEntity(this.player),this.player.setSprite(this.sprites.get(this.player.getSpriteName())),this.player.idle(),this.storage&&(this.player.setOrientation(this.storage.data.player.orientation),this.camera.setZoom(this.storage.data.player.zoom),this.renderer.resize()),this.camera.centreOn(this.player),this.player.handler=new oc(this.player),this.renderer.updateAnimatedTiles(),this.socket.send(B.Ready,{regionsLoaded:this.map.regionsLoaded,userAgent:Ds}),this.storage.data.new&&(this.storage.data.new=!1,this.storage.save()),this.map.hasCachedDate()&&this.app.fadeMenu()}findPath(t,e,n,r=[],a=""){let d=[];if(d=this.pathfinder.find(this.map.grid,t.gridX,t.gridY,e,n,r),d.length===0)return d;if(a==="fishing"){let u=d[d.length-2];this.map.isColliding(u[0],u[1])&&d.pop()}return d}updateCameraBounds(){if(!this.zoning)return;let t=this.player.gridX-this.camera.gridX,e=this.player.gridY-this.camera.gridY;t===0?this.zoning.setLeft():t===this.camera.gridWidth-2?this.zoning.setRight():e===0?this.zoning.setUp():e===this.camera.gridHeight-2&&this.zoning.setDown(),this.zoning.direction!==null&&(this.camera.zone(this.zoning.getDirection()),this.renderer.updateAnimatedTiles(),this.zoning.reset())}respawn(){this.audio.playSound("revive"),this.app.body.classList.remove("death"),this.socket.send(B.Respawn,[])}resize(){this.renderer.resize(),this.pointer.resize(),this.menu.resize()}getEntityAt(t,e){if(!this.entities)return;let n=this.entities.grids.renderingGrid[e][t],r=Object.keys(n),a=r.indexOf(this.player.instance);return a!==-1&&r.splice(a,1),n[r[0]]}searchForEntityAt(t,e=2){let n=this.entities.grids.getEntitiesAround(t.gridX,t.gridY,e);for(let r of n)if(t.x>=r.x+r.sprite.offsetX&&t.x<=r.x+r.sprite.offsetX+r.sprite.width&&t.y>=r.y+r.sprite.offsetY&&t.y<=r.y+r.sprite.offsetY+r.sprite.height)return r}teleport(t,e,n){this.entities.unregisterPosition(t),t.setGridPosition(e,n),this.entities.registerPosition(t),t.frozen=!1,t.teleporting=!1,t.instance===this.player.instance&&(t.clearHealthBar(),this.player.moving=!1,this.player.disableAction=!1,this.camera.centreOn(this.player),this.renderer.updateAnimatedTiles())}zoom(t){this.camera.zoom(t),this.storage.setZoom(this.camera.zoomFactor),this.renderer.resize()}}const _p=Object.prototype.toString;function ca(i,t){return _p.call(i)===`[object ${t}]`}function gl(i){return ca(i,"String")}function Eh(i){return ca(i,"Object")}function bp(i){return ca(i,"RegExp")}function Ei(i){return Boolean(i&&i.then&&typeof i.then=="function")}function yp(i){return typeof i=="number"&&i!==i}function Th(i,t){try{return i instanceof t}catch(e){return!1}}function ar(i){return i&&i.Math==Math?i:void 0}const bt=typeof globalThis=="object"&&ar(globalThis)||typeof window=="object"&&ar(window)||typeof self=="object"&&ar(self)||typeof global=="object"&&ar(global)||function(){return this}()||{};function ua(){return bt}function ga(i,t,e){const n=e||bt,r=n.__SENTRY__=n.__SENTRY__||{};return r[i]||(r[i]=t())}const kp="Sentry Logger ",Er=["debug","info","warn","error","log","assert","trace"];function Ch(i){if(!("console"in bt))return i();const t=bt.console,e={};Er.forEach(n=>{const r=t[n]&&t[n].__sentry_original__;n in t&&r&&(e[n]=t[n],t[n]=r)});try{return i()}finally{Object.keys(e).forEach(n=>{t[n]=e[n]})}}function pl(){let i=!1;const t={enable:()=>{i=!0},disable:()=>{i=!1}};return typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?Er.forEach(e=>{t[e]=(...n)=>{i&&Ch(()=>{bt.console[e](`${kp}[${e}]:`,...n)})}}):Er.forEach(e=>{t[e]=()=>{}}),t}let ie;typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?ie=ga("logger",pl):ie=pl();function Fe(i,t,e){if(!(t in i))return;const n=i[t],r=e(n);if(typeof r=="function")try{Sp(r,n)}catch(a){}i[t]=r}function vp(i,t,e){Object.defineProperty(i,t,{value:e,writable:!0,configurable:!0})}function Sp(i,t){const e=t.prototype||{};i.prototype=t.prototype=e,vp(i,"__sentry_original__",t)}function zi(i){return Qs(i,new Map)}function Qs(i,t){if(Eh(i)){const e=t.get(i);if(e!==void 0)return e;const n={};t.set(i,n);for(const r of Object.keys(i))typeof i[r]<"u"&&(n[r]=Qs(i[r],t));return n}if(Array.isArray(i)){const e=t.get(i);if(e!==void 0)return e;const n=[];return t.set(i,n),i.forEach(r=>{n.push(Qs(r,t))}),n}return i}const Ys="<anonymous>";function xp(i){try{return!i||typeof i!="function"?Ys:i.name||Ys}catch(t){return Ys}}const mi=ua();function Ep(){if(!("fetch"in mi))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(i){return!1}}function ml(i){return i&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(i.toString())}function Tp(){if(!Ep())return!1;if(ml(mi.fetch))return!0;let i=!1;const t=mi.document;if(t&&typeof t.createElement=="function")try{const e=t.createElement("iframe");e.hidden=!0,t.head.appendChild(e),e.contentWindow&&e.contentWindow.fetch&&(i=ml(e.contentWindow.fetch)),t.head.removeChild(e)}catch(e){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return i}function Cp(){const i=mi.chrome,t=i&&i.app&&i.app.runtime,e="history"in mi&&!!mi.history.pushState&&!!mi.history.replaceState;return!t&&e}const Ce=ua(),kn={},wl={};function Ip(i){if(!wl[i])switch(wl[i]=!0,i){case"console":Yp();break;case"dom":Op();break;case"xhr":Dp();break;case"fetch":Xp();break;case"history":Rp();break;case"error":qp();break;case"unhandledrejection":Bp();break;default:(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn("unknown instrumentation type:",i);return}}function Js(i,t){kn[i]=kn[i]||[],kn[i].push(t),Ip(i)}function yt(i,t){if(!(!i||!kn[i]))for(const e of kn[i]||[])try{e(t)}catch(n){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error(`Error while triggering instrumentation handler.
Type: ${i}
Name: ${xp(e)}
Error:`,n)}}function Yp(){"console"in Ce&&Er.forEach(function(i){i in Ce.console&&Fe(Ce.console,i,function(t){return function(...e){yt("console",{args:e,level:i}),t&&t.apply(Ce.console,e)}})})}function Xp(){Tp()&&Fe(Ce,"fetch",function(i){return function(...t){const e={args:t,fetchData:{method:Lp(t),url:Ap(t)},startTimestamp:Date.now()};return yt("fetch",{...e}),i.apply(Ce,t).then(n=>(yt("fetch",{...e,endTimestamp:Date.now(),response:n}),n),n=>{throw yt("fetch",{...e,endTimestamp:Date.now(),error:n}),n})}})}function Lp(i=[]){return"Request"in Ce&&Th(i[0],Request)&&i[0].method?String(i[0].method).toUpperCase():i[1]&&i[1].method?String(i[1].method).toUpperCase():"GET"}function Ap(i=[]){return typeof i[0]=="string"?i[0]:"Request"in Ce&&Th(i[0],Request)?i[0].url:String(i[0])}function Dp(){if(!("XMLHttpRequest"in Ce))return;const i=XMLHttpRequest.prototype;Fe(i,"open",function(t){return function(...e){const n=e[1],r=this.__sentry_xhr__={method:gl(e[0])?e[0].toUpperCase():e[0],url:e[1]};gl(n)&&r.method==="POST"&&n.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const a=()=>{const d=this.__sentry_xhr__;if(d&&this.readyState===4){try{d.status_code=this.status}catch(u){}yt("xhr",{args:e,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:this})}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?Fe(this,"onreadystatechange",function(d){return function(...u){return a(),d.apply(this,u)}}):this.addEventListener("readystatechange",a),t.apply(this,e)}}),Fe(i,"send",function(t){return function(...e){return this.__sentry_xhr__&&e[0]!==void 0&&(this.__sentry_xhr__.body=e[0]),yt("xhr",{args:e,startTimestamp:Date.now(),xhr:this}),t.apply(this,e)}})}let or;function Rp(){if(!Cp())return;const i=Ce.onpopstate;Ce.onpopstate=function(...e){const n=Ce.location.href,r=or;if(or=n,yt("history",{from:r,to:n}),i)try{return i.apply(this,e)}catch(a){}};function t(e){return function(...n){const r=n.length>2?n[2]:void 0;if(r){const a=or,d=String(r);or=d,yt("history",{from:a,to:d})}return e.apply(this,n)}}Fe(Ce.history,"pushState",t),Fe(Ce.history,"replaceState",t)}const Np=1e3;let lr,hr;function Mp(i,t){if(!i||i.type!==t.type)return!0;try{if(i.target!==t.target)return!0}catch(e){}return!1}function Pp(i){if(i.type!=="keypress")return!1;try{const t=i.target;if(!t||!t.tagName)return!0;if(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)return!1}catch(t){}return!0}function _l(i,t=!1){return e=>{if(!e||hr===e||Pp(e))return;const n=e.type==="keypress"?"input":e.type;lr===void 0?(i({event:e,name:n,global:t}),hr=e):Mp(hr,e)&&(i({event:e,name:n,global:t}),hr=e),clearTimeout(lr),lr=Ce.setTimeout(()=>{lr=void 0},Np)}}function Op(){if(!("document"in Ce))return;const i=yt.bind(null,"dom"),t=_l(i,!0);Ce.document.addEventListener("click",t,!1),Ce.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(e=>{const n=Ce[e]&&Ce[e].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(Fe(n,"addEventListener",function(r){return function(a,d,u){if(a==="click"||a=="keypress")try{const y=this,m=y.__sentry_instrumentation_handlers__=y.__sentry_instrumentation_handlers__||{},b=m[a]=m[a]||{refCount:0};if(!b.handler){const E=_l(i);b.handler=E,r.call(this,a,E,u)}b.refCount++}catch(y){}return r.call(this,a,d,u)}}),Fe(n,"removeEventListener",function(r){return function(a,d,u){if(a==="click"||a=="keypress")try{const y=this,m=y.__sentry_instrumentation_handlers__||{},b=m[a];b&&(b.refCount--,b.refCount<=0&&(r.call(this,a,b.handler,u),b.handler=void 0,delete m[a]),Object.keys(m).length===0&&delete y.__sentry_instrumentation_handlers__)}catch(y){}return r.call(this,a,d,u)}}))})}let Xs=null;function qp(){Xs=Ce.onerror,Ce.onerror=function(i,t,e,n,r){return yt("error",{column:n,error:r,line:e,msg:i,url:t}),Xs?Xs.apply(this,arguments):!1}}let Ls=null;function Bp(){Ls=Ce.onunhandledrejection,Ce.onunhandledrejection=function(i){return yt("unhandledrejection",i),Ls?Ls.apply(this,arguments):!0}}function _i(){const i=bt,t=i.crypto||i.msCrypto;if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");const e=t&&t.getRandomValues?()=>t.getRandomValues(new Uint8Array(1))[0]:()=>Math.random()*16;return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,n=>(n^(e()&15)>>n/4).toString(16))}function ea(i){return Array.isArray(i)?i:[i]}function zp(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function pa(){return!zp()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function Wt(i,t){return i.require(t)}function Si(i){let t;try{t=Wt(module,i)}catch(e){}try{const{cwd:e}=Wt(module,"process");t=Wt(module,`${e()}/node_modules/${i}`)}catch(e){}return t}var Ot;(function(i){i[i.PENDING=0]="PENDING";const e=1;i[i.RESOLVED=e]="RESOLVED";const n=2;i[i.REJECTED=n]="REJECTED"})(Ot||(Ot={}));class Et{__init(){this._state=Ot.PENDING}__init2(){this._handlers=[]}constructor(t){Et.prototype.__init.call(this),Et.prototype.__init2.call(this),Et.prototype.__init3.call(this),Et.prototype.__init4.call(this),Et.prototype.__init5.call(this),Et.prototype.__init6.call(this);try{t(this._resolve,this._reject)}catch(e){this._reject(e)}}then(t,e){return new Et((n,r)=>{this._handlers.push([!1,a=>{if(!t)n(a);else try{n(t(a))}catch(d){r(d)}},a=>{if(!e)r(a);else try{n(e(a))}catch(d){r(d)}}]),this._executeHandlers()})}catch(t){return this.then(e=>e,t)}finally(t){return new Et((e,n)=>{let r,a;return this.then(d=>{a=!1,r=d,t&&t()},d=>{a=!0,r=d,t&&t()}).then(()=>{if(a){n(r);return}e(r)})})}__init3(){this._resolve=t=>{this._setResult(Ot.RESOLVED,t)}}__init4(){this._reject=t=>{this._setResult(Ot.REJECTED,t)}}__init5(){this._setResult=(t,e)=>{if(this._state===Ot.PENDING){if(Ei(e)){e.then(this._resolve,this._reject);return}this._state=t,this._value=e,this._executeHandlers()}}}__init6(){this._executeHandlers=()=>{if(this._state===Ot.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(e=>{e[0]||(this._state===Ot.RESOLVED&&e[1](this._value),this._state===Ot.REJECTED&&e[2](this._value),e[0]=!0)})}}}function Fp(i){return i.split(/[\?#]/,1)[0]}function Tr(i){return i.split(/\\?\//).filter(t=>t.length>0&&t!==",").length}function Up(i,t={}){const e=i.method&&i.method.toUpperCase();let n="",r="url";t.customRoute||i.route?(n=t.customRoute||`${i.baseUrl||""}${i.route&&i.route.path}`,r="route"):(i.originalUrl||i.url)&&(n=Fp(i.originalUrl||i.url||""));let a="";return t.method&&e&&(a+=e),t.method&&t.path&&(a+=" "),t.path&&n&&(a+=n),[a,r]}const Ih=ua(),ta={nowSeconds:()=>Date.now()/1e3};function Hp(){const{performance:i}=Ih;if(!i||!i.now)return;const t=Date.now()-i.now();return{now:()=>i.now(),timeOrigin:t}}function $p(){try{return Wt(module,"perf_hooks").performance}catch(i){return}}const As=pa()?$p():Hp(),bl=As===void 0?ta:{nowSeconds:()=>(As.timeOrigin+As.now())/1e3},Yh=ta.nowSeconds.bind(ta),ma=bl.nowSeconds.bind(bl),yl=ma;(()=>{const{performance:i}=Ih;if(!i||!i.now)return;const t=3600*1e3,e=i.now(),n=Date.now(),r=i.timeOrigin?Math.abs(i.timeOrigin+e-n):t,a=r<t,d=i.timing&&i.timing.navigationStart,y=typeof d=="number"?Math.abs(d+e-n):t,m=y<t;return a||m?r<=y?i.timeOrigin:d:n})();const Xh="production";function jp(i){const t=ma(),e={sid:_i(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Wp(e)};return i&&Or(e,i),e}function Or(i,t={}){if(t.user&&(!i.ipAddress&&t.user.ip_address&&(i.ipAddress=t.user.ip_address),!i.did&&!t.did&&(i.did=t.user.id||t.user.email||t.user.username)),i.timestamp=t.timestamp||ma(),t.ignoreDuration&&(i.ignoreDuration=t.ignoreDuration),t.sid&&(i.sid=t.sid.length===32?t.sid:_i()),t.init!==void 0&&(i.init=t.init),!i.did&&t.did&&(i.did=`${t.did}`),typeof t.started=="number"&&(i.started=t.started),i.ignoreDuration)i.duration=void 0;else if(typeof t.duration=="number")i.duration=t.duration;else{const e=i.timestamp-i.started;i.duration=e>=0?e:0}t.release&&(i.release=t.release),t.environment&&(i.environment=t.environment),!i.ipAddress&&t.ipAddress&&(i.ipAddress=t.ipAddress),!i.userAgent&&t.userAgent&&(i.userAgent=t.userAgent),typeof t.errors=="number"&&(i.errors=t.errors),t.status&&(i.status=t.status)}function Gp(i,t){let e={};t?e={status:t}:i.status==="ok"&&(e={status:"exited"}),Or(i,e)}function Wp(i){return zi({sid:`${i.sid}`,init:i.init,started:new Date(i.started*1e3).toISOString(),timestamp:new Date(i.timestamp*1e3).toISOString(),status:i.status,errors:i.errors,did:typeof i.did=="number"||typeof i.did=="string"?`${i.did}`:void 0,duration:i.duration,attrs:{release:i.release,environment:i.environment,ip_address:i.ipAddress,user_agent:i.userAgent}})}const Vp=100;class bi{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={}}static clone(t){const e=new bi;return t&&(e._breadcrumbs=[...t._breadcrumbs],e._tags={...t._tags},e._extra={...t._extra},e._contexts={...t._contexts},e._user=t._user,e._level=t._level,e._span=t._span,e._session=t._session,e._transactionName=t._transactionName,e._fingerprint=t._fingerprint,e._eventProcessors=[...t._eventProcessors],e._requestSession=t._requestSession,e._attachments=[...t._attachments],e._sdkProcessingMetadata={...t._sdkProcessingMetadata}),e}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{},this._session&&Or(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,e){return this._tags={...this._tags,[t]:e},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,e){return this._extra={...this._extra,[t]:e},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,e){return e===null?delete this._contexts[t]:this._contexts[t]=e,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const t=this.getSpan();return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;if(typeof t=="function"){const e=t(this);return e instanceof bi?e:this}return t instanceof bi?(this._tags={...this._tags,...t._tags},this._extra={...this._extra,...t._extra},this._contexts={...this._contexts,...t._contexts},t._user&&Object.keys(t._user).length&&(this._user=t._user),t._level&&(this._level=t._level),t._fingerprint&&(this._fingerprint=t._fingerprint),t._requestSession&&(this._requestSession=t._requestSession)):Eh(t)&&(t=t,this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this}addBreadcrumb(t,e){const n=typeof e=="number"?e:Vp;if(n<=0)return this;const r={timestamp:Yh(),...t};return this._breadcrumbs=[...this._breadcrumbs,r].slice(-n),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(t,e={}){if(this._extra&&Object.keys(this._extra).length&&(t.extra={...this._extra,...t.extra}),this._tags&&Object.keys(this._tags).length&&(t.tags={...this._tags,...t.tags}),this._user&&Object.keys(this._user).length&&(t.user={...this._user,...t.user}),this._contexts&&Object.keys(this._contexts).length&&(t.contexts={...this._contexts,...t.contexts}),this._level&&(t.level=this._level),this._transactionName&&(t.transaction=this._transactionName),this._span){t.contexts={trace:this._span.getTraceContext(),...t.contexts};const n=this._span.transaction&&this._span.transaction.name;n&&(t.tags={transaction:n,...t.tags})}return this._applyFingerprint(t),t.breadcrumbs=[...t.breadcrumbs||[],...this._breadcrumbs],t.breadcrumbs=t.breadcrumbs.length>0?t.breadcrumbs:void 0,t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...this._sdkProcessingMetadata},this._notifyEventProcessors([...Zp(),...this._eventProcessors],t,e)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}_notifyEventProcessors(t,e,n,r=0){return new Et((a,d)=>{const u=t[r];if(e===null||typeof u!="function")a(e);else{const y=u({...e},n);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&u.id&&y===null&&ie.log(`Event processor "${u.id}" dropped event`),Ei(y)?y.then(m=>this._notifyEventProcessors(t,m,n,r+1).then(a)).then(null,d):this._notifyEventProcessors(t,y,n,r+1).then(a).then(null,d)}})}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}_applyFingerprint(t){t.fingerprint=t.fingerprint?ea(t.fingerprint):[],this._fingerprint&&(t.fingerprint=t.fingerprint.concat(this._fingerprint)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}}function Zp(){return ga("globalEventProcessors",()=>[])}const wa=4,Kp=100;class _a{constructor(t,e=new bi,n=wa){this._version=n,this._stack=[{scope:e}],t&&this.bindClient(t)}isOlderThan(t){return this._version<t}bindClient(t){const e=this.getStackTop();e.client=t,t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){const t=bi.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(t){const e=this.pushScope();try{t(e)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,e){const n=this._lastEventId=e&&e.event_id?e.event_id:_i(),r=new Error("Sentry syntheticException");return this._withClient((a,d)=>{a.captureException(t,{originalException:t,syntheticException:r,...e,event_id:n},d)}),n}captureMessage(t,e,n){const r=this._lastEventId=n&&n.event_id?n.event_id:_i(),a=new Error(t);return this._withClient((d,u)=>{d.captureMessage(t,e,{originalException:t,syntheticException:a,...n,event_id:r},u)}),r}captureEvent(t,e){const n=e&&e.event_id?e.event_id:_i();return t.type||(this._lastEventId=n),this._withClient((r,a)=>{r.captureEvent(t,{...e,event_id:n},a)}),n}lastEventId(){return this._lastEventId}addBreadcrumb(t,e){const{scope:n,client:r}=this.getStackTop();if(!r)return;const{beforeBreadcrumb:a=null,maxBreadcrumbs:d=Kp}=r.getOptions&&r.getOptions()||{};if(d<=0)return;const y={timestamp:Yh(),...t},m=a?Ch(()=>a(y,e)):y;m!==null&&(r.emit&&r.emit("beforeAddBreadcrumb",m,e),n.addBreadcrumb(m,d))}setUser(t){this.getScope().setUser(t)}setTags(t){this.getScope().setTags(t)}setExtras(t){this.getScope().setExtras(t)}setTag(t,e){this.getScope().setTag(t,e)}setExtra(t,e){this.getScope().setExtra(t,e)}setContext(t,e){this.getScope().setContext(t,e)}configureScope(t){const{scope:e,client:n}=this.getStackTop();n&&t(e)}run(t){const e=kl(this);try{t(this)}finally{kl(e)}}getIntegration(t){const e=this.getClient();if(!e)return null;try{return e.getIntegration(t)}catch(n){return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,e){return this._callExtensionMethod("startTransaction",t,e)}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){const e=this.getStackTop().scope,n=e.getSession();n&&Gp(n),this._sendSessionUpdate(),e.setSession()}startSession(t){const{scope:e,client:n}=this.getStackTop(),{release:r,environment:a=Xh}=n&&n.getOptions()||{},{userAgent:d}=bt.navigator||{},u=jp({release:r,environment:a,user:e.getUser(),...d&&{userAgent:d},...t}),y=e.getSession&&e.getSession();return y&&y.status==="ok"&&Or(y,{status:"exited"}),this.endSession(),e.setSession(u),u}shouldSendDefaultPii(){const t=this.getClient(),e=t&&t.getOptions();return Boolean(e&&e.sendDefaultPii)}_sendSessionUpdate(){const{scope:t,client:e}=this.getStackTop();if(!t)return;const n=t.getSession();n&&e&&e.captureSession&&e.captureSession(n)}_withClient(t){const{scope:e,client:n}=this.getStackTop();n&&t(n,e)}_callExtensionMethod(t,...e){const r=Wi().__SENTRY__;if(r&&r.extensions&&typeof r.extensions[t]=="function")return r.extensions[t].apply(this,e);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn(`Extension method ${t} couldn't be found, doing nothing.`)}}function Wi(){return bt.__SENTRY__=bt.__SENTRY__||{extensions:{},hub:void 0},bt}function kl(i){const t=Wi(),e=jt(t);return ba(t,i),e}function Cr(){const i=Wi();return(!Lh(i)||jt(i).isOlderThan(wa))&&ba(i,new _a),pa()?Qp(i):jt(i)}function Qp(i){try{const t=Wi().__SENTRY__,e=t&&t.extensions&&t.extensions.domain&&t.extensions.domain.active;if(!e)return jt(i);if(!Lh(e)||jt(e).isOlderThan(wa)){const n=jt(i).getStackTop();ba(e,new _a(n.client,bi.clone(n.scope)))}return jt(e)}catch(t){return jt(i)}}function Lh(i){return!!(i&&i.__SENTRY__&&i.__SENTRY__.hub)}function jt(i){return ga("hub",()=>new _a,i)}function ba(i,t){if(!i)return!1;const e=i.__SENTRY__=i.__SENTRY__||{};return e.hub=t,!0}function Jp(i){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=Cr().getClient(),e=i||t&&t.getOptions();return!!e&&(e.enableTracing||"tracesSampleRate"in e||"tracesSampler"in e)}function em(i){return(i||Cr()).getScope().getTransaction()}let vl=!1;function tm(){vl||(vl=!0,Js("error",ia),Js("unhandledrejection",ia))}function ia(){const i=em();if(i){const t="internal_error";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log(`[Tracing] Transaction: ${t} -> Global error occured`),i.setStatus(t)}}ia.tag="sentry_tracingErrorCallback";class ya{__init(){this.spans=[]}constructor(t=1e3){ya.prototype.__init.call(this),this._maxlen=t}add(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)}}class qt{__init2(){this.traceId=_i()}__init3(){this.spanId=_i().substring(16)}__init4(){this.startTimestamp=yl()}__init5(){this.tags={}}__init6(){this.data={}}__init7(){this.instrumenter="sentry"}constructor(t){if(qt.prototype.__init2.call(this),qt.prototype.__init3.call(this),qt.prototype.__init4.call(this),qt.prototype.__init5.call(this),qt.prototype.__init6.call(this),qt.prototype.__init7.call(this),!t)return this;t.traceId&&(this.traceId=t.traceId),t.spanId&&(this.spanId=t.spanId),t.parentSpanId&&(this.parentSpanId=t.parentSpanId),"sampled"in t&&(this.sampled=t.sampled),t.op&&(this.op=t.op),t.description&&(this.description=t.description),t.data&&(this.data=t.data),t.tags&&(this.tags=t.tags),t.status&&(this.status=t.status),t.startTimestamp&&(this.startTimestamp=t.startTimestamp),t.endTimestamp&&(this.endTimestamp=t.endTimestamp),t.instrumenter&&(this.instrumenter=t.instrumenter)}startChild(t){const e=new qt({...t,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(e.spanRecorder=this.spanRecorder,e.spanRecorder&&e.spanRecorder.add(e),e.transaction=this.transaction,(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&e.transaction){const n=t&&t.op||"< unknown op >",r=e.transaction.name||"< unknown name >",a=e.transaction.spanId,d=`[Tracing] Starting '${n}' span on transaction '${r}' (${a}).`;e.transaction.metadata.spanMetadata[e.spanId]={logMessage:d},ie.log(d)}return e}setTag(t,e){return this.tags={...this.tags,[t]:e},this}setData(t,e){return this.data={...this.data,[t]:e},this}setStatus(t){return this.status=t,this}setHttpStatus(t){this.setTag("http.status_code",String(t));const e=im(t);return e!=="unknown_error"&&this.setStatus(e),this}isSuccess(){return this.status==="ok"}finish(t){if((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:e}=this.transaction.metadata.spanMetadata[this.spanId];e&&ie.log(e.replace("Starting","Finishing"))}this.endTimestamp=typeof t=="number"?t:yl()}toTraceparent(){let t="";return this.sampled!==void 0&&(t=this.sampled?"-1":"-0"),`${this.traceId}-${this.spanId}${t}`}toContext(){return zi({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(t){return this.data=t.data||{},this.description=t.description,this.endTimestamp=t.endTimestamp,this.op=t.op,this.parentSpanId=t.parentSpanId,this.sampled=t.sampled,this.spanId=t.spanId||this.spanId,this.startTimestamp=t.startTimestamp||this.startTimestamp,this.status=t.status,this.tags=t.tags||{},this.traceId=t.traceId||this.traceId,this}getTraceContext(){return zi({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return zi({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})}}function im(i){if(i<400&&i>=100)return"ok";if(i>=400&&i<500)switch(i){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(i>=500&&i<600)switch(i){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}class vn extends qt{__init(){this._measurements={}}__init2(){this._contexts={}}__init3(){this._frozenDynamicSamplingContext=void 0}constructor(t,e){super(t),vn.prototype.__init.call(this),vn.prototype.__init2.call(this),vn.prototype.__init3.call(this),this._hub=e||Cr(),this._name=t.name||"",this.metadata={source:"custom",...t.metadata,spanMetadata:{}},this._trimEnd=t.trimEnd,this.transaction=this;const n=this.metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(t){this.setName(t)}setName(t,e="custom"){this._name=t,this.metadata.source=e}initSpanRecorder(t=1e3){this.spanRecorder||(this.spanRecorder=new ya(t)),this.spanRecorder.add(this)}setContext(t,e){e===null?delete this._contexts[t]:this._contexts[t]=e}setMeasurement(t,e,n=""){this._measurements[t]={value:e,unit:n}}setMetadata(t){this.metadata={...this.metadata,...t}}finish(t){if(this.endTimestamp!==void 0)return;this.name||((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(t);const e=this._hub.getClient();if(e&&e.emit&&e.emit("finishTransaction",this),this.sampled!==!0){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","transaction");return}const n=this.spanRecorder?this.spanRecorder.spans.filter(u=>u!==this&&u.endTimestamp):[];this._trimEnd&&n.length>0&&(this.endTimestamp=n.reduce((u,y)=>u.endTimestamp&&y.endTimestamp?u.endTimestamp>y.endTimestamp?u:y:u).endTimestamp);const r=this.metadata,a={contexts:{...this._contexts,trace:this.getTraceContext()},spans:n,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...r,dynamicSamplingContext:this.getDynamicSamplingContext()},...r.source&&{transaction_info:{source:r.source}}};return Object.keys(this._measurements).length>0&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),a.measurements=this._measurements),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),this._hub.captureEvent(a)}toContext(){const t=super.toContext();return zi({...t,name:this.name,trimEnd:this._trimEnd})}updateWithContext(t){return super.updateWithContext(t),this.name=t.name||"",this._trimEnd=t.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const t=this._hub||Cr(),e=t&&t.getClient();if(!e)return{};const{environment:n,release:r}=e.getOptions()||{},{publicKey:a}=e.getDsn()||{},d=this.metadata.sampleRate,u=d!==void 0?d.toString():void 0,{segment:y}=t.getScope().getUser()||{},m=this.metadata.source,b=m&&m!=="url"?this.name:void 0,E=zi({environment:n||Xh,release:r,transaction:b,user_segment:y,public_key:a,trace_id:this.traceId,sample_rate:u});return e.emit&&e.emit("createDsc",E),E}setHub(t){this._hub=t}}const nm={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3};function rm(){const t=this.getScope().getSpan();return t?{"sentry-trace":t.toTraceparent()}:{}}function sm(i,t,e){if(!Jp(t))return i.sampled=!1,i;if(i.sampled!==void 0)return i.setMetadata({sampleRate:Number(i.sampled)}),i;let n;return typeof t.tracesSampler=="function"?(n=t.tracesSampler(e),i.setMetadata({sampleRate:Number(n)})):e.parentSampled!==void 0?n=e.parentSampled:typeof t.tracesSampleRate<"u"?(n=t.tracesSampleRate,i.setMetadata({sampleRate:Number(n)})):(n=1,i.setMetadata({sampleRate:n})),am(n)?n?(i.sampled=Math.random()<n,i.sampled?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log(`[Tracing] starting ${i.op} transaction - ${i.name}`),i):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(n)})`),i)):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),i.sampled=!1,i):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn("[Tracing] Discarding transaction because of invalid sample rate."),i.sampled=!1,i)}function am(i){return yp(i)||!(typeof i=="number"||typeof i=="boolean")?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(i)} of type ${JSON.stringify(typeof i)}.`),!1):i<0||i>1?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${i}.`),!1):!0}function om(i,t){const e=this.getClient(),n=e&&e.getOptions()||{},r=n.instrumenter||"sentry",a=i.instrumenter||"sentry";r!==a&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error(`A transaction was started with instrumenter=\`${a}\`, but the SDK is configured with the \`${r}\` instrumenter.
The transaction will not be sampled. Please use the ${r} instrumentation to start transactions.`),i.sampled=!1);let d=new vn(i,this);return d=sm(d,n,{parentSampled:i.parentSampled,transactionContext:i,...t}),d.sampled&&d.initSpanRecorder(n._experiments&&n._experiments.maxSpans),e&&e.emit&&e.emit("startTransaction",d),d}function lm(){const i=Wi();i.__SENTRY__&&(i.__SENTRY__.extensions=i.__SENTRY__.extensions||{},i.__SENTRY__.extensions.startTransaction||(i.__SENTRY__.extensions.startTransaction=om),i.__SENTRY__.extensions.traceHeaders||(i.__SENTRY__.extensions.traceHeaders=rm),tm())}function he(i){let t,e=i[0],n=1;for(;n<i.length;){const r=i[n],a=i[n+1];if(n+=2,(r==="optionalAccess"||r==="optionalCall")&&e==null)return;r==="access"||r==="optionalAccess"?(t=e,e=a(e)):(r==="call"||r==="optionalCall")&&(e=a((...d)=>e.call(t,...d)),t=void 0)}return e}function Ti(i){const t=he([i,"call",n=>n(),"access",n=>n.getClient,"call",n=>n(),"optionalAccess",n=>n.getOptions,"call",n=>n()]);return(he([t,"optionalAccess",n=>n.instrumenter])||"sentry")!=="sentry"}class Ir{static __initStatic(){this.id="Express"}__init(){this.name=Ir.id}constructor(t={}){Ir.prototype.__init.call(this),this._router=t.router||t.app,this._methods=(Array.isArray(t.methods)?t.methods:[]).concat("use")}setupOnce(t,e){if(!this._router){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error("ExpressIntegration is missing an Express instance");return}if(Ti(e)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("Express Integration is skipped because of instrumenter configuration.");return}fm(this._router,this._methods),cm(this._router)}}Ir.__initStatic();function Sl(i,t){const e=i.length;switch(e){case 2:return function(n,r){const a=r.__sentry_transaction;if(a){const d=a.startChild({description:i.name,op:`middleware.express.${t}`});r.once("finish",()=>{d.finish()})}return i.call(this,n,r)};case 3:return function(n,r,a){const d=r.__sentry_transaction,u=he([d,"optionalAccess",y=>y.startChild,"call",y=>y({description:i.name,op:`middleware.express.${t}`})]);i.call(this,n,r,function(...y){he([u,"optionalAccess",m=>m.finish,"call",m=>m()]),a.call(this,...y)})};case 4:return function(n,r,a,d){const u=a.__sentry_transaction,y=he([u,"optionalAccess",m=>m.startChild,"call",m=>m({description:i.name,op:`middleware.express.${t}`})]);i.call(this,n,r,a,function(...m){he([y,"optionalAccess",b=>b.finish,"call",b=>b()]),d.call(this,...m)})};default:throw new Error(`Express middleware takes 2-4 arguments. Got: ${e}`)}}function hm(i,t){return i.map(e=>typeof e=="function"?Sl(e,t):Array.isArray(e)?e.map(n=>typeof n=="function"?Sl(n,t):n):e)}function dm(i,t){const e=i[t];return i[t]=function(...n){return e.call(this,...hm(n,t))},i}function fm(i,t=[]){t.forEach(e=>dm(i,e))}function cm(i){const t="settings"in i;t&&i._router===void 0&&i.lazyrouter&&i.lazyrouter();const e=t?i._router:i;if(!e){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.debug("Cannot instrument router for URL Parameterization (did not find a valid router)."),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.debug("Routing instrumentation is currently only supported in Express 4.");return}const n=Object.getPrototypeOf(e),r=n.process_params;n.process_params=function(d,u,y,m,b){y._reconstructedRoute||(y._reconstructedRoute="");const{layerRoutePath:E,isRegex:Y,isArray:I,numExtraSegments:A}=um(d);(E||Y||I)&&(y._hasParameters=!0);const J=(E||d.path||"").split("/").filter(j=>j.length>0&&(Y||I||!j.includes("*"))).join("/");J&&J.length>0&&(y._reconstructedRoute+=`/${J}${Y?"/":""}`);const F=Tr(y.originalUrl||"")+A,ue=Tr(y._reconstructedRoute);if(F===ue){y._hasParameters||y._reconstructedRoute!==y.originalUrl&&(y._reconstructedRoute=y.originalUrl);const j=m.__sentry_transaction;if(j&&j.metadata.source!=="custom"){const z=y._reconstructedRoute||"/";j.setName(...Up(y,{path:!0,method:!0,customRoute:z}))}}return r.call(this,d,u,y,m,b)}}function um(i){const t=he([i,"access",d=>d.route,"optionalAccess",d=>d.path]),e=bp(t),n=Array.isArray(t);if(!t)return{isRegex:e,isArray:n,numExtraSegments:0};const r=n?Math.max(gm(t)-Tr(i.path||""),0):0;return{layerRoutePath:pm(n,t),isRegex:e,isArray:n,numExtraSegments:r}}function gm(i){return i.reduce((t,e)=>t+Tr(e.toString()),0)}function pm(i,t){return i?t.map(e=>e.toString()).join(","):t&&t.toString()}class Yr{static __initStatic(){this.id="Postgres"}__init(){this.name=Yr.id}constructor(t={}){Yr.prototype.__init.call(this),this._usePgNative=!!t.usePgNative}setupOnce(t,e){if(Ti(e)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("Postgres Integration is skipped because of instrumenter configuration.");return}const n=Si("pg");if(!n){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error("Postgres Integration was unable to require `pg` package.");return}if(this._usePgNative&&!he([n,"access",a=>a.native,"optionalAccess",a=>a.Client])){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error("Postgres Integration was unable to access 'pg-native' bindings.");return}const{Client:r}=this._usePgNative?n.native:n;Fe(r.prototype,"query",function(a){return function(d,u,y){const m=e().getScope(),b=he([m,"optionalAccess",I=>I.getSpan,"call",I=>I()]),E=he([b,"optionalAccess",I=>I.startChild,"call",I=>I({description:typeof d=="string"?d:d.text,op:"db"})]);if(typeof y=="function")return a.call(this,d,u,function(I,A){he([E,"optionalAccess",O=>O.finish,"call",O=>O()]),y(I,A)});if(typeof u=="function")return a.call(this,d,function(I,A){he([E,"optionalAccess",O=>O.finish,"call",O=>O()]),u(I,A)});const Y=typeof u<"u"?a.call(this,d,u):a.call(this,d);return Ei(Y)?Y.then(I=>(he([E,"optionalAccess",A=>A.finish,"call",A=>A()]),I)):(he([E,"optionalAccess",I=>I.finish,"call",I=>I()]),Y)}})}}Yr.__initStatic();class Xr{constructor(){Xr.prototype.__init.call(this)}static __initStatic(){this.id="Mysql"}__init(){this.name=Xr.id}setupOnce(t,e){if(Ti(e)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("Mysql Integration is skipped because of instrumenter configuration.");return}const n=Si("mysql/lib/Connection.js");if(!n){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error("Mysql Integration was unable to require `mysql` package.");return}Fe(n,"createQuery",function(r){return function(a,d,u){const y=e().getScope(),m=he([y,"optionalAccess",E=>E.getSpan,"call",E=>E()]),b=he([m,"optionalAccess",E=>E.startChild,"call",E=>E({description:typeof a=="string"?a:a.sql,op:"db"})]);return typeof u=="function"?r.call(this,a,d,function(E,Y,I){he([b,"optionalAccess",A=>A.finish,"call",A=>A()]),u(E,Y,I)}):typeof d=="function"?r.call(this,a,function(E,Y,I){he([b,"optionalAccess",A=>A.finish,"call",A=>A()]),d(E,Y,I)}):r.call(this,a,d,u)}})}}Xr.__initStatic();const mm=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],wm={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]};function _m(i){return i&&typeof i=="object"&&i.once&&typeof i.once=="function"}class Lr{static __initStatic(){this.id="Mongo"}__init(){this.name=Lr.id}constructor(t={}){Lr.prototype.__init.call(this),this._operations=Array.isArray(t.operations)?t.operations:mm,this._describeOperations="describeOperations"in t?t.describeOperations:!0,this._useMongoose=!!t.useMongoose}setupOnce(t,e){if(Ti(e)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("Mongo Integration is skipped because of instrumenter configuration.");return}const n=this._useMongoose?"mongoose":"mongodb",r=Si(n);if(!r){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error(`Mongo Integration was unable to require \`${n}\` package.`);return}this._instrumentOperations(r.Collection,this._operations,e)}_instrumentOperations(t,e,n){e.forEach(r=>this._patchOperation(t,r,n))}_patchOperation(t,e,n){if(!(e in t.prototype))return;const r=this._getSpanContextFromOperationArguments.bind(this);Fe(t.prototype,e,function(a){return function(...d){const u=d[d.length-1],y=n().getScope(),m=he([y,"optionalAccess",E=>E.getSpan,"call",E=>E()]);if(typeof u!="function"||e==="mapReduce"&&d.length===2){const E=he([m,"optionalAccess",I=>I.startChild,"call",I=>I(r(this,e,d))]),Y=a.call(this,...d);if(Ei(Y))return Y.then(I=>(he([E,"optionalAccess",A=>A.finish,"call",A=>A()]),I));if(_m(Y)){const I=Y;try{I.once("close",()=>{he([E,"optionalAccess",A=>A.finish,"call",A=>A()])})}catch(A){he([E,"optionalAccess",O=>O.finish,"call",O=>O()])}return I}else return he([E,"optionalAccess",I=>I.finish,"call",I=>I()]),Y}const b=he([m,"optionalAccess",E=>E.startChild,"call",E=>E(r(this,e,d.slice(0,-1)))]);return a.call(this,...d.slice(0,-1),function(E,Y){he([b,"optionalAccess",I=>I.finish,"call",I=>I()]),u(E,Y)})}})}_getSpanContextFromOperationArguments(t,e,n){const r={collectionName:t.collectionName,dbName:t.dbName,namespace:t.namespace},a={op:"db",description:e,data:r},d=wm[e],u=Array.isArray(this._describeOperations)?this._describeOperations.includes(e):this._describeOperations;if(!d||!u)return a;try{if(e==="mapReduce"){const[y,m]=n;r[d[0]]=typeof y=="string"?y:y.name||"<anonymous>",r[d[1]]=typeof m=="string"?m:m.name||"<anonymous>"}else for(let y=0;y<d.length;y++)r[d[y]]=JSON.stringify(n[y])}catch(y){}return a}}Lr.__initStatic();function bm(i){return i&&!!i.$use}class Ar{static __initStatic(){this.id="Prisma"}__init(){this.name=Ar.id}constructor(t={}){Ar.prototype.__init.call(this),bm(t.client)?this._client=t.client:(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn(`Unsupported Prisma client provided to PrismaIntegration. Provided client: ${JSON.stringify(t.client)}`)}setupOnce(t,e){if(!this._client){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error("PrismaIntegration is missing a Prisma Client Instance");return}if(Ti(e)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("Prisma Integration is skipped because of instrumenter configuration.");return}this._client.$use((n,r)=>{const a=e().getScope(),d=he([a,"optionalAccess",E=>E.getSpan,"call",E=>E()]),u=n.action,y=n.model,m=he([d,"optionalAccess",E=>E.startChild,"call",E=>E({description:y?`${y} ${u}`:u,op:"db.sql.prisma"})]),b=r(n);return Ei(b)?b.then(E=>(he([m,"optionalAccess",Y=>Y.finish,"call",Y=>Y()]),E)):(he([m,"optionalAccess",E=>E.finish,"call",E=>E()]),b)})}}Ar.__initStatic();class Dr{constructor(){Dr.prototype.__init.call(this)}static __initStatic(){this.id="GraphQL"}__init(){this.name=Dr.id}setupOnce(t,e){if(Ti(e)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("GraphQL Integration is skipped because of instrumenter configuration.");return}const n=Si("graphql/execution/execute.js");if(!n){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error("GraphQL Integration was unable to require graphql/execution package.");return}Fe(n,"execute",function(r){return function(...a){const d=e().getScope(),u=he([d,"optionalAccess",b=>b.getSpan,"call",b=>b()]),y=he([u,"optionalAccess",b=>b.startChild,"call",b=>b({description:"execute",op:"graphql.execute"})]);he([d,"optionalAccess",b=>b.setSpan,"call",b=>b(y)]);const m=r.call(this,...a);return Ei(m)?m.then(b=>(he([y,"optionalAccess",E=>E.finish,"call",E=>E()]),he([d,"optionalAccess",E=>E.setSpan,"call",E=>E(u)]),b)):(he([y,"optionalAccess",b=>b.finish,"call",b=>b()]),he([d,"optionalAccess",b=>b.setSpan,"call",b=>b(u)]),m)}})}}Dr.__initStatic();class Rr{static __initStatic(){this.id="Apollo"}__init(){this.name=Rr.id}constructor(t={useNestjs:!1}){Rr.prototype.__init.call(this),this._useNest=!!t.useNestjs}setupOnce(t,e){if(Ti(e)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log("Apollo Integration is skipped because of instrumenter configuration.");return}if(this._useNest){const n=Si("@nestjs/graphql");if(!n){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error("Apollo-NestJS Integration was unable to require @nestjs/graphql package.");return}Fe(n.GraphQLFactory.prototype,"mergeWithSchema",function(r){return function(...a){return Fe(this.resolversExplorerService,"explore",function(d){return function(){const u=ea(d.call(this));return xl(u,e)}}),r.call(this,...a)}})}else{const n=Si("apollo-server-core");if(!n){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.error("Apollo Integration was unable to require apollo-server-core package.");return}Fe(n.ApolloServerBase.prototype,"constructSchema",function(r){return function(){if(!this.config.resolvers)return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&(this.config.schema?(ie.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `schema` property.If you are using NestJS with Apollo, please use `Sentry.Integrations.Apollo({ useNestjs: true })` instead."),ie.warn()):this.config.modules&&ie.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `modules` property."),ie.error("Skipping tracing as no resolvers found on the `ApolloServer` instance.")),r.call(this);const a=ea(this.config.resolvers);return this.config.resolvers=xl(a,e),r.call(this)}})}}}Rr.__initStatic();function xl(i,t){return i.map(e=>(Object.keys(e).forEach(n=>{Object.keys(e[n]).forEach(r=>{typeof e[n][r]=="function"&&ym(e,n,r,t)})}),e))}function ym(i,t,e,n){Fe(i[t],e,function(r){return function(...a){const d=n().getScope(),u=he([d,"optionalAccess",b=>b.getSpan,"call",b=>b()]),y=he([u,"optionalAccess",b=>b.startChild,"call",b=>b({description:`${t}.${e}`,op:"graphql.resolve"})]),m=r.call(this,...a);return Ei(m)?m.then(b=>(he([y,"optionalAccess",E=>E.finish,"call",E=>E()]),b)):(he([y,"optionalAccess",b=>b.finish,"call",b=>b()]),m)}})}const dn=bt,El=["localhost",/^\//],km={traceFetch:!0,traceXHR:!0,tracingOrigins:El,tracePropagationTargets:El};function vm(i,t=!0,e=!0){if(!dn||!dn.location){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.warn("Could not initialize routing instrumentation due to invalid location");return}let n=dn.location.href,r;t&&(r=i({name:dn.location.pathname,op:"pageload",metadata:{source:"url"}})),e&&Js("history",({to:a,from:d})=>{if(d===void 0&&n&&n.indexOf(a)!==-1){n=void 0;return}d!==a&&(n=void 0,r&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&ie.log(`[Tracing] Finishing current transaction with op: ${r.op}`),r.finish()),r=i({name:dn.location.pathname,op:"navigation",metadata:{source:"url"}}))})}({...nm,...km});function Sm(){const i=Wi();if(!i.__SENTRY__)return;const t={mongodb(){const n=Wt(module,"./node/integrations/mongo");return new n.Mongo},mongoose(){const n=Wt(module,"./node/integrations/mongo");return new n.Mongo({mongoose:!0})},mysql(){const n=Wt(module,"./node/integrations/mysql");return new n.Mysql},pg(){const n=Wt(module,"./node/integrations/postgres");return new n.Postgres}},e=Object.keys(t).filter(n=>!!Si(n)).map(n=>{try{return t[n]()}catch(r){return}}).filter(n=>n);e.length>0&&(i.__SENTRY__.integrations=[...i.__SENTRY__.integrations||[],...e])}function xm(){lm(),pa()&&Sm()}(typeof __SENTRY_TRACING__>"u"||__SENTRY_TRACING__)&&xm();const ka=new of;new wp(ka);const Em=new Ml(ka),Tm=new Pl(ka);typeof window<"u"&&(window.leaderboards=Em,window.leaderboards2=Tm);export{Im as __vite_legacy_guard};
//# sourceMappingURL=index-e8f261ec.js.map
